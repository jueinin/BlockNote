{"version":3,"file":"blocknote.umd.cjs","sources":["../src/i18n/locales/ar.ts","../src/i18n/locales/en.ts","../src/i18n/locales/fr.ts","../src/i18n/locales/is.ts","../src/i18n/locales/ja.ts","../src/i18n/locales/ko.ts","../src/i18n/locales/nl.ts","../src/i18n/locales/pl.ts","../src/i18n/locales/pt.ts","../src/i18n/locales/vi.ts","../src/i18n/locales/zh.ts","../src/extensions/UniqueID/UniqueID.ts","../src/api/getBlockInfoFromPos.ts","../src/schema/inlineContent/types.ts","../src/util/typescript.ts","../src/api/nodeConversions/nodeConversions.ts","../src/api/exporters/html/util/sharedHTMLConversion.ts","../src/api/exporters/html/util/simplifyBlocksRehypePlugin.ts","../src/api/exporters/html/externalHTMLExporter.ts","../src/api/exporters/html/internalHTMLSerializer.ts","../src/util/browser.ts","../src/blocks/defaultBlockHelpers.ts","../src/blocks/defaultProps.ts","../src/util/string.ts","../src/schema/blocks/internal.ts","../src/schema/blocks/createSpec.ts","../src/schema/inlineContent/internal.ts","../src/schema/inlineContent/createSpec.ts","../src/schema/styles/internal.ts","../src/schema/styles/createSpec.ts","../src/blocks/FileBlockContent/fileBlockHelpers.ts","../src/blocks/FileBlockContent/FileBlockContent.ts","../src/blocks/ImageBlockContent/imageBlockHelpers.ts","../src/blocks/ImageBlockContent/ImageBlockContent.ts","../src/blocks/VideoBlockContent/videoBlockHelpers.ts","../src/blocks/VideoBlockContent/VideoBlockContent.ts","../src/blocks/AudioBlockContent/audioBlockHelpers.ts","../src/blocks/AudioBlockContent/AudioBlockContent.ts","../src/blocks/FileBlockContent/uploadToTmpFilesDotOrg_DEV_ONLY.ts","../src/extensions/BackgroundColor/BackgroundColorMark.ts","../src/extensions/TextColor/TextColorMark.ts","../src/api/getCurrentBlockContentType.ts","../src/blocks/HeadingBlockContent/HeadingBlockContent.ts","../src/blocks/ListItemBlockContent/ListItemKeyboardShortcuts.ts","../src/blocks/ListItemBlockContent/BulletListItemBlockContent/BulletListItemBlockContent.ts","../src/blocks/ListItemBlockContent/NumberedListItemBlockContent/NumberedListIndexingPlugin.ts","../src/blocks/ListItemBlockContent/NumberedListItemBlockContent/NumberedListItemBlockContent.ts","../src/blocks/ListItemBlockContent/CheckListItemBlockContent/CheckListItemBlockContent.ts","../src/blocks/ParagraphBlockContent/ParagraphBlockContent.ts","../src/blocks/TableBlockContent/TableExtension.ts","../src/blocks/TableBlockContent/TableBlockContent.ts","../src/blocks/defaultBlocks.ts","../src/blocks/defaultBlockTypeGuards.ts","../src/api/nodeUtil.ts","../src/api/blockManipulation/blockManipulation.ts","../src/api/exporters/markdown/removeUnderlinesRehypePlugin.ts","../src/api/exporters/markdown/util/addSpacesToCheckboxesRehypePlugin.ts","../src/api/exporters/markdown/markdownExporter.ts","../src/api/parsers/html/util/nestedLists.ts","../src/api/parsers/html/parseHTML.ts","../src/api/parsers/markdown/parseMarkdown.ts","../src/util/EventEmitter.ts","../src/extensions/FilePanel/FilePanelPlugin.ts","../src/extensions/FormattingToolbar/FormattingToolbarPlugin.ts","../src/extensions/LinkToolbar/LinkToolbarPlugin.ts","../src/extensions/SuggestionMenu/SuggestionPlugin.ts","../src/extensions/SideMenu/MultipleNodeSelection.ts","../src/extensions/SideMenu/SideMenuPlugin.ts","../src/extensions/TableHandles/TableHandlesPlugin.ts","../src/api/exporters/copyExtension.ts","../src/extensions/SuggestionMenu/getDefaultSlashMenuItems.ts","../src/api/parsers/acceptedMIMETypes.ts","../src/api/parsers/handleFileInsertion.ts","../src/api/parsers/pasteExtension.ts","../src/api/parsers/fileDropExtension.ts","../src/extensions/BackgroundColor/BackgroundColorExtension.ts","../src/extensions/TextAlignment/TextAlignmentExtension.ts","../src/extensions/TextColor/TextColorExtension.ts","../src/extensions/TrailingNode/TrailingNodeExtension.ts","../src/extensions/NonEditableBlocks/NonEditableBlockPlugin.ts","../src/extensions/PreviousBlockType/PreviousBlockTypePlugin.ts","../src/pm-nodes/BlockContainer.ts","../src/pm-nodes/BlockGroup.ts","../src/pm-nodes/Doc.ts","../src/editor/BlockNoteExtensions.ts","../src/editor/transformPasted.ts","../src/editor/BlockNoteSchema.ts","../src/editor/BlockNoteTipTapEditor.ts","../src/extensions/Placeholder/PlaceholderPlugin.ts","../src/editor/BlockNoteEditor.ts","../src/api/testUtil/partialBlockTestUtil.ts"],"sourcesContent":["import type { Dictionary } from \"../dictionary\";\n\nexport const ar: Dictionary = {\n  slash_menu: {\n    heading: {\n      title: \"عنوان 1\",\n      subtext: \"يستخدم لعناوين المستوى الأعلى\",\n      aliases: [\"ع\", \"عنوان1\", \"ع1\"],\n      group: \"العناوين\",\n    },\n    heading_2: {\n      title: \"عنوان 2\",\n      subtext: \"يستخدم للأقسام الرئيسية\",\n      aliases: [\"ع2\", \"عنوان2\", \"عنوان فرعي\"],\n      group: \"العناوين\",\n    },\n    heading_3: {\n      title: \"عنوان 3\",\n      subtext: \"يستخدم للأقسام الفرعية والعناوين المجموعة\",\n      aliases: [\"ع3\", \"عنوان3\", \"عنوان فرعي\"],\n      group: \"العناوين\",\n    },\n    numbered_list: {\n      title: \"قائمة مرقمة\",\n      subtext: \"تستخدم لعرض قائمة مرقمة\",\n      aliases: [\"ق\", \"عناصر قائمة\", \"قائمة\", \"قائمة مرقمة\"],\n      group: \"الكتل الأساسية\",\n    },\n    bullet_list: {\n      title: \"قائمة نقطية\",\n      subtext: \"تستخدم لعرض قائمة غير مرتبة\",\n      aliases: [\"ق\", \"عناصر قائمة\", \"قائمة\", \"قائمة نقطية\"],\n      group: \"الكتل الأساسية\",\n    },\n    check_list: {\n      title: \"قائمة تحقق\",\n      subtext: \"تستخدم لعرض قائمة بمربعات التحقق\",\n      aliases: [\n        \"قوائم غير مرتبة\",\n        \"عناصر قائمة\",\n        \"قائمة\",\n        \"قائمة تحقق\",\n        \"قائمة التحقق\",\n        \"قائمة مشطوبة\",\n        \"مربع التحقق\",\n      ],\n      group: \"الكتل الأساسية\",\n    },\n    paragraph: {\n      title: \"فقرة\",\n      subtext: \"تستخدم لنص الوثيقة الأساسي\",\n      aliases: [\"ف\", \"فقرة\"],\n      group: \"الكتل الأساسية\",\n    },\n    table: {\n      title: \"جدول\",\n      subtext: \"يستخدم للجداول\",\n      aliases: [\"جدول\"],\n      group: \"متقدم\",\n    },\n    image: {\n      title: \"صورة\",\n      subtext: \"إدراج صورة\",\n      aliases: [\"صورة\", \"رفع صورة\", \"تحميل\", \"صورة\", \"صورة\", \"وسائط\", \"رابط\"],\n      group: \"وسائط\",\n    },\n    video: {\n      title: \"فيديو\",\n      subtext: \"إدراج فيديو\",\n      aliases: [\n        \"فيديو\",\n        \"رفع فيديو\",\n        \"تحميل\",\n        \"فيديو\",\n        \"فيلم\",\n        \"وسائط\",\n        \"رابط\",\n      ],\n      group: \"وسائط\",\n    },\n    audio: {\n      title: \"صوت\",\n      subtext: \"إدراج صوت\",\n      aliases: [\"صوت\", \"رفع صوت\", \"تحميل\", \"صوت\", \"صوت\", \"وسائط\", \"رابط\"],\n      group: \"وسائط\",\n    },\n    file: {\n      title: \"ملف\",\n      subtext: \"إدراج ملف\",\n      aliases: [\"ملف\", \"تحميل\", \"تضمين\", \"وسائط\", \"رابط\"],\n      group: \"وسائط\",\n    },\n  },\n  placeholders: {\n    default: \"أدخل نصًا أو اكتب '/' للأوامر\",\n    heading: \"عنوان\",\n    bulletListItem: \"قائمة\",\n    numberedListItem: \"قائمة\",\n    checkListItem: \"قائمة\",\n  },\n  file_blocks: {\n    image: {\n      add_button_text: \"إضافة صورة\",\n    },\n    video: {\n      add_button_text: \"إضافة فيديو\",\n    },\n    audio: {\n      add_button_text: \"إضافة صوت\",\n    },\n    file: {\n      add_button_text: \"إضافة ملف\",\n    },\n  },\n  // from react package:\n  side_menu: {\n    add_block_label: \"إضافة محتوي\",\n    drag_handle_label: \"فتح قائمة المحتويات\",\n  },\n  drag_handle: {\n    delete_menuitem: \"حذف\",\n    colors_menuitem: \"ألوان\",\n  },\n  table_handle: {\n    delete_column_menuitem: \"حذف عمود\",\n    delete_row_menuitem: \"حذف صف\",\n    add_left_menuitem: \"إضافة عمود إلى اليسار\",\n    add_right_menuitem: \"إضافة عمود إلى اليمين\",\n    add_above_menuitem: \"إضافة صف أعلى\",\n    add_below_menuitem: \"إضافة صف أسفل\",\n  },\n  suggestion_menu: {\n    no_items_title: \"لم يتم العثور على عناصر\",\n    loading: \"جارٍ التحميل…\",\n  },\n  color_picker: {\n    text_title: \"نص\",\n    background_title: \"خلفية\",\n    colors: {\n      default: \"افتراضي\",\n      gray: \"رمادي\",\n      brown: \"بني\",\n      red: \"أحمر\",\n      orange: \"برتقالي\",\n      yellow: \"أصفر\",\n      green: \"أخضر\",\n      blue: \"أزرق\",\n      purple: \"أرجواني\",\n      pink: \"وردي\",\n    },\n  },\n\n  formatting_toolbar: {\n    bold: {\n      tooltip: \"عريض\",\n      secondary_tooltip: \"Mod+B\",\n    },\n    italic: {\n      tooltip: \"مائل\",\n      secondary_tooltip: \"Mod+I\",\n    },\n    underline: {\n      tooltip: \"تحته خط\",\n      secondary_tooltip: \"Mod+U\",\n    },\n    strike: {\n      tooltip: \"مشطوب\",\n      secondary_tooltip: \"Mod+Shift+X\",\n    },\n    code: {\n      tooltip: \"كود\",\n      secondary_tooltip: \"\",\n    },\n    colors: {\n      tooltip: \"ألوان\",\n    },\n    link: {\n      tooltip: \"إنشاء رابط\",\n      secondary_tooltip: \"Mod+K\",\n    },\n    file_caption: {\n      tooltip: \"تحرير التسمية التوضيحية\",\n      input_placeholder: \"تحرير التسمية التوضيحية\",\n    },\n    file_replace: {\n      tooltip: {\n        image: \"استبدال الصورة\",\n        video: \"استبدال الفيديو\",\n        audio: \"استبدال الصوت\",\n        file: \"استبدال الملف\",\n      } as Record<string, string>,\n    },\n    file_rename: {\n      tooltip: {\n        image: \"إعادة تسمية الصورة\",\n        video: \"إعادة تسمية الفيديو\",\n        audio: \"إعادة تسمية الصوت\",\n        file: \"إعادة تسمية الملف\",\n      } as Record<string, string>,\n      input_placeholder: {\n        image: \"إعادة تسمية الصورة\",\n        video: \"إعادة تسمية الفيديو\",\n        audio: \"إعادة تسمية الصوت\",\n        file: \"إعادة تسمية الملف\",\n      } as Record<string, string>,\n    },\n    file_download: {\n      tooltip: {\n        image: \"تنزيل الصورة\",\n        video: \"تنزيل الفيديو\",\n        audio: \"تنزيل الصوت\",\n        file: \"تنزيل الملف\",\n      } as Record<string, string>,\n    },\n    file_delete: {\n      tooltip: {\n        image: \"حذف الصورة\",\n        video: \"حذف الفيديو\",\n        audio: \"حذف الصوت\",\n        file: \"حذف الملف\",\n      } as Record<string, string>,\n    },\n    file_preview_toggle: {\n      tooltip: \"تبديل المعاينة\",\n    },\n    nest: {\n      tooltip: \"محتويات متداخلة\",\n      secondary_tooltip: \"Tab\",\n    },\n    unnest: {\n      tooltip: \"إلغاء التداخل\",\n      secondary_tooltip: \"Shift+Tab\",\n    },\n    align_left: {\n      tooltip: \"محاذاة النص إلى اليسار\",\n    },\n    align_center: {\n      tooltip: \"محاذاة النص في المنتصف\",\n    },\n    align_right: {\n      tooltip: \"محاذاة النص إلى اليمين\",\n    },\n    align_justify: {\n      tooltip: \"ضبط النص\",\n    },\n  },\n  file_panel: {\n    upload: {\n      title: \"تحميل\",\n      file_placeholder: {\n        image: \"تحميل صورة\",\n        video: \"تحميل فيديو\",\n        audio: \"تحميل صوت\",\n        file: \"تحميل ملف\",\n      } as Record<string, string>,\n      upload_error: \"خطأ: فشل التحميل\",\n    },\n    embed: {\n      title: \"تضمين\",\n      embed_button: {\n        image: \"تضمين صورة\",\n        video: \"تضمين فيديو\",\n        audio: \"تضمين صوت\",\n        file: \"تضمين ملف\",\n      } as Record<string, string>,\n      url_placeholder: \"أدخل الرابط\",\n    },\n  },\n  link_toolbar: {\n    delete: {\n      tooltip: \"إزالة الرابط\",\n    },\n    edit: {\n      text: \"تحرير الرابط\",\n      tooltip: \"تحرير\",\n    },\n    open: {\n      tooltip: \"فتح في تبويب جديد\",\n    },\n    form: {\n      title_placeholder: \"تحرير العنوان\",\n      url_placeholder: \"تحرير الرابط\",\n    },\n  },\n  generic: {\n    ctrl_shortcut: \"Ctrl\",\n  },\n};\n","export const en = {\n  slash_menu: {\n    heading: {\n      title: \"Heading 1\",\n      subtext: \"Used for a top-level heading\",\n      aliases: [\"h\", \"heading1\", \"h1\"],\n      group: \"Headings\",\n    },\n    heading_2: {\n      title: \"Heading 2\",\n      subtext: \"Used for key sections\",\n      aliases: [\"h2\", \"heading2\", \"subheading\"],\n      group: \"Headings\",\n    },\n    heading_3: {\n      title: \"Heading 3\",\n      subtext: \"Used for subsections and group headings\",\n      aliases: [\"h3\", \"heading3\", \"subheading\"],\n      group: \"Headings\",\n    },\n    numbered_list: {\n      title: \"Numbered List\",\n      subtext: \"Used to display a numbered list\",\n      aliases: [\"ol\", \"li\", \"list\", \"numberedlist\", \"numbered list\"],\n      group: \"Basic blocks\",\n    },\n    bullet_list: {\n      title: \"Bullet List\",\n      subtext: \"Used to display an unordered list\",\n      aliases: [\"ul\", \"li\", \"list\", \"bulletlist\", \"bullet list\"],\n      group: \"Basic blocks\",\n    },\n    check_list: {\n      title: \"Check List\",\n      subtext: \"Used to display a list with checkboxes\",\n      aliases: [\n        \"ul\",\n        \"li\",\n        \"list\",\n        \"checklist\",\n        \"check list\",\n        \"checked list\",\n        \"checkbox\",\n      ],\n      group: \"Basic blocks\",\n    },\n    paragraph: {\n      title: \"Paragraph\",\n      subtext: \"Used for the body of your document\",\n      aliases: [\"p\", \"paragraph\"],\n      group: \"Basic blocks\",\n    },\n    table: {\n      title: \"Table\",\n      subtext: \"Used for tables\",\n      aliases: [\"table\"],\n      group: \"Advanced\",\n    },\n    image: {\n      title: \"Image\",\n      subtext: \"Insert an image\",\n      aliases: [\n        \"image\",\n        \"imageUpload\",\n        \"upload\",\n        \"img\",\n        \"picture\",\n        \"media\",\n        \"url\",\n      ],\n      group: \"Media\",\n    },\n    video: {\n      title: \"Video\",\n      subtext: \"Insert a video\",\n      aliases: [\n        \"video\",\n        \"videoUpload\",\n        \"upload\",\n        \"mp4\",\n        \"film\",\n        \"media\",\n        \"url\",\n      ],\n      group: \"Media\",\n    },\n    audio: {\n      title: \"Audio\",\n      subtext: \"Insert audio\",\n      aliases: [\n        \"audio\",\n        \"audioUpload\",\n        \"upload\",\n        \"mp3\",\n        \"sound\",\n        \"media\",\n        \"url\",\n      ],\n      group: \"Media\",\n    },\n    file: {\n      title: \"File\",\n      subtext: \"Insert a file\",\n      aliases: [\"file\", \"upload\", \"embed\", \"media\", \"url\"],\n      group: \"Media\",\n    },\n  },\n  placeholders: {\n    default: \"Enter text or type '/' for commands\",\n    heading: \"Heading\",\n    bulletListItem: \"List\",\n    numberedListItem: \"List\",\n    checkListItem: \"List\",\n  },\n  file_blocks: {\n    image: {\n      add_button_text: \"Add image\",\n    },\n    video: {\n      add_button_text: \"Add video\",\n    },\n    audio: {\n      add_button_text: \"Add audio\",\n    },\n    file: {\n      add_button_text: \"Add file\",\n    },\n  },\n  // from react package:\n  side_menu: {\n    add_block_label: \"Add block\",\n    drag_handle_label: \"Open block menu\",\n  },\n  drag_handle: {\n    delete_menuitem: \"Delete\",\n    colors_menuitem: \"Colors\",\n  },\n  table_handle: {\n    delete_column_menuitem: \"Delete column\",\n    delete_row_menuitem: \"Delete row\",\n    add_left_menuitem: \"Add column left\",\n    add_right_menuitem: \"Add column right\",\n    add_above_menuitem: \"Add row above\",\n    add_below_menuitem: \"Add row below\",\n  },\n  suggestion_menu: {\n    no_items_title: \"No items found\",\n    loading: \"Loading…\",\n  },\n  color_picker: {\n    text_title: \"Text\",\n    background_title: \"Background\",\n    colors: {\n      default: \"Default\",\n      gray: \"Gray\",\n      brown: \"Brown\",\n      red: \"Red\",\n      orange: \"Orange\",\n      yellow: \"Yellow\",\n      green: \"Green\",\n      blue: \"Blue\",\n      purple: \"Purple\",\n      pink: \"Pink\",\n    },\n  },\n\n  formatting_toolbar: {\n    bold: {\n      tooltip: \"Bold\",\n      secondary_tooltip: \"Mod+B\",\n    },\n    italic: {\n      tooltip: \"Italic\",\n      secondary_tooltip: \"Mod+I\",\n    },\n    underline: {\n      tooltip: \"Underline\",\n      secondary_tooltip: \"Mod+U\",\n    },\n    strike: {\n      tooltip: \"Strike\",\n      secondary_tooltip: \"Mod+Shift+X\",\n    },\n    code: {\n      tooltip: \"Code\",\n      secondary_tooltip: \"\",\n    },\n    colors: {\n      tooltip: \"Colors\",\n    },\n    link: {\n      tooltip: \"Create link\",\n      secondary_tooltip: \"Mod+K\",\n    },\n    file_caption: {\n      tooltip: \"Edit caption\",\n      input_placeholder: \"Edit caption\",\n    },\n    file_replace: {\n      tooltip: {\n        image: \"Replace image\",\n        video: \"Replace video\",\n        audio: \"Replace audio\",\n        file: \"Replace file\",\n      } as Record<string, string>,\n    },\n    file_rename: {\n      tooltip: {\n        image: \"Rename image\",\n        video: \"Rename video\",\n        audio: \"Rename audio\",\n        file: \"Rename file\",\n      } as Record<string, string>,\n      input_placeholder: {\n        image: \"Rename image\",\n        video: \"Rename video\",\n        audio: \"Rename audio\",\n        file: \"Rename file\",\n      } as Record<string, string>,\n    },\n    file_download: {\n      tooltip: {\n        image: \"Download image\",\n        video: \"Download video\",\n        audio: \"Download audio\",\n        file: \"Download file\",\n      } as Record<string, string>,\n    },\n    file_delete: {\n      tooltip: {\n        image: \"Delete image\",\n        video: \"Delete video\",\n        audio: \"Delete audio\",\n        file: \"Delete file\",\n      } as Record<string, string>,\n    },\n    file_preview_toggle: {\n      tooltip: \"Toggle preview\",\n    },\n    nest: {\n      tooltip: \"Nest block\",\n      secondary_tooltip: \"Tab\",\n    },\n    unnest: {\n      tooltip: \"Unnest block\",\n      secondary_tooltip: \"Shift+Tab\",\n    },\n    align_left: {\n      tooltip: \"Align text left\",\n    },\n    align_center: {\n      tooltip: \"Align text center\",\n    },\n    align_right: {\n      tooltip: \"Align text right\",\n    },\n    align_justify: {\n      tooltip: \"Justify text\",\n    },\n  },\n  file_panel: {\n    upload: {\n      title: \"Upload\",\n      file_placeholder: {\n        image: \"Upload image\",\n        video: \"Upload video\",\n        audio: \"Upload audio\",\n        file: \"Upload file\",\n      } as Record<string, string>,\n      upload_error: \"Error: Upload failed\",\n    },\n    embed: {\n      title: \"Embed\",\n      embed_button: {\n        image: \"Embed image\",\n        video: \"Embed video\",\n        audio: \"Embed audio\",\n        file: \"Embed file\",\n      } as Record<string, string>,\n      url_placeholder: \"Enter URL\",\n    },\n  },\n  link_toolbar: {\n    delete: {\n      tooltip: \"Remove link\",\n    },\n    edit: {\n      text: \"Edit link\",\n      tooltip: \"Edit\",\n    },\n    open: {\n      tooltip: \"Open in new tab\",\n    },\n    form: {\n      title_placeholder: \"Edit title\",\n      url_placeholder: \"Edit URL\",\n    },\n  },\n  generic: {\n    ctrl_shortcut: \"Ctrl\",\n  },\n};\n","import { Dictionary } from \"../dictionary\";\n\nexport const fr: Dictionary = {\n  slash_menu: {\n    heading: {\n      title: \"Titre 1\",\n      subtext: \"Utilisé pour un titre de premier niveau\",\n      aliases: [\"h\", \"titre1\", \"h1\"],\n      group: \"Titres\",\n    },\n    heading_2: {\n      title: \"Titre 2\",\n      subtext: \"Utilisé pour les sections clés\",\n      aliases: [\"h2\", \"titre2\", \"sous-titre\"],\n      group: \"Titres\",\n    },\n    heading_3: {\n      title: \"Titre 3\",\n      subtext: \"Utilisé pour les sous-sections et les titres de groupe\",\n      aliases: [\"h3\", \"titre3\", \"sous-titre\"],\n      group: \"Titres\",\n    },\n    numbered_list: {\n      title: \"Liste Numérotée\",\n      subtext: \"Utilisé pour afficher une liste numérotée\",\n      aliases: [\"ol\", \"li\", \"liste\", \"listenumérotée\", \"liste numérotée\"],\n      group: \"Blocs de base\",\n    },\n    bullet_list: {\n      title: \"Liste à Puces\",\n      subtext: \"Utilisé pour afficher une liste non ordonnée\",\n      aliases: [\"ul\", \"li\", \"liste\", \"listeàpuces\", \"liste à puces\"],\n      group: \"Blocs de base\",\n    },\n    check_list: {\n      title: \"Liste de vérification\",\n      subtext: \"Utilisé pour afficher une liste avec des cases à cocher\",\n      aliases: [\n        \"ul\",\n        \"li\",\n        \"liste\",\n        \"liste de vérification\",\n        \"liste cochée\",\n        \"case à cocher\",\n      ],\n      group: \"Blocs de base\",\n    },\n    paragraph: {\n      title: \"Paragraphe\",\n      subtext: \"Utilisé pour le corps de votre document\",\n      aliases: [\"p\", \"paragraphe\"],\n      group: \"Blocs de base\",\n    },\n    table: {\n      title: \"Tableau\",\n      subtext: \"Utilisé pour les tableaux\",\n      aliases: [\"tableau\"],\n      group: \"Avancé\",\n    },\n    image: {\n      title: \"Image\",\n      subtext: \"Insérer une image\",\n      aliases: [\n        \"image\",\n        \"uploadImage\",\n        \"télécharger\",\n        \"img\",\n        \"photo\",\n        \"média\",\n        \"url\",\n      ],\n      group: \"Médias\",\n    },\n    video: {\n      title: \"Vidéo\",\n      subtext: \"Insérer une vidéo\",\n      aliases: [\n        \"vidéo\",\n        \"téléchargerVidéo\",\n        \"téléverser\",\n        \"mp4\",\n        \"film\",\n        \"média\",\n        \"url\",\n      ],\n      group: \"Média\",\n    },\n    audio: {\n      title: \"Audio\",\n      subtext: \"Insérer un audio\",\n      aliases: [\n        \"audio\",\n        \"téléchargerAudio\",\n        \"téléverser\",\n        \"mp3\",\n        \"son\",\n        \"média\",\n        \"url\",\n      ],\n      group: \"Média\",\n    },\n    file: {\n      title: \"Fichier\",\n      subtext: \"Insérer un fichier\",\n      aliases: [\"fichier\", \"téléverser\", \"intégrer\", \"média\", \"url\"],\n      group: \"Média\",\n    },\n  },\n  placeholders: {\n    default: \"Entrez du texte ou tapez '/' pour les commandes\",\n    heading: \"Titre\",\n    bulletListItem: \"Liste\",\n    numberedListItem: \"Liste\",\n    checkListItem: \"Liste\",\n  },\n  file_blocks: {\n    image: {\n      add_button_text: \"Ajouter une image\",\n    },\n    video: {\n      add_button_text: \"Ajouter une vidéo\",\n    },\n    audio: {\n      add_button_text: \"Ajouter un audio\",\n    },\n    file: {\n      add_button_text: \"Ajouter un fichier\",\n    },\n  },\n  // from react package:\n  side_menu: {\n    add_block_label: \"Ajouter un bloc\",\n    drag_handle_label: \"Ouvrir le menu du bloc\",\n  },\n  drag_handle: {\n    delete_menuitem: \"Supprimer\",\n    colors_menuitem: \"Couleurs\",\n  },\n  table_handle: {\n    delete_column_menuitem: \"Supprimer la colonne\",\n    delete_row_menuitem: \"Supprimer la ligne\",\n    add_left_menuitem: \"Ajouter une colonne à gauche\",\n    add_right_menuitem: \"Ajouter une colonne à droite\",\n    add_above_menuitem: \"Ajouter une ligne au-dessus\",\n    add_below_menuitem: \"Ajouter une ligne en dessous\",\n  },\n  suggestion_menu: {\n    no_items_title: \"Aucun élément trouvé\",\n    loading: \"Chargement…\",\n  },\n  color_picker: {\n    text_title: \"Texte\",\n    background_title: \"Fond\",\n    colors: {\n      default: \"Défaut\",\n      gray: \"Gris\",\n      brown: \"Marron\",\n      red: \"Rouge\",\n      orange: \"Orange\",\n      yellow: \"Jaune\",\n      green: \"Vert\",\n      blue: \"Bleu\",\n      purple: \"Violet\",\n      pink: \"Rose\",\n    },\n  },\n\n  formatting_toolbar: {\n    bold: {\n      tooltip: \"Gras\",\n      secondary_tooltip: \"Mod+B\",\n    },\n    italic: {\n      tooltip: \"Italique\",\n      secondary_tooltip: \"Mod+I\",\n    },\n    underline: {\n      tooltip: \"Souligner\",\n      secondary_tooltip: \"Mod+U\",\n    },\n    strike: {\n      tooltip: \"Barré\",\n      secondary_tooltip: \"Mod+Shift+X\",\n    },\n    code: {\n      tooltip: \"Code\",\n      secondary_tooltip: \"\",\n    },\n    colors: {\n      tooltip: \"Couleurs\",\n    },\n    link: {\n      tooltip: \"Créer un lien\",\n      secondary_tooltip: \"Mod+K\",\n    },\n    file_caption: {\n      tooltip: \"Modifier la légende\",\n      input_placeholder: \"Modifier la légende\",\n    },\n    file_replace: {\n      tooltip: {\n        image: \"Remplacer l'image\",\n        video: \"Remplacer la vidéo\",\n        audio: \"Remplacer l'audio\",\n        file: \"Remplacer le fichier\",\n      },\n    },\n    file_rename: {\n      tooltip: {\n        image: \"Renommer l'image\",\n        video: \"Renommer la vidéo\",\n        audio: \"Renommer l'audio\",\n        file: \"Renommer le fichier\",\n      },\n      input_placeholder: {\n        image: \"Renommer l'image\",\n        video: \"Renommer la vidéo\",\n        audio: \"Renommer l'audio\",\n        file: \"Renommer le fichier\",\n      },\n    },\n    file_download: {\n      tooltip: {\n        image: \"Télécharger l'image\",\n        video: \"Télécharger la vidéo\",\n        audio: \"Télécharger l'audio\",\n        file: \"Télécharger le fichier\",\n      },\n    },\n    file_delete: {\n      tooltip: {\n        image: \"Supprimer l'image\",\n        video: \"Supprimer la vidéo\",\n        audio: \"Supprimer l'audio\",\n        file: \"Supprimer le fichier\",\n      },\n    },\n    file_preview_toggle: {\n      tooltip: \"Basculer l'aperçu\",\n    },\n    nest: {\n      tooltip: \"Emboîter le bloc\",\n      secondary_tooltip: \"Tab\",\n    },\n    unnest: {\n      tooltip: \"Démboîter le bloc\",\n      secondary_tooltip: \"Shift+Tab\",\n    },\n    align_left: {\n      tooltip: \"Aligner le texte à gauche\",\n    },\n    align_center: {\n      tooltip: \"Aligner le texte au centre\",\n    },\n    align_right: {\n      tooltip: \"Aligner le texte à droite\",\n    },\n    align_justify: {\n      tooltip: \"Justifier le texte\",\n    },\n  },\n  file_panel: {\n    upload: {\n      title: \"Télécharger\",\n      file_placeholder: {\n        image: \"Télécharger une image\",\n        video: \"Télécharger une vidéo\",\n        audio: \"Télécharger un fichier audio\",\n        file: \"Télécharger un fichier\",\n      },\n      upload_error: \"Erreur : Échec du téléchargement\",\n    },\n    embed: {\n      title: \"Intégrer\",\n      embed_button: {\n        image: \"Intégrer une image\",\n        video: \"Intégrer une vidéo\",\n        audio: \"Intégrer un fichier audio\",\n        file: \"Intégrer un fichier\",\n      },\n      url_placeholder: \"Entrez l'URL\",\n    },\n  },\n  link_toolbar: {\n    delete: {\n      tooltip: \"Supprimer le lien\",\n    },\n    edit: {\n      text: \"Modifier le lien\",\n      tooltip: \"Modifier\",\n    },\n    open: {\n      tooltip: \"Ouvrir dans un nouvel onglet\",\n    },\n    form: {\n      title_placeholder: \"Modifier le titre\",\n      url_placeholder: \"Modifier l'URL\",\n    },\n  },\n  generic: {\n    ctrl_shortcut: \"Ctrl\",\n  },\n};\n","import type { Dictionary } from \"../dictionary\";\n\nexport const is: Dictionary = {\n  slash_menu: {\n    heading: {\n      title: \"Fyrirsögn 1\",\n      subtext: \"Notað fyrir efstu fyrirsögn\",\n      aliases: [\"h\", \"fyrirsogn1\", \"h1\"],\n      group: \"Fyrirsagnir\",\n    },\n    heading_2: {\n      title: \"Fyrirsögn 2\",\n      subtext: \"Notað fyrir lykilhluta\",\n      aliases: [\"h2\", \"fyrirsogn2\", \"undirfyrirsogn\"],\n      group: \"Fyrirsagnir\",\n    },\n    heading_3: {\n      title: \"Fyrirsögn 3\",\n      subtext: \"Notað fyrir undirhluta og hópfyrirsagnir\",\n      aliases: [\"h3\", \"fyrirsogn3\", \"undirfyrirsogn\"],\n      group: \"Fyrirsagnir\",\n    },\n    numbered_list: {\n      title: \"Númeruð listi\",\n      subtext: \"Notað til að birta númeraðan lista\",\n      aliases: [\"ol\", \"li\", \"listi\", \"numeradurlisti\"],\n      group: \"Grunnblokkar\",\n    },\n    bullet_list: {\n      title: \"Punktalisti\",\n      subtext: \"Notað til að birta óraðaðan lista\",\n      aliases: [\"ul\", \"li\", \"listi\", \"punktalisti\"],\n      group: \"Grunnblokkar\",\n    },\n    check_list: {\n      title: \"Athugunarlisti\",\n      subtext: \"Notað til að sýna lista með gátreitum\",\n      aliases: [\"ul\", \"li\", \"listi\", \"athugunarlisti\", \"merktur listi\"],\n      group: \"Grunnblokkar\",\n    },\n    paragraph: {\n      title: \"Málsgrein\",\n      subtext: \"Notað fyrir meginmál skjalsins\",\n      aliases: [\"p\", \"malsgrein\"],\n      group: \"Grunnblokkar\",\n    },\n    table: {\n      title: \"Tafla\",\n      subtext: \"Notað fyrir töflur\",\n      aliases: [\"tafla\"],\n      group: \"Ítarlegt\",\n    },\n    image: {\n      title: \"Mynd\",\n      subtext: \"Settu inn mynd\",\n      aliases: [\n        \"mynd\",\n        \"myndaupphlaed\",\n        \"upphlaed\",\n        \"img\",\n        \"mynd\",\n        \"media\",\n        \"url\",\n      ],\n      group: \"Miðlar\",\n    },\n    video: {\n      title: \"Myndband\",\n      subtext: \"Setja inn myndband\",\n      aliases: [\n        \"myndband\",\n        \"videoUpphala\",\n        \"hlaða upp\",\n        \"mp4\",\n        \"kvikmynd\",\n        \"miðill\",\n        \"url\",\n      ],\n      group: \"Miðill\",\n    },\n    audio: {\n      title: \"Hljóð\",\n      subtext: \"Setja inn hljóð\",\n      aliases: [\n        \"hljóð\",\n        \"audioUpphala\",\n        \"hlaða upp\",\n        \"mp3\",\n        \"hljóð\",\n        \"miðill\",\n        \"url\",\n      ],\n      group: \"Miðlar\",\n    },\n    file: {\n      title: \"Skrá\",\n      subtext: \"Setja inn skrá\",\n      aliases: [\"skrá\", \"hlaða upp\", \"fella inn\", \"miðill\", \"url\"],\n      group: \"Miðlar\",\n    },\n  },\n  placeholders: {\n    default: \"Sláðu inn texta eða skrifaðu '/' fyrir skipanir\",\n    heading: \"Fyrirsögn\",\n    bulletListItem: \"Listi\",\n    numberedListItem: \"Listi\",\n    checkListItem: \"Listi\",\n  },\n  file_blocks: {\n    image: {\n      add_button_text: \"Bæta við mynd\",\n    },\n    video: {\n      add_button_text: \"Bæta við myndbandi\",\n    },\n    audio: {\n      add_button_text: \"Bæta við hljóði\",\n    },\n    file: {\n      add_button_text: \"Bæta við skrá\",\n    },\n  },\n  side_menu: {\n    add_block_label: \"Bæta við blokki\",\n    drag_handle_label: \"Opna blokkarvalmynd\",\n  },\n  drag_handle: {\n    delete_menuitem: \"Eyða\",\n    colors_menuitem: \"Litir\",\n  },\n  table_handle: {\n    delete_column_menuitem: \"Eyða dálki\",\n    delete_row_menuitem: \"Eyða röð\",\n    add_left_menuitem: \"Bæta dálki við til vinstri\",\n    add_right_menuitem: \"Bæta dálki við til hægri\",\n    add_above_menuitem: \"Bæta röð við fyrir ofan\",\n    add_below_menuitem: \"Bæta röð við fyrir neðan\",\n  },\n  suggestion_menu: {\n    no_items_title: \"Engir hlutir fundust\",\n    loading: \"Hleður…\",\n  },\n  color_picker: {\n    text_title: \"Texti\",\n    background_title: \"Bakgrunnur\",\n    colors: {\n      default: \"Sjálfgefið\",\n      gray: \"Grár\",\n      brown: \"Brúnn\",\n      red: \"Rauður\",\n      orange: \"Appelsínugulur\",\n      yellow: \"Gulur\",\n      green: \"Grænn\",\n      blue: \"Blár\",\n      purple: \"Fjólublár\",\n      pink: \"Bleikur\",\n    },\n  },\n\n  formatting_toolbar: {\n    bold: {\n      tooltip: \"Feitletrað\",\n      secondary_tooltip: \"Mod+B\",\n    },\n    italic: {\n      tooltip: \"Skáletrað\",\n      secondary_tooltip: \"Mod+I\",\n    },\n    underline: {\n      tooltip: \"Undirstrikað\",\n      secondary_tooltip: \"Mod+U\",\n    },\n    strike: {\n      tooltip: \"Yfirstrikað\",\n      secondary_tooltip: \"Mod+Shift+X\",\n    },\n    code: {\n      tooltip: \"Kóði\",\n      secondary_tooltip: \"\",\n    },\n    colors: {\n      tooltip: \"Litir\",\n    },\n    link: {\n      tooltip: \"Búa til tengil\",\n      secondary_tooltip: \"Mod+K\",\n    },\n    file_caption: {\n      tooltip: \"Breyta myndatexta\",\n      input_placeholder: \"Breyta myndatexta\",\n    },\n    file_replace: {\n      tooltip: {\n        image: \"Skipta um mynd\",\n        video: \"Skipta um myndband\",\n        audio: \"Skipta um hljóð\",\n        file: \"Skipta um skrá\",\n      },\n    },\n    file_rename: {\n      tooltip: {\n        image: \"Endurnefna mynd\",\n        video: \"Endurnefna myndband\",\n        audio: \"Endurnefna hljóð\",\n        file: \"Endurnefna skrá\",\n      },\n      input_placeholder: {\n        image: \"Endurnefna mynd\",\n        video: \"Endurnefna myndband\",\n        audio: \"Endurnefna hljóð\",\n        file: \"Endurnefna skrá\",\n      },\n    },\n    file_download: {\n      tooltip: {\n        image: \"Sækja mynd\",\n        video: \"Sækja myndband\",\n        audio: \"Sækja hljóð\",\n        file: \"Sækja skrá\",\n      },\n    },\n    file_delete: {\n      tooltip: {\n        image: \"Eyða mynd\",\n        video: \"Eyða myndbandi\",\n        audio: \"Eyða hljóði\",\n        file: \"Eyða skrá\",\n      },\n    },\n    file_preview_toggle: {\n      tooltip: \"Skipta um forskoðun\",\n    },\n    nest: {\n      tooltip: \"Fella blokk saman\",\n      secondary_tooltip: \"Tab\",\n    },\n    unnest: {\n      tooltip: \"Afþýða blokk\",\n      secondary_tooltip: \"Shift+Tab\",\n    },\n    align_left: {\n      tooltip: \"Vinstrijafna texta\",\n    },\n    align_center: {\n      tooltip: \"Miðjustilla texta\",\n    },\n    align_right: {\n      tooltip: \"Hægrijafna texta\",\n    },\n    align_justify: {\n      tooltip: \"Jafna texta\",\n    },\n  },\n  file_panel: {\n    upload: {\n      title: \"Hlaða upp\",\n      file_placeholder: {\n        image: \"Hlaða upp mynd\",\n        video: \"Hlaða upp myndband\",\n        audio: \"Hlaða upp hljóð\",\n        file: \"Hlaða upp skrá\",\n      },\n      upload_error: \"Villa: Upphleðsla mistókst\",\n    },\n    embed: {\n      title: \"Innsetja\",\n      embed_button: {\n        image: \"Innsetja mynd\",\n        video: \"Innsetja myndband\",\n        audio: \"Innsetja hljóð\",\n        file: \"Innsetja skrá\",\n      },\n      url_placeholder: \"Sláðu inn URL\",\n    },\n  },\n  link_toolbar: {\n    delete: {\n      tooltip: \"Fjarlægja tengil\",\n    },\n    edit: {\n      text: \"Breyta tengli\",\n      tooltip: \"Breyta\",\n    },\n    open: {\n      tooltip: \"Opna í nýjum flipa\",\n    },\n    form: {\n      title_placeholder: \"Breyta titli\",\n      url_placeholder: \"Breyta URL\",\n    },\n  },\n  generic: {\n    ctrl_shortcut: \"Ctrl\",\n  },\n};\n","import { Dictionary } from \"../dictionary\";\n\nexport const ja: Dictionary = {\n  slash_menu: {\n    heading: {\n      title: \"見出し１\",\n      subtext: \"トップレベルの見出しに使用\",\n      aliases: [\"h\", \"見出し１\", \"h1\", \"大見出し\"],\n      group: \"見出し\",\n    },\n    heading_2: {\n      title: \"見出し２\",\n      subtext: \"重要なセクションに使用\",\n      aliases: [\"h2\", \"見出し2\", \"subheading\", \"中見出し\"],\n      group: \"見出し\",\n    },\n    heading_3: {\n      title: \"見出し３\",\n      subtext: \"セクションやグループの見出しに使用\",\n      aliases: [\"h3\", \"見出し3\", \"subheading\", \"小見出し\"],\n      group: \"見出し\",\n    },\n    numbered_list: {\n      title: \"番号付リスト\",\n      subtext: \"番号付リストを表示するために使用\",\n      aliases: [\n        \"ol\",\n        \"li\",\n        \"numberedlist\",\n        \"numbered list\",\n        \"リスト\",\n        \"番号付リスト\",\n        \"番号 リスト\",\n      ],\n      group: \"基本ブロック\",\n    },\n    bullet_list: {\n      title: \"箇条書き\",\n      subtext: \"箇条書きを表示するために使用\",\n      aliases: [\n        \"ul\",\n        \"li\",\n        \"bulletlist\",\n        \"bullet list\",\n        \"リスト\",\n        \"箇条書きリスト\",\n      ],\n      group: \"基本ブロック\",\n    },\n    check_list: {\n      title: \"チェックリスト\",\n      subtext: \"チェックボックス付きリストを表示するために使用されます\",\n      aliases: [\n        \"ul\",\n        \"li\",\n        \"list\",\n        \"checklist\",\n        \"checked list\",\n        \"リスト\",\n        \"チェックリスト\",\n        \"チェックされたリスト\",\n      ],\n      group: \"基本ブロック\",\n    },\n    paragraph: {\n      title: \"標準テキスト\",\n      subtext: \"本文に使用\",\n      aliases: [\"p\", \"paragraph\", \"標準テキスト\"],\n      group: \"基本ブロック\",\n    },\n    table: {\n      title: \"表\",\n      subtext: \"表に使用\",\n      aliases: [\"table\", \"表\", \"テーブル\"],\n      group: \"高度なブロック\",\n    },\n    image: {\n      title: \"画像\",\n      subtext: \"画像を挿入\",\n      aliases: [\n        \"image\",\n        \"imageUpload\",\n        \"upload\",\n        \"img\",\n        \"picture\",\n        \"media\",\n        \"url\",\n        \"画像\",\n      ],\n      group: \"メディア\",\n    },\n    video: {\n      title: \"ビデオ\",\n      subtext: \"ビデオを挿入\",\n      aliases: [\n        \"video\",\n        \"videoUpload\",\n        \"upload\",\n        \"mp4\",\n        \"film\",\n        \"media\",\n        \"url\",\n        \"ビデオ\",\n      ],\n      group: \"メディア\",\n    },\n    audio: {\n      title: \"オーディオ\",\n      subtext: \"オーディオを挿入\",\n      aliases: [\n        \"audio\",\n        \"audioUpload\",\n        \"upload\",\n        \"mp3\",\n        \"sound\",\n        \"media\",\n        \"url\",\n        \"オーディオ\",\n      ],\n      group: \"メディア\",\n    },\n    file: {\n      title: \"ファイル\",\n      subtext: \"ファイルを挿入\",\n      aliases: [\"file\", \"upload\", \"embed\", \"media\", \"url\", \"ファイル\"],\n      group: \"メディア\",\n    },\n  },\n  placeholders: {\n    default: \"テキストを入力するか'/' を入力してコマンド選択\",\n    heading: \"見出し\",\n    bulletListItem: \"リストを追加\",\n    numberedListItem: \"リストを追加\",\n    checkListItem: \"リストを追加\",\n  },\n  file_blocks: {\n    image: {\n      add_button_text: \"画像を追加\",\n    },\n    video: {\n      add_button_text: \"ビデオを追加\",\n    },\n    audio: {\n      add_button_text: \"オーディオを追加\",\n    },\n    file: {\n      add_button_text: \"ファイルを追加\",\n    },\n  },\n  // from react package:\n  side_menu: {\n    add_block_label: \"ブロックを追加\",\n    drag_handle_label: \"ブロックメニュー\",\n  },\n  drag_handle: {\n    delete_menuitem: \"削除\",\n    colors_menuitem: \"色を変更\",\n  },\n  table_handle: {\n    delete_column_menuitem: \"列を削除\",\n    delete_row_menuitem: \"行を削除\",\n    add_left_menuitem: \"左に列を追加\",\n    add_right_menuitem: \"右に列を追加\",\n    add_above_menuitem: \"上に行を追加\",\n    add_below_menuitem: \"下に行を追加\",\n  },\n  suggestion_menu: {\n    no_items_title: \"アイテムが見つかりません\",\n    loading: \"読込中…\",\n  },\n  color_picker: {\n    text_title: \"文字色\",\n    background_title: \"背景色\",\n    colors: {\n      default: \"デフォルト\",\n      gray: \"グレー\",\n      brown: \"茶色\",\n      red: \"赤\",\n      orange: \"オレンジ\",\n      yellow: \"黄色\",\n      green: \"緑\",\n      blue: \"青\",\n      purple: \"紫\",\n      pink: \"ピンク\",\n    },\n  },\n\n  formatting_toolbar: {\n    bold: {\n      tooltip: \"太字\",\n      secondary_tooltip: \"Mod+B\",\n    },\n    italic: {\n      tooltip: \"斜体\",\n      secondary_tooltip: \"Mod+I\",\n    },\n    underline: {\n      tooltip: \"下線\",\n      secondary_tooltip: \"Mod+U\",\n    },\n    strike: {\n      tooltip: \"打ち消し\",\n      secondary_tooltip: \"Mod+Shift+X\",\n    },\n    code: {\n      tooltip: \"コード\",\n      secondary_tooltip: \"\",\n    },\n    colors: {\n      tooltip: \"色\",\n    },\n    link: {\n      tooltip: \"リンク\",\n      secondary_tooltip: \"Mod+K\",\n    },\n    file_caption: {\n      tooltip: \"キャプションを編集\",\n      input_placeholder: \"キャプションを編集\",\n    },\n    file_replace: {\n      tooltip: {\n        image: \"画像を置換\",\n        video: \"ビデオを置換\",\n        audio: \"オーディオを置換\",\n        file: \"ファイルを置換\",\n      },\n    },\n    file_rename: {\n      tooltip: {\n        image: \"画像の名前を変更\",\n        video: \"ビデオの名前を変更\",\n        audio: \"オーディオの名前を変更\",\n        file: \"ファイルの名前を変更\",\n      },\n      input_placeholder: {\n        image: \"画像の名前を変更\",\n        video: \"ビデオの名前を変更\",\n        audio: \"オーディオの名前を変更\",\n        file: \"ファイルの名前を変更\",\n      },\n    },\n    file_download: {\n      tooltip: {\n        image: \"画像をダウンロード\",\n        video: \"ビデオをダウンロード\",\n        audio: \"オーディオをダウンロード\",\n        file: \"ファイルをダウンロード\",\n      },\n    },\n    file_delete: {\n      tooltip: {\n        image: \"画像を削除\",\n        video: \"ビデオを削除\",\n        audio: \"オーディオを削除\",\n        file: \"ファイルを削除\",\n      },\n    },\n    file_preview_toggle: {\n      tooltip: \"プレビューの切り替え\",\n    },\n    nest: {\n      tooltip: \"インデント増\",\n      secondary_tooltip: \"Tab\",\n    },\n    unnest: {\n      tooltip: \"インデント減\",\n      secondary_tooltip: \"Shift+Tab\",\n    },\n    align_left: {\n      tooltip: \"左揃え\",\n    },\n    align_center: {\n      tooltip: \"中央揃え\",\n    },\n    align_right: {\n      tooltip: \"右揃え\",\n    },\n    align_justify: {\n      tooltip: \"両端揃え\",\n    },\n  },\n  file_panel: {\n    upload: {\n      title: \"アップロード\",\n      file_placeholder: {\n        image: \"画像をアップロード\",\n        video: \"ビデオをアップロード\",\n        audio: \"オーディオをアップロード\",\n        file: \"ファイルをアップロード\",\n      },\n      upload_error: \"エラー: アップロードが失敗しました\",\n    },\n    embed: {\n      title: \"埋め込み\",\n      embed_button: {\n        image: \"画像を埋め込む\",\n        video: \"ビデオを埋め込む\",\n        audio: \"オーディオを埋め込む\",\n        file: \"ファイルを埋め込む\",\n      },\n      url_placeholder: \"URLを入力\",\n    },\n  },\n  link_toolbar: {\n    delete: {\n      tooltip: \"リンクを解除\",\n    },\n    edit: {\n      text: \"リンクを編集\",\n      tooltip: \"編集\",\n    },\n    open: {\n      tooltip: \"新しいタブでリンクを開く\",\n    },\n    form: {\n      title_placeholder: \"タイトルを編集\",\n      url_placeholder: \"URLを編集\",\n    },\n  },\n  generic: {\n    ctrl_shortcut: \"Ctrl\",\n  },\n};\n","import { Dictionary } from \"../dictionary\";\n\nexport const ko: Dictionary = {\n  slash_menu: {\n    heading: {\n      title: \"제목1\",\n      subtext: \"섹션 제목(대)\",\n      aliases: [\"h\", \"제목1\", \"h1\", \"대제목\"],\n      group: \"제목\",\n    },\n    heading_2: {\n      title: \"제목2\",\n      subtext: \"섹션 제목(중)\",\n      aliases: [\"h2\", \"제목2\", \"중제목\"],\n      group: \"제목\",\n    },\n    heading_3: {\n      title: \"제목3\",\n      subtext: \"섹션 제목(소)\",\n      aliases: [\"h3\", \"제목3\", \"subheading\"],\n      group: \"제목\",\n    },\n    numbered_list: {\n      title: \"번호 매기기 목록\",\n      subtext: \"번호가 매겨진 목록을 추가합니다.\",\n      aliases: [\"ol\", \"li\", \"목록\", \"번호 매기기 목록\", \"번호 목록\"],\n      group: \"기본 블록\",\n    },\n    bullet_list: {\n      title: \"글머리 기호 목록\",\n      subtext: \"간단한 글머리 기호를 추가합니다.\",\n      aliases: [\"ul\", \"li\", \"목록\", \"글머리 기호 목록\", \"글머리 목록\"],\n      group: \"기본 블록\",\n    },\n    check_list: {\n      title: \"체크리스트\",\n      subtext: \"체크박스가 있는 목록을 표시하는 데 사용\",\n      aliases: [\n        \"ul\",\n        \"li\",\n        \"목록\",\n        \"체크리스트\",\n        \"체크 리스트\",\n        \"체크된 목록\",\n        \"체크박스\",\n      ],\n      group: \"기본 블록\",\n    },\n    paragraph: {\n      title: \"본문\",\n      subtext: \"일반 텍스트\",\n      aliases: [\"p\", \"paragraph\", \"본문\"],\n      group: \"기본 블록\",\n    },\n    table: {\n      title: \"표\",\n      subtext: \"간단한 표를 추가합니다.\",\n      aliases: [\"표\"],\n      group: \"고급\",\n    },\n    image: {\n      title: \"이미지\",\n      subtext: \"이미지 파일을 업로드합니다.\",\n      aliases: [\n        \"image\",\n        \"imageUpload\",\n        \"upload\",\n        \"img\",\n        \"picture\",\n        \"media\",\n        \"이미지\",\n        \"url\",\n      ],\n      group: \"미디어\",\n    },\n    video: {\n      title: \"비디오\",\n      subtext: \"비디오 삽입\",\n      aliases: [\n        \"video\",\n        \"videoUpload\",\n        \"upload\",\n        \"mp4\",\n        \"film\",\n        \"media\",\n        \"동영상\",\n        \"url\",\n      ],\n      group: \"미디어\",\n    },\n    audio: {\n      title: \"오디오\",\n      subtext: \"오디오 삽입\",\n      aliases: [\n        \"audio\",\n        \"audioUpload\",\n        \"upload\",\n        \"mp3\",\n        \"sound\",\n        \"media\",\n        \"오디오\",\n        \"url\",\n      ],\n      group: \"미디어\",\n    },\n    file: {\n      title: \"파일\",\n      subtext: \"파일 삽입\",\n      aliases: [\"file\", \"upload\", \"embed\", \"media\", \"파일\", \"url\"],\n      group: \"미디어\",\n    },\n  },\n  placeholders: {\n    default: \"텍스트를 입력하거나 /를 입력하여 명령을 입력하세요.\",\n    heading: \"제목\",\n    bulletListItem: \"목록\",\n    numberedListItem: \"목록\",\n    checkListItem: \"목록\",\n  },\n  file_blocks: {\n    image: {\n      add_button_text: \"이미지 추가\",\n    },\n    video: {\n      add_button_text: \"비디오 추가\",\n    },\n    audio: {\n      add_button_text: \"오디오 추가\",\n    },\n    file: {\n      add_button_text: \"파일 추가\",\n    },\n  },\n  // from react package:\n  side_menu: {\n    add_block_label: \"블록 추가\",\n    drag_handle_label: \"블록 메뉴 열기\",\n  },\n  drag_handle: {\n    delete_menuitem: \"삭제\",\n    colors_menuitem: \"색깔\",\n  },\n  table_handle: {\n    delete_column_menuitem: \"열 1개 삭제\",\n    delete_row_menuitem: \"행 삭제\",\n    add_left_menuitem: \"왼쪽에 열 1개 추가\",\n    add_right_menuitem: \"오른쪽에 열 1개 추가\",\n    add_above_menuitem: \"위에 행 1개 추가\",\n    add_below_menuitem: \"아래에 행 1개 추가\",\n  },\n  suggestion_menu: {\n    no_items_title: \"항목을 찾을 수 없음\",\n    loading: \"로딩 중…\",\n  },\n  color_picker: {\n    text_title: \"텍스트\",\n    background_title: \"배경\",\n    colors: {\n      default: \"기본\",\n      gray: \"회색\",\n      brown: \"갈색\",\n      red: \"빨간색\",\n      orange: \"주황색\",\n      yellow: \"노란색\",\n      green: \"녹색\",\n      blue: \"파란색\",\n      purple: \"보라색\",\n      pink: \"분홍색\",\n    },\n  },\n\n  formatting_toolbar: {\n    bold: {\n      tooltip: \"진하게\",\n      secondary_tooltip: \"Mod+B\",\n    },\n    italic: {\n      tooltip: \"기울임\",\n      secondary_tooltip: \"Mod+I\",\n    },\n    underline: {\n      tooltip: \"밑줄\",\n      secondary_tooltip: \"Mod+U\",\n    },\n    strike: {\n      tooltip: \"취소선\",\n      secondary_tooltip: \"Mod+Shift+X\",\n    },\n    code: {\n      tooltip: \"코드\",\n      secondary_tooltip: \"\",\n    },\n    colors: {\n      tooltip: \"색깔\",\n    },\n    link: {\n      tooltip: \"링크 만들기\",\n      secondary_tooltip: \"Mod+K\",\n    },\n    file_caption: {\n      tooltip: \"이미지 캡션 수정\",\n      input_placeholder: \"이미지 캡션 수정\",\n    },\n    file_replace: {\n      tooltip: {\n        image: \"이미지 교체\",\n        video: \"비디오 교체\",\n        audio: \"오디오 교체\",\n        file: \"파일 교체\",\n      },\n    },\n    file_rename: {\n      tooltip: {\n        image: \"이미지 이름 변경\",\n        video: \"비디오 이름 변경\",\n        audio: \"오디오 이름 변경\",\n        file: \"파일 이름 변경\",\n      },\n      input_placeholder: {\n        image: \"이미지 이름 변경\",\n        video: \"비디오 이름 변경\",\n        audio: \"오디오 이름 변경\",\n        file: \"파일 이름 변경\",\n      },\n    },\n    file_download: {\n      tooltip: {\n        image: \"이미지 다운로드\",\n        video: \"비디오 다운로드\",\n        audio: \"오디오 다운로드\",\n        file: \"파일 다운로드\",\n      },\n    },\n    file_delete: {\n      tooltip: {\n        image: \"이미지 삭제\",\n        video: \"비디오 삭제\",\n        audio: \"오디오 삭제\",\n        file: \"파일 삭제\",\n      },\n    },\n    file_preview_toggle: {\n      tooltip: \"미리보기 전환\",\n    },\n    nest: {\n      tooltip: \"중첩 블록\",\n      secondary_tooltip: \"Tab\",\n    },\n    unnest: {\n      tooltip: \"비중첩 블록\",\n      secondary_tooltip: \"Shift+Tab\",\n    },\n    align_left: {\n      tooltip: \"텍스트 왼쪽 맞춤\",\n    },\n    align_center: {\n      tooltip: \"텍스트 가운데 맞춤\",\n    },\n    align_right: {\n      tooltip: \"텍스트 오른쪽 맞춤\",\n    },\n    align_justify: {\n      tooltip: \"텍스트 양쪽 맞춤\",\n    },\n  },\n  file_panel: {\n    upload: {\n      title: \"업로드\",\n      file_placeholder: {\n        image: \"이미지 업로드\",\n        video: \"비디오 업로드\",\n        audio: \"오디오 업로드\",\n        file: \"파일 업로드\",\n      },\n      upload_error: \"오류: 업로드 실패\",\n    },\n    embed: {\n      title: \"임베드\",\n      embed_button: {\n        image: \"이미지 삽입\",\n        video: \"비디오 삽입\",\n        audio: \"오디오 삽입\",\n        file: \"파일 삽입\",\n      },\n      url_placeholder: \"URL을 입력하세요.\",\n    },\n  },\n  link_toolbar: {\n    delete: {\n      tooltip: \"링크 삭제\",\n    },\n    edit: {\n      text: \"링크 수정\",\n      tooltip: \"수정\",\n    },\n    open: {\n      tooltip: \"새 탭으로 열기\",\n    },\n    form: {\n      title_placeholder: \"제목 수정\",\n      url_placeholder: \"URL 수정\",\n    },\n  },\n  generic: {\n    ctrl_shortcut: \"Ctrl\",\n  },\n};\n","import type { Dictionary } from \"../dictionary\";\n\nexport const nl: Dictionary = {\n  slash_menu: {\n    heading: {\n      title: \"Kop 1\",\n      subtext: \"Gebruikt voor een hoofdkop\",\n      aliases: [\"h\", \"kop1\", \"h1\"],\n      group: \"Koppen\",\n    },\n    heading_2: {\n      title: \"Kop 2\",\n      subtext: \"Gebruikt voor belangrijke secties\",\n      aliases: [\"h2\", \"kop2\", \"subkop\"],\n      group: \"Koppen\",\n    },\n    heading_3: {\n      title: \"Kop 3\",\n      subtext: \"Gebruikt voor subsecties en groepskoppen\",\n      aliases: [\"h3\", \"kop3\", \"subkop\"],\n      group: \"Koppen\",\n    },\n    numbered_list: {\n      title: \"Genummerde Lijst\",\n      subtext: \"Gebruikt om een genummerde lijst weer te geven\",\n      aliases: [\"ol\", \"li\", \"lijst\", \"genummerdelijst\", \"genummerde lijst\"],\n      group: \"Basisblokken\",\n    },\n    bullet_list: {\n      title: \"Puntenlijst\",\n      subtext: \"Gebruikt om een ongeordende lijst weer te geven\",\n      aliases: [\"ul\", \"li\", \"lijst\", \"puntenlijst\", \"punten lijst\"],\n      group: \"Basisblokken\",\n    },\n    check_list: {\n      title: \"Controlelijst\",\n      subtext: \"Gebruikt om een lijst met selectievakjes weer te geven\",\n      aliases: [\"ul\", \"li\", \"lijst\", \"aangevinkte lijst\", \"selectievakje\"],\n      group: \"Basisblokken\",\n    },\n    paragraph: {\n      title: \"Paragraaf\",\n      subtext: \"Gebruikt voor de hoofdtekst van uw document\",\n      aliases: [\"p\", \"paragraaf\"],\n      group: \"Basisblokken\",\n    },\n    table: {\n      title: \"Tabel\",\n      subtext: \"Gebruikt voor tabellen\",\n      aliases: [\"tabel\"],\n      group: \"Geavanceerd\",\n    },\n    image: {\n      title: \"Afbeelding\",\n      subtext: \"Voeg een afbeelding in\",\n      aliases: [\n        \"afbeelding\",\n        \"imageUpload\",\n        \"upload\",\n        \"img\",\n        \"foto\",\n        \"media\",\n        \"url\",\n      ],\n      group: \"Media\",\n    },\n    video: {\n      title: \"Video\",\n      subtext: \"Voeg een video in\",\n      aliases: [\n        \"video\",\n        \"videoUploaden\",\n        \"upload\",\n        \"mp4\",\n        \"film\",\n        \"media\",\n        \"url\",\n        \"drive\",\n        \"dropbox\",\n      ],\n      group: \"Media\",\n    },\n    audio: {\n      title: \"Audio\",\n      subtext: \"Voeg audio in\",\n      aliases: [\n        \"audio\",\n        \"audioUploaden\",\n        \"upload\",\n        \"mp3\",\n        \"geluid\",\n        \"media\",\n        \"url\",\n      ],\n      group: \"Media\",\n    },\n    file: {\n      title: \"Bestand\",\n      subtext: \"Voeg een bestand in\",\n      aliases: [\"bestand\", \"upload\", \"insluiten\", \"media\", \"url\"],\n      group: \"Media\",\n    },\n  },\n  placeholders: {\n    default: \"Voer tekst in of type '/' voor commando's\",\n    heading: \"Kop\",\n    bulletListItem: \"Lijst\",\n    numberedListItem: \"Lijst\",\n    checkListItem: \"Lijst\",\n  },\n  file_blocks: {\n    image: {\n      add_button_text: \"Afbeelding toevoegen\",\n    },\n    video: {\n      add_button_text: \"Video toevoegen\",\n    },\n    audio: {\n      add_button_text: \"Audio toevoegen\",\n    },\n    file: {\n      add_button_text: \"Bestand toevoegen\",\n    },\n  },\n  // from react package:\n  side_menu: {\n    add_block_label: \"Nieuw blok\",\n    drag_handle_label: \"Open blok menu\",\n  },\n  drag_handle: {\n    delete_menuitem: \"Verwijder\",\n    colors_menuitem: \"Kleuren\",\n  },\n  table_handle: {\n    delete_column_menuitem: \"Verwijder kolom\",\n    delete_row_menuitem: \"Verwijder rij\",\n    add_left_menuitem: \"Voeg kolom links toe\",\n    add_right_menuitem: \"Voeg kolom rechts toe\",\n    add_above_menuitem: \"Voeg rij boven toe\",\n    add_below_menuitem: \"Voeg rij onder toe\",\n  },\n  suggestion_menu: {\n    no_items_title: \"Geen items gevonden\",\n    loading: \"Laden…\",\n  },\n  color_picker: {\n    text_title: \"Tekst\",\n    background_title: \"Achtergrond\",\n    colors: {\n      default: \"Standaard\",\n      gray: \"Grijs\",\n      brown: \"Bruin\",\n      red: \"Rood\",\n      orange: \"Oranje\",\n      yellow: \"Geel\",\n      green: \"Groen\",\n      blue: \"Blauw\",\n      purple: \"Paars\",\n      pink: \"Roze\",\n    },\n  },\n  formatting_toolbar: {\n    bold: {\n      tooltip: \"Vet\",\n      secondary_tooltip: \"Mod+B\",\n    },\n    italic: {\n      tooltip: \"Cursief\",\n      secondary_tooltip: \"Mod+I\",\n    },\n    underline: {\n      tooltip: \"Onderstrepen\",\n      secondary_tooltip: \"Mod+U\",\n    },\n    strike: {\n      tooltip: \"Doorstrepen\",\n      secondary_tooltip: \"Mod+Shift+X\",\n    },\n    code: {\n      tooltip: \"Code\",\n      secondary_tooltip: \"\",\n    },\n    colors: {\n      tooltip: \"Kleuren\",\n    },\n    link: {\n      tooltip: \"Maak link\",\n      secondary_tooltip: \"Mod+K\",\n    },\n    file_caption: {\n      tooltip: \"Bewerk onderschrift\",\n      input_placeholder: \"Bewerk onderschrift\",\n    },\n    file_replace: {\n      tooltip: {\n        image: \"Afbeelding vervangen\",\n        video: \"Video vervangen\",\n        audio: \"Audio vervangen\",\n        file: \"Bestand vervangen\",\n      },\n    },\n    file_rename: {\n      tooltip: {\n        image: \"Afbeelding hernoemen\",\n        video: \"Video hernoemen\",\n        audio: \"Audio hernoemen\",\n        file: \"Bestand hernoemen\",\n      },\n      input_placeholder: {\n        image: \"Afbeelding hernoemen\",\n        video: \"Video hernoemen\",\n        audio: \"Audio hernoemen\",\n        file: \"Bestand hernoemen\",\n      },\n    },\n    file_download: {\n      tooltip: {\n        image: \"Afbeelding downloaden\",\n        video: \"Video downloaden\",\n        audio: \"Audio downloaden\",\n        file: \"Bestand downloaden\",\n      },\n    },\n    file_delete: {\n      tooltip: {\n        image: \"Afbeelding verwijderen\",\n        video: \"Video verwijderen\",\n        audio: \"Audio verwijderen\",\n        file: \"Bestand verwijderen\",\n      },\n    },\n    file_preview_toggle: {\n      tooltip: \"Voorbeeldschakelaar\",\n    },\n    nest: {\n      tooltip: \"Nest blok\",\n      secondary_tooltip: \"Tab\",\n    },\n    unnest: {\n      tooltip: \"Ontnest blok\",\n      secondary_tooltip: \"Shift+Tab\",\n    },\n    align_left: {\n      tooltip: \"Tekst links uitlijnen\",\n    },\n    align_center: {\n      tooltip: \"Tekst centreren\",\n    },\n    align_right: {\n      tooltip: \"Tekst rechts uitlijnen\",\n    },\n    align_justify: {\n      tooltip: \"Tekst uitvullen\",\n    },\n  },\n  file_panel: {\n    upload: {\n      title: \"Upload\",\n      file_placeholder: {\n        image: \"Afbeelding uploaden\",\n        video: \"Video uploaden\",\n        audio: \"Audio uploaden\",\n        file: \"Bestand uploaden\",\n      },\n      upload_error: \"Fout: Upload mislukt\",\n    },\n    embed: {\n      title: \"Insluiten\",\n      embed_button: {\n        image: \"Afbeelding insluiten\",\n        video: \"Video insluiten\",\n        audio: \"Audio insluiten\",\n        file: \"Bestand insluiten\",\n      },\n      url_placeholder: \"Voer URL in\",\n    },\n  },\n  link_toolbar: {\n    delete: {\n      tooltip: \"Verwijder link\",\n    },\n    edit: {\n      text: \"Bewerk link\",\n      tooltip: \"Bewerk\",\n    },\n    open: {\n      tooltip: \"Open in nieuw tabblad\",\n    },\n    form: {\n      title_placeholder: \"Bewerk titel\",\n      url_placeholder: \"Bewerk URL\",\n    },\n  },\n  generic: {\n    ctrl_shortcut: \"Ctrl\",\n  },\n};\n","import type { Dictionary } from \"../dictionary\";\n\nexport const pl: Dictionary = {\n  slash_menu: {\n    heading: {\n      title: \"Nagłówek 1\",\n      subtext: \"Używany dla nagłówka najwyższego poziomu\",\n      aliases: [\"h\", \"naglowek1\", \"h1\"],\n      group: \"Nagłówki\",\n    },\n    heading_2: {\n      title: \"Nagłówek 2\",\n      subtext: \"Używany dla kluczowych sekcji\",\n      aliases: [\"h2\", \"naglowek2\", \"podnaglowek\"],\n      group: \"Nagłówki\",\n    },\n    heading_3: {\n      title: \"Nagłówek 3\",\n      subtext: \"Używany dla podsekcji i grup nagłówków\",\n      aliases: [\"h3\", \"naglowek3\", \"podnaglowek\"],\n      group: \"Nagłówki\",\n    },\n    numbered_list: {\n      title: \"Lista numerowana\",\n      subtext: \"Używana do wyświetlania listy numerowanej\",\n      aliases: [\"ol\", \"li\", \"lista\", \"numerowana lista\"],\n      group: \"Podstawowe bloki\",\n    },\n    bullet_list: {\n      title: \"Lista punktowana\",\n      subtext: \"Używana do wyświetlania listy bez numeracji\",\n      aliases: [\"ul\", \"li\", \"lista\", \"punktowana lista\"],\n      group: \"Podstawowe bloki\",\n    },\n    check_list: {\n      title: \"Lista z polami wyboru\",\n      subtext: \"Używana do wyświetlania listy z polami wyboru\",\n      aliases: [\"ul\", \"li\", \"lista\", \"lista z polami wyboru\", \"pole wyboru\"],\n      group: \"Podstawowe bloki\",\n    },\n    paragraph: {\n      title: \"Akapit\",\n      subtext: \"Używany dla treści dokumentu\",\n      aliases: [\"p\", \"akapit\"],\n      group: \"Podstawowe bloki\",\n    },\n    table: {\n      title: \"Tabela\",\n      subtext: \"Używana do tworzenia tabel\",\n      aliases: [\"tabela\"],\n      group: \"Zaawansowane\",\n    },\n    image: {\n      title: \"Zdjęcie\",\n      subtext: \"Wstaw zdjęcie\",\n      aliases: [\n        \"obraz\",\n        \"wrzućZdjęcie\",\n        \"wrzuć\",\n        \"img\",\n        \"zdjęcie\",\n        \"media\",\n        \"url\",\n      ],\n      group: \"Media\",\n    },\n    video: {\n      title: \"Wideo\",\n      subtext: \"Wstaw wideo\",\n      aliases: [\"wideo\", \"wrzućWideo\", \"wrzuć\", \"mp4\", \"film\", \"media\", \"url\"],\n      group: \"Media\",\n    },\n    audio: {\n      title: \"Audio\",\n      subtext: \"Wstaw audio\",\n      aliases: [\n        \"audio\",\n        \"wrzućAudio\",\n        \"wrzuć\",\n        \"mp3\",\n        \"dźwięk\",\n        \"media\",\n        \"url\",\n      ],\n      group: \"Media\",\n    },\n    file: {\n      title: \"Plik\",\n      subtext: \"Wstaw plik\",\n      aliases: [\"plik\", \"wrzuć\", \"wstaw\", \"media\", \"url\"],\n      group: \"Media\",\n    },\n  },\n  placeholders: {\n    default: \"Wprowadź tekst lub wpisz '/' aby użyć poleceń\",\n    heading: \"Nagłówek\",\n    bulletListItem: \"Lista\",\n    numberedListItem: \"Lista\",\n    checkListItem: \"Lista\",\n  },\n  file_blocks: {\n    image: {\n      add_button_text: \"Dodaj zdjęcie\",\n    },\n    video: {\n      add_button_text: \"Dodaj wideo\",\n    },\n    audio: {\n      add_button_text: \"Dodaj audio\",\n    },\n    file: {\n      add_button_text: \"Dodaj plik\",\n    },\n  },\n  side_menu: {\n    add_block_label: \"Dodaj blok\",\n    drag_handle_label: \"Otwórz menu bloków\",\n  },\n  drag_handle: {\n    delete_menuitem: \"Usuń\",\n    colors_menuitem: \"Kolory\",\n  },\n  table_handle: {\n    delete_column_menuitem: \"Usuń kolumnę\",\n    delete_row_menuitem: \"Usuń wiersz\",\n    add_left_menuitem: \"Dodaj kolumnę po lewej\",\n    add_right_menuitem: \"Dodaj kolumnę po prawej\",\n    add_above_menuitem: \"Dodaj wiersz powyżej\",\n    add_below_menuitem: \"Dodaj wiersz poniżej\",\n  },\n  suggestion_menu: {\n    no_items_title: \"Nie znaleziono elementów\",\n    loading: \"Ładowanie…\",\n  },\n  color_picker: {\n    text_title: \"Tekst\",\n    background_title: \"Tło\",\n    colors: {\n      default: \"Domyślny\",\n      gray: \"Szary\",\n      brown: \"Brązowy\",\n      red: \"Czerwony\",\n      orange: \"Pomarańczowy\",\n      yellow: \"Żółty\",\n      green: \"Zielony\",\n      blue: \"Niebieski\",\n      purple: \"Fioletowy\",\n      pink: \"Różowy\",\n    },\n  },\n\n  formatting_toolbar: {\n    bold: {\n      tooltip: \"Pogrubienie\",\n      secondary_tooltip: \"Mod+B\",\n    },\n    italic: {\n      tooltip: \"Kursywa\",\n      secondary_tooltip: \"Mod+I\",\n    },\n    underline: {\n      tooltip: \"Podkreślenie\",\n      secondary_tooltip: \"Mod+U\",\n    },\n    strike: {\n      tooltip: \"Przekreślenie\",\n      secondary_tooltip: \"Mod+Shift+X\",\n    },\n    code: {\n      tooltip: \"Kod\",\n      secondary_tooltip: \"\",\n    },\n    colors: {\n      tooltip: \"Kolory\",\n    },\n    link: {\n      tooltip: \"Utwórz link\",\n      secondary_tooltip: \"Mod+K\",\n    },\n    file_caption: {\n      tooltip: \"Zmień podpis\",\n      input_placeholder: \"Zmień podpis\",\n    },\n    file_replace: {\n      tooltip: {\n        image: \"Zmień obraz\",\n        video: \"Zmień wideo\",\n        audio: \"Zmień audio\",\n        file: \"Zmień plik\",\n      },\n    },\n    file_rename: {\n      tooltip: {\n        image: \"Zmień nazwę zdjęcia\",\n        video: \"Zmień nazwę wideo\",\n        audio: \"Zmień nazwę audio\",\n        file: \"Zmień nazwę pliku\",\n      },\n      input_placeholder: {\n        image: \"Zmień nazwę zdjęcia\",\n        video: \"Zmień nazwę wideo\",\n        audio: \"Zmień nazwę audio\",\n        file: \"Zmień nazwę pliku\",\n      },\n    },\n    file_download: {\n      tooltip: {\n        image: \"Pobierz zdjęcie\",\n        video: \"Pobierz wideo\",\n        audio: \"Pobierz audio\",\n        file: \"Pobierz plik\",\n      },\n    },\n    file_delete: {\n      tooltip: {\n        image: \"Usuń zdjęcie\",\n        video: \"Usuń wideo\",\n        audio: \"Usuń audio\",\n        file: \"Usuń plik\",\n      },\n    },\n    file_preview_toggle: {\n      tooltip: \"Przełącz podgląd\",\n    },\n    nest: {\n      tooltip: \"Zagnieźdź blok\",\n      secondary_tooltip: \"Tab\",\n    },\n    unnest: {\n      tooltip: \"Odgagnieźdź blok\",\n      secondary_tooltip: \"Shift+Tab\",\n    },\n    align_left: {\n      tooltip: \"Wyrównaj tekst do lewej\",\n    },\n    align_center: {\n      tooltip: \"Wyśrodkuj tekst\",\n    },\n    align_right: {\n      tooltip: \"Wyrównaj tekst do prawej\",\n    },\n    align_justify: {\n      tooltip: \"Wyjustuj tekst\",\n    },\n  },\n  file_panel: {\n    upload: {\n      title: \"Wrzuć\",\n      file_placeholder: {\n        image: \"Wrzuć zdjęcie\",\n        video: \"Wrzuć wideo\",\n        audio: \"Wrzuć audio\",\n        file: \"Wrzuć plik\",\n      },\n      upload_error: \"Błąd: Przesyłanie nie powiodło się\",\n    },\n    embed: {\n      title: \"Wstaw\",\n      embed_button: {\n        image: \"Wstaw zdjęice\",\n        video: \"Wstaw wideo\",\n        audio: \"Wstaw audio\",\n        file: \"Wstaw plik\",\n      },\n      url_placeholder: \"Wprowadź URL\",\n    },\n  },\n  link_toolbar: {\n    delete: {\n      tooltip: \"Usuń link\",\n    },\n    edit: {\n      text: \"Edytuj link\",\n      tooltip: \"Edytuj\",\n    },\n    open: {\n      tooltip: \"Otwórz w nowej karcie\",\n    },\n    form: {\n      title_placeholder: \"Edytuj tytuł\",\n      url_placeholder: \"Edytuj URL\",\n    },\n  },\n  generic: {\n    ctrl_shortcut: \"Ctrl\",\n  },\n};\n","import type { Dictionary } from \"../dictionary\";\n\nexport const pt: Dictionary = {\n  slash_menu: {\n    heading: {\n      title: \"Título\",\n      subtext: \"Usado para um título de nível superior\",\n      aliases: [\"h\", \"titulo1\", \"h1\"],\n      group: \"Títulos\",\n    },\n    heading_2: {\n      title: \"Título 2\",\n      subtext: \"Usado para seções principais\",\n      aliases: [\"h2\", \"titulo2\", \"subtitulo\"],\n      group: \"Títulos\",\n    },\n    heading_3: {\n      title: \"Título 3\",\n      subtext: \"Usado para subseções e títulos de grupo\",\n      aliases: [\"h3\", \"titulo3\", \"subtitulo\"],\n      group: \"Títulos\",\n    },\n    numbered_list: {\n      title: \"Lista Numerada\",\n      subtext: \"Usado para exibir uma lista numerada\",\n      aliases: [\"ol\", \"li\", \"lista\", \"listanumerada\", \"lista numerada\"],\n      group: \"Blocos Básicos\",\n    },\n    bullet_list: {\n      title: \"Lista com Marcadores\",\n      subtext: \"Usado para exibir uma lista não ordenada\",\n      aliases: [\"ul\", \"li\", \"lista\", \"listamarcadores\", \"lista com marcadores\"],\n      group: \"Blocos Básicos\",\n    },\n    check_list: {\n      title: \"Lista de verificação\",\n      subtext: \"Usado para exibir uma lista com caixas de seleção\",\n      aliases: [\n        \"ul\",\n        \"li\",\n        \"lista\",\n        \"lista de verificação\",\n        \"lista marcada\",\n        \"caixa de seleção\",\n      ],\n      group: \"Blocos Básicos\",\n    },\n    paragraph: {\n      title: \"Parágrafo\",\n      subtext: \"Usado para o corpo do seu documento\",\n      aliases: [\"p\", \"paragrafo\"],\n      group: \"Blocos Básicos\",\n    },\n    table: {\n      title: \"Tabela\",\n      subtext: \"Usado para tabelas\",\n      aliases: [\"tabela\"],\n      group: \"Avançado\",\n    },\n    image: {\n      title: \"Imagem\",\n      subtext: \"Inserir uma imagem\",\n      aliases: [\n        \"imagem\",\n        \"uploadImagem\",\n        \"upload\",\n        \"img\",\n        \"foto\",\n        \"media\",\n        \"url\",\n      ],\n      group: \"Mídia\",\n    },\n    video: {\n      title: \"Vídeo\",\n      subtext: \"Inserir um vídeo\",\n      aliases: [\n        \"vídeo\",\n        \"uploadVídeo\",\n        \"upload\",\n        \"mp4\",\n        \"filme\",\n        \"mídia\",\n        \"url\",\n      ],\n      group: \"Mídia\",\n    },\n    audio: {\n      title: \"Áudio\",\n      subtext: \"Inserir um áudio\",\n      aliases: [\"áudio\", \"uploadÁudio\", \"upload\", \"mp3\", \"som\", \"mídia\", \"url\"],\n      group: \"Mídia\",\n    },\n    file: {\n      title: \"Arquivo\",\n      subtext: \"Inserir um arquivo\",\n      aliases: [\"arquivo\", \"upload\", \"incorporar\", \"mídia\", \"url\"],\n      group: \"Mídia\",\n    },\n  },\n  placeholders: {\n    default: \"Digite texto ou use '/' para comandos\",\n    heading: \"Título\",\n    bulletListItem: \"Lista\",\n    numberedListItem: \"Lista\",\n    checkListItem: \"Lista\",\n  },\n  file_blocks: {\n    image: {\n      add_button_text: \"Adicionar imagem\",\n    },\n    video: {\n      add_button_text: \"Adicionar vídeo\",\n    },\n    audio: {\n      add_button_text: \"Adicionar áudio\",\n    },\n    file: {\n      add_button_text: \"Adicionar arquivo\",\n    },\n  },\n  // from react package:\n  side_menu: {\n    add_block_label: \"Adicionar bloco\",\n    drag_handle_label: \"Abrir menu do bloco\",\n  },\n  drag_handle: {\n    delete_menuitem: \"Excluir\",\n    colors_menuitem: \"Cores\",\n  },\n  table_handle: {\n    delete_column_menuitem: \"Excluir coluna\",\n    delete_row_menuitem: \"Excluir linha\",\n    add_left_menuitem: \"Adicionar coluna à esquerda\",\n    add_right_menuitem: \"Adicionar coluna à direita\",\n    add_above_menuitem: \"Adicionar linha acima\",\n    add_below_menuitem: \"Adicionar linha abaixo\",\n  },\n  suggestion_menu: {\n    no_items_title: \"Nenhum item encontrado\",\n    loading: \"Carregando…\",\n  },\n  color_picker: {\n    text_title: \"Texto\",\n    background_title: \"Fundo\",\n    colors: {\n      default: \"Padrão\",\n      gray: \"Cinza\",\n      brown: \"Marrom\",\n      red: \"Vermelho\",\n      orange: \"Laranja\",\n      yellow: \"Amarelo\",\n      green: \"Verde\",\n      blue: \"Azul\",\n      purple: \"Roxo\",\n      pink: \"Rosa\",\n    },\n  },\n\n  formatting_toolbar: {\n    bold: {\n      tooltip: \"Negrito\",\n      secondary_tooltip: \"Mod+B\",\n    },\n    italic: {\n      tooltip: \"Itálico\",\n      secondary_tooltip: \"Mod+I\",\n    },\n    underline: {\n      tooltip: \"Sublinhado\",\n      secondary_tooltip: \"Mod+U\",\n    },\n    strike: {\n      tooltip: \"Riscado\",\n      secondary_tooltip: \"Mod+Shift+X\",\n    },\n    code: {\n      tooltip: \"Código\",\n      secondary_tooltip: \"\",\n    },\n    colors: {\n      tooltip: \"Cores\",\n    },\n    link: {\n      tooltip: \"Criar link\",\n      secondary_tooltip: \"Mod+K\",\n    },\n    file_caption: {\n      tooltip: \"Editar legenda\",\n      input_placeholder: \"Editar legenda\",\n    },\n    file_replace: {\n      tooltip: {\n        image: \"Substituir imagem\",\n        video: \"Substituir vídeo\",\n        audio: \"Substituir áudio\",\n        file: \"Substituir arquivo\",\n      },\n    },\n    file_rename: {\n      tooltip: {\n        image: \"Renomear imagem\",\n        video: \"Renomear vídeo\",\n        audio: \"Renomear áudio\",\n        file: \"Renomear arquivo\",\n      },\n      input_placeholder: {\n        image: \"Renomear imagem\",\n        video: \"Renomear vídeo\",\n        audio: \"Renomear áudio\",\n        file: \"Renomear arquivo\",\n      },\n    },\n    file_download: {\n      tooltip: {\n        image: \"Baixar imagem\",\n        video: \"Baixar vídeo\",\n        audio: \"Baixar áudio\",\n        file: \"Baixar arquivo\",\n      },\n    },\n    file_delete: {\n      tooltip: {\n        image: \"Excluir imagem\",\n        video: \"Excluir vídeo\",\n        audio: \"Excluir áudio\",\n        file: \"Excluir arquivo\",\n      },\n    },\n    file_preview_toggle: {\n      tooltip: \"Alternar visualização\",\n    },\n    nest: {\n      tooltip: \"Aninhar bloco\",\n      secondary_tooltip: \"Tab\",\n    },\n    unnest: {\n      tooltip: \"Desaninhar bloco\",\n      secondary_tooltip: \"Shift+Tab\",\n    },\n    align_left: {\n      tooltip: \"Alinhar à esquerda\",\n    },\n    align_center: {\n      tooltip: \"Alinhar ao centro\",\n    },\n    align_right: {\n      tooltip: \"Alinhar à direita\",\n    },\n    align_justify: {\n      tooltip: \"Justificar texto\",\n    },\n  },\n  file_panel: {\n    upload: {\n      title: \"Upload\",\n      file_placeholder: {\n        image: \"Upload de imagem\",\n        video: \"Upload de vídeo\",\n        audio: \"Upload de áudio\",\n        file: \"Upload de arquivo\",\n      },\n      upload_error: \"Erro: Falha no upload\",\n    },\n    embed: {\n      title: \"Incorporar\",\n      embed_button: {\n        image: \"Incorporar imagem\",\n        video: \"Incorporar vídeo\",\n        audio: \"Incorporar áudio\",\n        file: \"Incorporar arquivo\",\n      },\n      url_placeholder: \"Insira a URL\",\n    },\n  },\n  link_toolbar: {\n    delete: {\n      tooltip: \"Remover link\",\n    },\n    edit: {\n      text: \"Editar link\",\n      tooltip: \"Editar\",\n    },\n    open: {\n      tooltip: \"Abrir em nova aba\",\n    },\n    form: {\n      title_placeholder: \"Editar título\",\n      url_placeholder: \"Editar URL\",\n    },\n  },\n  generic: {\n    ctrl_shortcut: \"Ctrl\",\n  },\n};\n","import type { Dictionary } from \"../dictionary\";\n\nexport const vi: Dictionary = {\n  slash_menu: {\n    heading: {\n      title: \"Tiêu đề H1\",\n      subtext: \"Sử dụng cho tiêu đề cấp cao nhất\",\n      aliases: [\"h\", \"tieude1\", \"dd1\"],\n      group: \"Tiêu đề\",\n    },\n    heading_2: {\n      title: \"Tiêu đề H2\",\n      subtext: \"Sử dụng cho các phần chính\",\n      aliases: [\"h2\", \"tieude2\", \"tieudephu\"],\n      group: \"Tiêu đề\",\n    },\n    heading_3: {\n      title: \"Tiêu đề H3\",\n      subtext: \"Sử dụng cho phụ đề và tiêu đề nhóm\",\n      aliases: [\"h3\", \"tieude3\", \"tieudephu\"],\n      group: \"Tiêu đề\",\n    },\n    numbered_list: {\n      title: \"Danh sách đánh số\",\n      subtext: \"Sử dụng để hiển thị danh sách có đánh số\",\n      aliases: [\"ol\", \"li\", \"ds\", \"danhsachdso\", \"danh sach danh so\"],\n      group: \"Khối cơ bản\",\n    },\n    bullet_list: {\n      title: \"Danh sách\",\n      subtext: \"Sử dụng để hiển thị danh sách không đánh số\",\n      aliases: [\"ul\", \"li\", \"ds\", \"danhsach\", \"danh sach\"],\n      group: \"Khối cơ bản\",\n    },\n    check_list: {\n      title: \"Danh sách kiểm tra\",\n      subtext: \"Dùng để hiển thị danh sách có hộp kiểm\",\n      aliases: [\n        \"ul\",\n        \"li\",\n        \"danh sach\",\n        \"danh sach kiem tra\",\n        \"danh sach da kiem tra\",\n        \"hop kiem\",\n      ],\n      group: \"Khối cơ bản\",\n    },\n    paragraph: {\n      title: \"Đoạn văn\",\n      subtext: \"Sử dụng cho nội dung chính của tài liệu\",\n      aliases: [\"p\", \"doanvan\"],\n      group: \"Khối cơ bản\",\n    },\n    table: {\n      title: \"Bảng\",\n      subtext: \"Sử dụng để tạo bảng\",\n      aliases: [\"bang\"],\n      group: \"Nâng cao\",\n    },\n    image: {\n      title: \"Hình ảnh\",\n      subtext: \"Chèn hình ảnh\",\n      aliases: [\"anh\", \"tai-len-anh\", \"tai-len\", \"img\", \"hinh\", \"media\", \"url\"],\n      group: \"Phương tiện\",\n    },\n    video: {\n      title: \"Video\",\n      subtext: \"Chèn video\",\n      aliases: [\n        \"video\",\n        \"tai-len-video\",\n        \"tai-len\",\n        \"mp4\",\n        \"phim\",\n        \"media\",\n        \"url\",\n      ],\n      group: \"Phương tiện\",\n    },\n    audio: {\n      title: \"Âm thanh\",\n      subtext: \"Chèn âm thanh\",\n      aliases: [\n        \"âm thanh\",\n        \"tai-len-am-thanh\",\n        \"tai-len\",\n        \"mp3\",\n        \"am thanh\",\n        \"media\",\n        \"url\",\n      ],\n      group: \"Phương tiện\",\n    },\n    file: {\n      title: \"Tệp\",\n      subtext: \"Chèn tệp\",\n      aliases: [\"tep\", \"tai-len\", \"nhung\", \"media\", \"url\"],\n      group: \"Phương tiện\",\n    },\n  },\n  placeholders: {\n    default: \"Nhập văn bản hoặc gõ '/' để thêm định dạng\",\n    heading: \"Tiêu đề\",\n    bulletListItem: \"Danh sách\",\n    numberedListItem: \"Danh sách\",\n    checkListItem: \"Danh sách\",\n  },\n  file_blocks: {\n    image: {\n      add_button_text: \"Thêm ảnh\",\n    },\n    video: {\n      add_button_text: \"Thêm video\",\n    },\n    audio: {\n      add_button_text: \"Thêm âm thanh\",\n    },\n    file: {\n      add_button_text: \"Thêm tệp\",\n    },\n  },\n  // từ gói phản ứng:\n  side_menu: {\n    add_block_label: \"Thêm khối\",\n    drag_handle_label: \"Mở trình đơn khối\",\n  },\n  drag_handle: {\n    delete_menuitem: \"Xóa\",\n    colors_menuitem: \"Màu sắc\",\n  },\n  table_handle: {\n    delete_column_menuitem: \"Xóa cột\",\n    delete_row_menuitem: \"Xóa hàng\",\n    add_left_menuitem: \"Thêm cột bên trái\",\n    add_right_menuitem: \"Thêm cột bên phải\",\n    add_above_menuitem: \"Thêm hàng phía trên\",\n    add_below_menuitem: \"Thêm hàng phía dưới\",\n  },\n  suggestion_menu: {\n    no_items_title: \"Không tìm thấy mục nào\",\n    loading: \"Đang tải...\",\n  },\n  color_picker: {\n    text_title: \"Văn bản\",\n    background_title: \"Nền\",\n    colors: {\n      default: \"Mặc định\",\n      gray: \"Xám\",\n      brown: \"Nâu\",\n      red: \"Đỏ\",\n      orange: \"Cam\",\n      yellow: \"Vàng\",\n      green: \"Xanh lá\",\n      blue: \"Xanh dương\",\n      purple: \"Tím\",\n      pink: \"Hồng\",\n    },\n  },\n\n  formatting_toolbar: {\n    bold: {\n      tooltip: \"In đậm\",\n      secondary_tooltip: \"Mod+B\",\n    },\n    italic: {\n      tooltip: \"In nghiêng\",\n      secondary_tooltip: \"Mod+I\",\n    },\n    underline: {\n      tooltip: \"Gạch dưới\",\n      secondary_tooltip: \"Mod+U\",\n    },\n    strike: {\n      tooltip: \"Gạch ngang\",\n      secondary_tooltip: \"Mod+Shift+X\",\n    },\n    code: {\n      tooltip: \"Code\",\n      secondary_tooltip: \"\",\n    },\n    colors: {\n      tooltip: \"Màu sắc\",\n    },\n    link: {\n      tooltip: \"Tạo liên kết\",\n      secondary_tooltip: \"Mod+K\",\n    },\n    file_caption: {\n      tooltip: \"Chỉnh sửa chú thích\",\n      input_placeholder: \"Chỉnh sửa chú thích\",\n    },\n    file_replace: {\n      tooltip: {\n        image: \"Thay thế hình ảnh\",\n        video: \"Thay thế video\",\n        audio: \"Thay thế âm thanh\",\n        file: \"Thay thế tệp\",\n      },\n    },\n    file_rename: {\n      tooltip: {\n        image: \"Đổi tên hình ảnh\",\n        video: \"Đổi tên video\",\n        audio: \"Đổi tên âm thanh\",\n        file: \"Đổi tên tệp\",\n      },\n      input_placeholder: {\n        image: \"Đổi tên hình ảnh\",\n        video: \"Đổi tên video\",\n        audio: \"Đổi tên âm thanh\",\n        file: \"Đổi tên tệp\",\n      },\n    },\n    file_download: {\n      tooltip: {\n        image: \"Tải xuống hình ảnh\",\n        video: \"Tải xuống video\",\n        audio: \"Tải xuống âm thanh\",\n        file: \"Tải xuống tệp\",\n      },\n    },\n    file_delete: {\n      tooltip: {\n        image: \"Xóa hình ảnh\",\n        video: \"Xóa video\",\n        audio: \"Xóa âm thanh\",\n        file: \"Xóa tệp\",\n      },\n    },\n    file_preview_toggle: {\n      tooltip: \"Chuyển đổi xem trước\",\n    },\n    nest: {\n      tooltip: \"Lồng khối\",\n      secondary_tooltip: \"Tab\",\n    },\n    unnest: {\n      tooltip: \"Bỏ lồng khối\",\n      secondary_tooltip: \"Shift+Tab\",\n    },\n    align_left: {\n      tooltip: \"Căn trái văn bản\",\n    },\n    align_center: {\n      tooltip: \"Căn giữa văn bản\",\n    },\n    align_right: {\n      tooltip: \"Căn phải văn bản\",\n    },\n    align_justify: {\n      tooltip: \"Căn đều văn bản\",\n    },\n  },\n  file_panel: {\n    upload: {\n      title: \"Tải lên\",\n      file_placeholder: {\n        image: \"Tải lên hình ảnh\",\n        video: \"Tải lên video\",\n        audio: \"Tải lên âm thanh\",\n        file: \"Tải lên tệp\",\n      },\n      upload_error: \"Lỗi: Tải lên thất bại\",\n    },\n    embed: {\n      title: \"Nhúng\",\n      embed_button: {\n        image: \"Nhúng hình ảnh\",\n        video: \"Nhúng video\",\n        audio: \"Nhúng âm thanh\",\n        file: \"Nhúng tệp\",\n      },\n      url_placeholder: \"Nhập URL\",\n    },\n  },\n  link_toolbar: {\n    delete: {\n      tooltip: \"Xóa liên kết\",\n    },\n    edit: {\n      text: \"Chỉnh sửa liên kết\",\n      tooltip: \"Chỉnh sửa\",\n    },\n    open: {\n      tooltip: \"Mở trong tab mới\",\n    },\n    form: {\n      title_placeholder: \"Chỉnh sửa tiêu đề\",\n      url_placeholder: \"Chỉnh sửa URL\",\n    },\n  },\n  generic: {\n    ctrl_shortcut: \"Ctrl\",\n  },\n};\n","import type { Dictionary } from \"../dictionary\";\n\nexport const zh: Dictionary = {\n  slash_menu: {\n    heading: {\n      title: \"一级标题\",\n      subtext: \"用于顶级标题\",\n      aliases: [\"h\", \"heading1\", \"h1\", \"标题\", \"一级标题\"],\n      group: \"标题\",\n    },\n    heading_2: {\n      title: \"二级标题\",\n      subtext: \"用于关键部分\",\n      aliases: [\"h2\", \"heading2\", \"subheading\", \"标题\", \"二级标题\", \"副标题\"],\n      group: \"标题\",\n    },\n    heading_3: {\n      title: \"三级标题\",\n      subtext: \"用于小节和分组标题\",\n      aliases: [\"h3\", \"heading3\", \"subheading\", \"标题\", \"三级标题\"],\n      group: \"标题\",\n    },\n    numbered_list: {\n      title: \"有序列表\",\n      subtext: \"用于显示有序列表\",\n      aliases: [\n        \"ol\",\n        \"li\",\n        \"list\",\n        \"numberedlist\",\n        \"numbered list\",\n        \"列表\",\n        \"有序列表\",\n      ],\n      group: \"基础\",\n    },\n    bullet_list: {\n      title: \"无序列表\",\n      subtext: \"用于显示无序列表\",\n      aliases: [\n        \"ul\",\n        \"li\",\n        \"list\",\n        \"bulletlist\",\n        \"bullet list\",\n        \"列表\",\n        \"无序列表\",\n      ],\n      group: \"基础\",\n    },\n    check_list: {\n      title: \"检查清单\",\n      subtext: \"用于显示带有复选框的列表\",\n      aliases: [\n        \"ul\",\n        \"li\",\n        \"checklist\",\n        \"checked list\",\n        \"列表\",\n        \"检查清单\",\n        \"勾选列表\",\n        \"复选框\",\n      ],\n      group: \"基础\",\n    },\n    paragraph: {\n      title: \"段落\",\n      subtext: \"用于文档正文\",\n      aliases: [\"p\", \"paragraph\", \"text\", \"正文\"],\n      group: \"基础\",\n    },\n    table: {\n      title: \"表格\",\n      subtext: \"使用表格\",\n      aliases: [\"table\", \"表格\"],\n      group: \"高级功能\",\n    },\n    image: {\n      title: \"图片\",\n      subtext: \"插入图片\",\n      aliases: [\n        \"图片\",\n        \"上传图片\",\n        \"上传\",\n        \"image\",\n        \"img\",\n        \"相册\",\n        \"媒体\",\n        \"url\",\n      ],\n      group: \"媒体\",\n    },\n    video: {\n      title: \"视频\",\n      subtext: \"插入视频\",\n      aliases: [\n        \"视频\",\n        \"视频上传\",\n        \"上传\",\n        \"video\",\n        \"mp4\",\n        \"电影\",\n        \"媒体\",\n        \"url\",\n        \"驱动\",\n        \"dropbox\",\n      ],\n      group: \"媒体\",\n    },\n    audio: {\n      title: \"音频\",\n      subtext: \"插入音频\",\n      aliases: [\n        \"音频\",\n        \"音频上传\",\n        \"上传\",\n        \"audio\",\n        \"mp3\",\n        \"声音\",\n        \"媒体\",\n        \"url\",\n        \"驱动\",\n        \"dropbox\",\n      ],\n      group: \"媒体\",\n    },\n    file: {\n      title: \"文件\",\n      subtext: \"插入文件\",\n      aliases: [\"文件\", \"上传\", \"file\", \"嵌入\", \"媒体\", \"url\"],\n      group: \"媒体\",\n    },\n  },\n  placeholders: {\n    default: \"输入 '/' 以使用命令\",\n    heading: \"标题\",\n    bulletListItem: \"列表\",\n    numberedListItem: \"列表\",\n    checkListItem: \"列表\",\n  },\n  file_blocks: {\n    image: {\n      add_button_text: \"添加图片\",\n    },\n    video: {\n      add_button_text: \"添加视频\",\n    },\n    audio: {\n      add_button_text: \"添加音频\",\n    },\n    file: {\n      add_button_text: \"添加文件\",\n    },\n  },\n  // from react package:\n  side_menu: {\n    add_block_label: \"添加块\",\n    drag_handle_label: \"打开菜单\",\n  },\n  drag_handle: {\n    delete_menuitem: \"删除\",\n    colors_menuitem: \"颜色\",\n  },\n  table_handle: {\n    delete_column_menuitem: \"删除列\",\n    delete_row_menuitem: \"删除行\",\n    add_left_menuitem: \"左侧添加列\",\n    add_right_menuitem: \"右侧添加列\",\n    add_above_menuitem: \"上方添加行\",\n    add_below_menuitem: \"下方添加行\",\n  },\n  suggestion_menu: {\n    no_items_title: \"无匹配项\",\n    loading: \"加载中…\",\n  },\n  color_picker: {\n    text_title: \"文本\",\n    background_title: \"背景色\",\n    colors: {\n      default: \"默认\",\n      gray: \"灰色\",\n      brown: \"棕色\",\n      red: \"红色\",\n      orange: \"橙色\",\n      yellow: \"黄色\",\n      green: \"绿色\",\n      blue: \"蓝色\",\n      purple: \"紫色\",\n      pink: \"粉色\",\n    },\n  },\n\n  formatting_toolbar: {\n    bold: {\n      tooltip: \"加粗\",\n      secondary_tooltip: \"Mod+B\",\n    },\n    italic: {\n      tooltip: \"斜体\",\n      secondary_tooltip: \"Mod+I\",\n    },\n    underline: {\n      tooltip: \"下划线\",\n      secondary_tooltip: \"Mod+U\",\n    },\n    strike: {\n      tooltip: \"删除线\",\n      secondary_tooltip: \"Mod+Shift+X\",\n    },\n    code: {\n      tooltip: \"代码标记\",\n      secondary_tooltip: \"\",\n    },\n    colors: {\n      tooltip: \"颜色\",\n    },\n    link: {\n      tooltip: \"添加链接\",\n      secondary_tooltip: \"Mod+K\",\n    },\n    file_caption: {\n      tooltip: \"编辑标题\",\n      input_placeholder: \"编辑标题\",\n    },\n    file_replace: {\n      tooltip: {\n        image: \"替换图片\",\n        video: \"替换视频\",\n        audio: \"替换音频\",\n        file: \"替换文件\",\n      },\n    },\n    file_rename: {\n      tooltip: {\n        image: \"重命名图片\",\n        video: \"重命名视频\",\n        audio: \"重命名音频\",\n        file: \"重命名文件\",\n      },\n      input_placeholder: {\n        image: \"重命名图片\",\n        video: \"重命名视频\",\n        audio: \"重命名音频\",\n        file: \"重命名文件\",\n      },\n    },\n    file_download: {\n      tooltip: {\n        image: \"下载图片\",\n        video: \"下载视频\",\n        audio: \"下载音频\",\n        file: \"下载文件\",\n      },\n    },\n    file_delete: {\n      tooltip: {\n        image: \"删除图片\",\n        video: \"删除视频\",\n        audio: \"删除音频\",\n        file: \"删除文件\",\n      },\n    },\n    file_preview_toggle: {\n      tooltip: \"切换预览\",\n    },\n    nest: {\n      tooltip: \"嵌套\",\n      secondary_tooltip: \"Tab\",\n    },\n    unnest: {\n      tooltip: \"取消嵌套\",\n      secondary_tooltip: \"Shift+Tab\",\n    },\n    align_left: {\n      tooltip: \"左对齐\",\n    },\n    align_center: {\n      tooltip: \"居中\",\n    },\n    align_right: {\n      tooltip: \"右对齐\",\n    },\n    align_justify: {\n      tooltip: \"文本对齐\",\n    },\n  },\n  file_panel: {\n    upload: {\n      title: \"上传\",\n      file_placeholder: {\n        image: \"上传图片\",\n        video: \"上传视频\",\n        audio: \"上传音频\",\n        file: \"上传文件\",\n      },\n      upload_error: \"Error：上传失败\",\n    },\n    embed: {\n      title: \"嵌入\",\n      embed_button: {\n        image: \"嵌入图片\",\n        video: \"嵌入视频\",\n        audio: \"嵌入音频\",\n        file: \"嵌入文件\",\n      },\n      url_placeholder: \"输入图片地址\",\n    },\n  },\n  link_toolbar: {\n    delete: {\n      tooltip: \"清除链接\",\n    },\n    edit: {\n      text: \"编辑链接\",\n      tooltip: \"编辑\",\n    },\n    open: {\n      tooltip: \"新窗口打开\",\n    },\n    form: {\n      title_placeholder: \"编辑标题\",\n      url_placeholder: \"编辑链接地址\",\n    },\n  },\n  generic: {\n    ctrl_shortcut: \"Ctrl\",\n  },\n};\n","import {\n  combineTransactionSteps,\n  Extension,\n  findChildrenInRange,\n  getChangedRanges,\n} from \"@tiptap/core\";\nimport { Fragment, Slice } from \"prosemirror-model\";\nimport { Plugin, PluginKey } from \"prosemirror-state\";\nimport { v4 } from \"uuid\";\n\n/**\n * Code from Tiptap UniqueID extension (https://tiptap.dev/api/extensions/unique-id)\n * This extension is licensed under MIT (even though it's part of Tiptap pro).\n *\n * If you're a user of BlockNote, we still recommend to support their awesome work and become a sponsor!\n * https://tiptap.dev/pro\n */\n\n/**\n * Removes duplicated values within an array.\n * Supports numbers, strings and objects.\n */\nfunction removeDuplicates(array: any, by = JSON.stringify) {\n  const seen: any = {};\n  return array.filter((item: any) => {\n    const key = by(item);\n    return Object.prototype.hasOwnProperty.call(seen, key)\n      ? false\n      : (seen[key] = true);\n  });\n}\n\n/**\n * Returns a list of duplicated items within an array.\n */\nfunction findDuplicates(items: any) {\n  const filtered = items.filter(\n    (el: any, index: number) => items.indexOf(el) !== index\n  );\n  const duplicates = removeDuplicates(filtered);\n  return duplicates;\n}\n\nconst UniqueID = Extension.create({\n  name: \"uniqueID\",\n  // we’ll set a very high priority to make sure this runs first\n  // and is compatible with `appendTransaction` hooks of other extensions\n  priority: 10000,\n  addOptions() {\n    return {\n      attributeName: \"id\",\n      types: [],\n      generateID: () => {\n        // Use mock ID if tests are running.\n        if (typeof window !== \"undefined\" && (window as any).__TEST_OPTIONS) {\n          const testOptions = (window as any).__TEST_OPTIONS;\n          if (testOptions.mockID === undefined) {\n            testOptions.mockID = 0;\n          } else {\n            testOptions.mockID++;\n          }\n\n          return testOptions.mockID.toString() as string;\n        }\n\n        return v4();\n      },\n      filterTransaction: null,\n    };\n  },\n  addGlobalAttributes() {\n    return [\n      {\n        types: this.options.types,\n        attributes: {\n          [this.options.attributeName]: {\n            default: null,\n            parseHTML: (element) =>\n              element.getAttribute(`data-${this.options.attributeName}`),\n            renderHTML: (attributes) => ({\n              [`data-${this.options.attributeName}`]:\n                attributes[this.options.attributeName],\n            }),\n          },\n        },\n      },\n    ];\n  },\n  // check initial content for missing ids\n  // onCreate() {\n  //   // Don’t do this when the collaboration extension is active\n  //   // because this may update the content, so Y.js tries to merge these changes.\n  //   // This leads to empty block nodes.\n  //   // See: https://github.com/ueberdosis/tiptap/issues/2400\n  //   if (\n  //     this.editor.extensionManager.extensions.find(\n  //       (extension) => extension.name === \"collaboration\"\n  //     )\n  //   ) {\n  //     return;\n  //   }\n  //   const { view, state } = this.editor;\n  //   const { tr, doc } = state;\n  //   const { types, attributeName, generateID } = this.options;\n  //   const nodesWithoutId = findChildren(doc, (node) => {\n  //     return (\n  //       types.includes(node.type.name) && node.attrs[attributeName] === null\n  //     );\n  //   });\n  //   nodesWithoutId.forEach(({ node, pos }) => {\n  //     tr.setNodeMarkup(pos, undefined, {\n  //       ...node.attrs,\n  //       [attributeName]: generateID(),\n  //     });\n  //   });\n  //   tr.setMeta(\"addToHistory\", false);\n  //   view.dispatch(tr);\n  // },\n  addProseMirrorPlugins() {\n    let dragSourceElement: any = null;\n    let transformPasted = false;\n    return [\n      new Plugin({\n        key: new PluginKey(\"uniqueID\"),\n        appendTransaction: (transactions, oldState, newState) => {\n          // console.log(\"appendTransaction\");\n          const docChanges =\n            transactions.some((transaction) => transaction.docChanged) &&\n            !oldState.doc.eq(newState.doc);\n          const filterTransactions =\n            this.options.filterTransaction &&\n            transactions.some((tr) => {\n              let _a, _b;\n              return !((_b = (_a = this.options).filterTransaction) === null ||\n              _b === void 0\n                ? void 0\n                : _b.call(_a, tr));\n            });\n          if (!docChanges || filterTransactions) {\n            return;\n          }\n          const { tr } = newState;\n          const { types, attributeName, generateID } = this.options;\n          const transform = combineTransactionSteps(\n            oldState.doc,\n            transactions as any\n          );\n          const { mapping } = transform;\n          // get changed ranges based on the old state\n          const changes = getChangedRanges(transform);\n\n          changes.forEach(({ newRange }) => {\n            const newNodes = findChildrenInRange(\n              newState.doc,\n              newRange,\n              (node) => {\n                return types.includes(node.type.name);\n              }\n            );\n            const newIds = newNodes\n              .map(({ node }) => node.attrs[attributeName])\n              .filter((id) => id !== null);\n            const duplicatedNewIds = findDuplicates(newIds);\n            newNodes.forEach(({ node, pos }) => {\n              let _a;\n              // instead of checking `node.attrs[attributeName]` directly\n              // we look at the current state of the node within `tr.doc`.\n              // this helps to prevent adding new ids to the same node\n              // if the node changed multiple times within one transaction\n              const id =\n                (_a = tr.doc.nodeAt(pos)) === null || _a === void 0\n                  ? void 0\n                  : _a.attrs[attributeName];\n              if (id === null) {\n                // edge case, when using collaboration, yjs will set the id to null in `_forceRerender`\n                // when loading the editor\n                // this checks for this case and keeps it at initialBlockId so there will be no change\n                const initialDoc = oldState.doc.type.createAndFill()!.content;\n                const wasInitial =\n                  oldState.doc.content.findDiffStart(initialDoc) === null;\n\n                if (wasInitial) {\n                  // the old state was the \"initial content\"\n                  const jsonNode = JSON.parse(\n                    JSON.stringify(newState.doc.toJSON())\n                  );\n                  jsonNode.content[0].content[0].attrs.id = \"initialBlockId\";\n                  // would the new state with the fix also be the \"initial content\"?\n                  if (\n                    JSON.stringify(jsonNode.content) ===\n                    JSON.stringify(initialDoc.toJSON())\n                  ) {\n                    // yes, apply the fix\n                    tr.setNodeMarkup(pos, undefined, {\n                      ...node.attrs,\n                      [attributeName]: \"initialBlockId\",\n                    });\n                    return;\n                  }\n                }\n\n                tr.setNodeMarkup(pos, undefined, {\n                  ...node.attrs,\n                  [attributeName]: generateID(),\n                });\n                return;\n              }\n              // check if the node doesn’t exist in the old state\n              const { deleted } = mapping.invert().mapResult(pos);\n              const newNode = deleted && duplicatedNewIds.includes(id);\n              if (newNode) {\n                tr.setNodeMarkup(pos, undefined, {\n                  ...node.attrs,\n                  [attributeName]: generateID(),\n                });\n              }\n            });\n          });\n          if (!tr.steps.length) {\n            return;\n          }\n          return tr;\n        },\n        // we register a global drag handler to track the current drag source element\n        view(view) {\n          const handleDragstart = (event: any) => {\n            let _a;\n            dragSourceElement = (\n              (_a = view.dom.parentElement) === null || _a === void 0\n                ? void 0\n                : _a.contains(event.target)\n            )\n              ? view.dom.parentElement\n              : null;\n          };\n          window.addEventListener(\"dragstart\", handleDragstart);\n          return {\n            destroy() {\n              window.removeEventListener(\"dragstart\", handleDragstart);\n            },\n          };\n        },\n        props: {\n          // `handleDOMEvents` is called before `transformPasted`\n          // so we can do some checks before\n          handleDOMEvents: {\n            // only create new ids for dropped content while holding `alt`\n            // or content is dragged from another editor\n            drop: (view, event: any) => {\n              let _a;\n              if (\n                dragSourceElement !== view.dom.parentElement ||\n                ((_a = event.dataTransfer) === null || _a === void 0\n                  ? void 0\n                  : _a.effectAllowed) === \"copy\"\n              ) {\n                dragSourceElement = null;\n                transformPasted = true;\n              }\n              return false;\n            },\n            // always create new ids on pasted content\n            paste: () => {\n              transformPasted = true;\n              return false;\n            },\n          },\n          // we’ll remove ids for every pasted node\n          // so we can create a new one within `appendTransaction`\n          transformPasted: (slice) => {\n            if (!transformPasted) {\n              return slice;\n            }\n            const { types, attributeName } = this.options;\n            const removeId = (fragment: any) => {\n              const list: any[] = [];\n              fragment.forEach((node: any) => {\n                // don’t touch text nodes\n                if (node.isText) {\n                  list.push(node);\n                  return;\n                }\n                // check for any other child nodes\n                if (!types.includes(node.type.name)) {\n                  list.push(node.copy(removeId(node.content)));\n                  return;\n                }\n                // remove id\n                const nodeWithoutId = node.type.create(\n                  {\n                    ...node.attrs,\n                    [attributeName]: null,\n                  },\n                  removeId(node.content),\n                  node.marks\n                );\n                list.push(nodeWithoutId);\n              });\n              return Fragment.from(list);\n            };\n            // reset check\n            transformPasted = false;\n            return new Slice(\n              removeId(slice.content),\n              slice.openStart,\n              slice.openEnd\n            );\n          },\n        },\n      }),\n    ];\n  },\n});\n\nexport { UniqueID as default, UniqueID };\n","import { Node, NodeType } from \"prosemirror-model\";\n\nexport type BlockInfoWithoutPositions = {\n  id: string;\n  node: Node;\n  contentNode: Node;\n  contentType: NodeType;\n  numChildBlocks: number;\n};\n\nexport type BlockInfo = BlockInfoWithoutPositions & {\n  startPos: number;\n  endPos: number;\n  depth: number;\n};\n\n/**\n * Helper function for `getBlockInfoFromPos`, returns information regarding\n * provided blockContainer node.\n * @param blockContainer The blockContainer node to retrieve info for.\n */\nexport function getBlockInfo(blockContainer: Node): BlockInfoWithoutPositions {\n  const id = blockContainer.attrs[\"id\"];\n  const contentNode = blockContainer.firstChild!;\n  const contentType = contentNode.type;\n  const numChildBlocks =\n    blockContainer.childCount === 2 ? blockContainer.lastChild!.childCount : 0;\n\n  return {\n    id,\n    node: blockContainer,\n    contentNode,\n    contentType,\n    numChildBlocks,\n  };\n}\n\n/**\n * Retrieves information regarding the nearest blockContainer node in a\n * ProseMirror doc, relative to a position.\n * @param doc The ProseMirror doc.\n * @param pos An integer position.\n * @returns A BlockInfo object for the nearest blockContainer node.\n */\nexport function getBlockInfoFromPos(doc: Node, pos: number): BlockInfo {\n  // If the position is outside the outer block group, we need to move it to the\n  // nearest block. This happens when the collaboration plugin is active, where\n  // the selection is placed at the very end of the doc.\n  const outerBlockGroupStartPos = 1;\n  const outerBlockGroupEndPos = doc.nodeSize - 2;\n  if (pos <= outerBlockGroupStartPos) {\n    pos = outerBlockGroupStartPos + 1;\n\n    while (\n      doc.resolve(pos).parent.type.name !== \"blockContainer\" &&\n      pos < outerBlockGroupEndPos\n    ) {\n      pos++;\n    }\n  } else if (pos >= outerBlockGroupEndPos) {\n    pos = outerBlockGroupEndPos - 1;\n\n    while (\n      doc.resolve(pos).parent.type.name !== \"blockContainer\" &&\n      pos > outerBlockGroupStartPos\n    ) {\n      pos--;\n    }\n  }\n\n  // This gets triggered when a node selection on a block is active, i.e. when\n  // you drag and drop a block.\n  if (doc.resolve(pos).parent.type.name === \"blockGroup\") {\n    pos++;\n  }\n\n  const $pos = doc.resolve(pos);\n\n  const maxDepth = $pos.depth;\n  let node = $pos.node(maxDepth);\n  let depth = maxDepth;\n\n  // eslint-disable-next-line no-constant-condition\n  while (true) {\n    if (depth < 0) {\n      throw new Error(\n        \"Could not find blockContainer node. This can only happen if the underlying BlockNote schema has been edited.\"\n      );\n    }\n\n    if (node.type.name === \"blockContainer\") {\n      break;\n    }\n\n    depth -= 1;\n    node = $pos.node(depth);\n  }\n\n  const { id, contentNode, contentType, numChildBlocks } = getBlockInfo(node);\n\n  const startPos = $pos.start(depth);\n  const endPos = $pos.end(depth);\n\n  return {\n    id,\n    node,\n    contentNode,\n    contentType,\n    numChildBlocks,\n    startPos,\n    endPos,\n    depth,\n  };\n}\n","import { Node } from \"@tiptap/core\";\nimport { PropSchema, Props } from \"../propTypes\";\nimport { StyleSchema, Styles } from \"../styles/types\";\n\nexport type CustomInlineContentConfig = {\n  type: string;\n  content: \"styled\" | \"none\"; // | \"plain\"\n  readonly propSchema: PropSchema;\n  // content: \"inline\" | \"none\" | \"table\";\n};\n// InlineContentConfig contains the \"schema\" info about an InlineContent type\n// i.e. what props it supports, what content it supports, etc.\nexport type InlineContentConfig = CustomInlineContentConfig | \"text\" | \"link\";\n\n// InlineContentImplementation contains the \"implementation\" info about an InlineContent element\n// such as the functions / Nodes required to render and / or serialize it\n// @ts-ignore\nexport type InlineContentImplementation<T extends InlineContentConfig> =\n  T extends \"link\" | \"text\"\n    ? undefined\n    : {\n        node: Node;\n      };\n\n// Container for both the config and implementation of InlineContent,\n// and the type of `implementation` is based on that of the config\nexport type InlineContentSpec<T extends InlineContentConfig> = {\n  config: T;\n  implementation: InlineContentImplementation<T>;\n};\n\n// A Schema contains all the types (Configs) supported in an editor\n// The keys are the \"type\" of InlineContent elements\nexport type InlineContentSchema = Record<string, InlineContentConfig>;\n\nexport type InlineContentSpecs = {\n  text: { config: \"text\"; implementation: undefined };\n  link: { config: \"link\"; implementation: undefined };\n} & Record<string, InlineContentSpec<InlineContentConfig>>;\n\nexport type InlineContentSchemaFromSpecs<T extends InlineContentSpecs> = {\n  [K in keyof T]: T[K][\"config\"];\n};\n\nexport type CustomInlineContentFromConfig<\n  I extends CustomInlineContentConfig,\n  S extends StyleSchema\n> = {\n  type: I[\"type\"];\n  props: Props<I[\"propSchema\"]>;\n  content: I[\"content\"] extends \"styled\"\n    ? StyledText<S>[]\n    : I[\"content\"] extends \"plain\"\n    ? string\n    : I[\"content\"] extends \"none\"\n    ? undefined\n    : never;\n};\n\nexport type InlineContentFromConfig<\n  I extends InlineContentConfig,\n  S extends StyleSchema\n> = I extends \"text\"\n  ? StyledText<S>\n  : I extends \"link\"\n  ? Link<S>\n  : I extends CustomInlineContentConfig\n  ? CustomInlineContentFromConfig<I, S>\n  : never;\n\nexport type PartialCustomInlineContentFromConfig<\n  I extends CustomInlineContentConfig,\n  S extends StyleSchema\n> = {\n  type: I[\"type\"];\n  props?: Props<I[\"propSchema\"]>;\n  content?: I[\"content\"] extends \"styled\"\n    ? StyledText<S>[] | string\n    : I[\"content\"] extends \"plain\"\n    ? string\n    : I[\"content\"] extends \"none\"\n    ? undefined\n    : never;\n};\n\nexport type PartialInlineContentFromConfig<\n  I extends InlineContentConfig,\n  S extends StyleSchema\n> = I extends \"text\"\n  ? string | StyledText<S>\n  : I extends \"link\"\n  ? PartialLink<S>\n  : I extends CustomInlineContentConfig\n  ? PartialCustomInlineContentFromConfig<I, S>\n  : never;\n\nexport type StyledText<T extends StyleSchema> = {\n  type: \"text\";\n  text: string;\n  styles: Styles<T>;\n};\n\nexport type Link<T extends StyleSchema> = {\n  type: \"link\";\n  href: string;\n  content: StyledText<T>[];\n};\n\nexport type PartialLink<T extends StyleSchema> = Omit<Link<T>, \"content\"> & {\n  content: string | Link<T>[\"content\"];\n};\n\nexport type InlineContent<\n  I extends InlineContentSchema,\n  T extends StyleSchema\n> = InlineContentFromConfig<I[keyof I], T>;\n\ntype PartialInlineContentElement<\n  I extends InlineContentSchema,\n  T extends StyleSchema\n> = PartialInlineContentFromConfig<I[keyof I], T>;\n\nexport type PartialInlineContent<\n  I extends InlineContentSchema,\n  T extends StyleSchema\n> = PartialInlineContentElement<I, T>[] | string;\n\nexport function isLinkInlineContent<T extends StyleSchema>(\n  content: InlineContent<any, T>\n): content is Link<T> {\n  return content.type === \"link\";\n}\n\nexport function isPartialLinkInlineContent<T extends StyleSchema>(\n  content: PartialInlineContentElement<any, T>\n): content is PartialLink<T> {\n  return typeof content !== \"string\" && content.type === \"link\";\n}\n\nexport function isStyledTextInlineContent<T extends StyleSchema>(\n  content: PartialInlineContentElement<any, T>\n): content is StyledText<T> {\n  return typeof content !== \"string\" && content.type === \"text\";\n}\n","export class UnreachableCaseError extends Error {\n  constructor(val: never) {\n    super(`Unreachable case: ${val}`);\n  }\n}\n\nexport function assertEmpty(obj: Record<string, never>, throwError = true) {\n  const { \"data-test\": dataTest, ...rest } = obj; // exclude data-test\n\n  if (Object.keys(rest).length > 0 && throwError) {\n    throw new Error(\"Object must be empty \" + JSON.stringify(obj));\n  }\n}\n\n// TODO: change for built-in version of typescript 5.4 after upgrade\nexport type NoInfer<T> = [T][T extends any ? 0 : never];\n","import { Mark, Node, Schema } from \"@tiptap/pm/model\";\n\nimport UniqueID from \"../../extensions/UniqueID/UniqueID\";\nimport type {\n  BlockSchema,\n  CustomInlineContentConfig,\n  CustomInlineContentFromConfig,\n  InlineContent,\n  InlineContentFromConfig,\n  InlineContentSchema,\n  PartialCustomInlineContentFromConfig,\n  PartialInlineContent,\n  PartialLink,\n  PartialTableContent,\n  StyleSchema,\n  StyledText,\n  Styles,\n  TableContent,\n} from \"../../schema\";\nimport { getBlockInfo } from \"../getBlockInfoFromPos\";\n\nimport type { Block, PartialBlock } from \"../../blocks/defaultBlocks\";\nimport {\n  isLinkInlineContent,\n  isPartialLinkInlineContent,\n  isStyledTextInlineContent,\n} from \"../../schema/inlineContent/types\";\nimport { UnreachableCaseError } from \"../../util/typescript\";\n\n/**\n * Convert a StyledText inline element to a\n * prosemirror text node with the appropriate marks\n */\nfunction styledTextToNodes<T extends StyleSchema>(\n  styledText: StyledText<T>,\n  schema: Schema,\n  styleSchema: T\n): Node[] {\n  const marks: Mark[] = [];\n\n  for (const [style, value] of Object.entries(styledText.styles)) {\n    const config = styleSchema[style];\n    if (!config) {\n      throw new Error(`style ${style} not found in styleSchema`);\n    }\n\n    if (config.propSchema === \"boolean\") {\n      marks.push(schema.mark(style));\n    } else if (config.propSchema === \"string\") {\n      marks.push(schema.mark(style, { stringValue: value }));\n    } else {\n      throw new UnreachableCaseError(config.propSchema);\n    }\n  }\n\n  return (\n    styledText.text\n      // Splits text & line breaks.\n      .split(/(\\n)/g)\n      // If the content ends with a line break, an empty string is added to the\n      // end, which this removes.\n      .filter((text) => text.length > 0)\n      // Converts text & line breaks to nodes.\n      .map((text) => {\n        if (text === \"\\n\") {\n          return schema.nodes[\"hardBreak\"].create();\n        } else {\n          return schema.text(text, marks);\n        }\n      })\n  );\n}\n\n/**\n * Converts a Link inline content element to\n * prosemirror text nodes with the appropriate marks\n */\nfunction linkToNodes(\n  link: PartialLink<StyleSchema>,\n  schema: Schema,\n  styleSchema: StyleSchema\n): Node[] {\n  const linkMark = schema.marks.link.create({\n    href: link.href,\n  });\n\n  return styledTextArrayToNodes(link.content, schema, styleSchema).map(\n    (node) => {\n      if (node.type.name === \"text\") {\n        return node.mark([...node.marks, linkMark]);\n      }\n\n      if (node.type.name === \"hardBreak\") {\n        return node;\n      }\n      throw new Error(\"unexpected node type\");\n    }\n  );\n}\n\n/**\n * Converts an array of StyledText inline content elements to\n * prosemirror text nodes with the appropriate marks\n */\nfunction styledTextArrayToNodes<S extends StyleSchema>(\n  content: string | StyledText<S>[],\n  schema: Schema,\n  styleSchema: S\n): Node[] {\n  const nodes: Node[] = [];\n\n  if (typeof content === \"string\") {\n    nodes.push(\n      ...styledTextToNodes(\n        { type: \"text\", text: content, styles: {} },\n        schema,\n        styleSchema\n      )\n    );\n    return nodes;\n  }\n\n  for (const styledText of content) {\n    nodes.push(...styledTextToNodes(styledText, schema, styleSchema));\n  }\n  return nodes;\n}\n\n/**\n * converts an array of inline content elements to prosemirror nodes\n */\nexport function inlineContentToNodes<\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(\n  blockContent: PartialInlineContent<I, S>,\n  schema: Schema,\n  styleSchema: S\n): Node[] {\n  const nodes: Node[] = [];\n\n  for (const content of blockContent) {\n    if (typeof content === \"string\") {\n      nodes.push(...styledTextArrayToNodes(content, schema, styleSchema));\n    } else if (isPartialLinkInlineContent(content)) {\n      nodes.push(...linkToNodes(content, schema, styleSchema));\n    } else if (isStyledTextInlineContent(content)) {\n      nodes.push(...styledTextArrayToNodes([content], schema, styleSchema));\n    } else {\n      nodes.push(\n        blockOrInlineContentToContentNode(content, schema, styleSchema)\n      );\n    }\n  }\n  return nodes;\n}\n\n/**\n * converts an array of inline content elements to prosemirror nodes\n */\nexport function tableContentToNodes<\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(\n  tableContent: PartialTableContent<I, S>,\n  schema: Schema,\n  styleSchema: StyleSchema\n): Node[] {\n  const rowNodes: Node[] = [];\n\n  for (const row of tableContent.rows) {\n    const columnNodes: Node[] = [];\n    for (const cell of row.cells) {\n      let pNode: Node;\n      if (!cell) {\n        pNode = schema.nodes[\"tableParagraph\"].create({});\n      } else if (typeof cell === \"string\") {\n        pNode = schema.nodes[\"tableParagraph\"].create({}, schema.text(cell));\n      } else {\n        const textNodes = inlineContentToNodes(cell, schema, styleSchema);\n        pNode = schema.nodes[\"tableParagraph\"].create({}, textNodes);\n      }\n\n      const cellNode = schema.nodes[\"tableCell\"].create({}, pNode);\n      columnNodes.push(cellNode);\n    }\n    const rowNode = schema.nodes[\"tableRow\"].create({}, columnNodes);\n    rowNodes.push(rowNode);\n  }\n  return rowNodes;\n}\n\nfunction blockOrInlineContentToContentNode(\n  block:\n    | PartialBlock<any, any, any>\n    | PartialCustomInlineContentFromConfig<any, any>,\n  schema: Schema,\n  styleSchema: StyleSchema\n) {\n  let contentNode: Node;\n  let type = block.type;\n\n  // TODO: needed? came from previous code\n  if (type === undefined) {\n    type = \"paragraph\";\n  }\n\n  if (!schema.nodes[type]) {\n    throw new Error(`node type ${type} not found in schema`);\n  }\n\n  if (!block.content) {\n    contentNode = schema.nodes[type].create(block.props);\n  } else if (typeof block.content === \"string\") {\n    const nodes = inlineContentToNodes([block.content], schema, styleSchema);\n    contentNode = schema.nodes[type].create(block.props, nodes);\n  } else if (Array.isArray(block.content)) {\n    const nodes = inlineContentToNodes(block.content, schema, styleSchema);\n    contentNode = schema.nodes[type].create(block.props, nodes);\n  } else if (block.content.type === \"tableContent\") {\n    const nodes = tableContentToNodes(block.content, schema, styleSchema);\n    contentNode = schema.nodes[type].create(block.props, nodes);\n  } else {\n    throw new UnreachableCaseError(block.content.type);\n  }\n  return contentNode;\n}\n/**\n * Converts a BlockNote block to a TipTap node.\n */\nexport function blockToNode(\n  block: PartialBlock<any, any, any>,\n  schema: Schema,\n  styleSchema: StyleSchema\n) {\n  let id = block.id;\n\n  if (id === undefined) {\n    id = UniqueID.options.generateID();\n  }\n\n  const contentNode = blockOrInlineContentToContentNode(\n    block,\n    schema,\n    styleSchema\n  );\n\n  const children: Node[] = [];\n\n  if (block.children) {\n    for (const child of block.children) {\n      children.push(blockToNode(child, schema, styleSchema));\n    }\n  }\n\n  const groupNode = schema.nodes[\"blockGroup\"].create({}, children);\n\n  return schema.nodes[\"blockContainer\"].create(\n    {\n      id: id,\n      ...block.props,\n    },\n    children.length > 0 ? [contentNode, groupNode] : contentNode\n  );\n}\n\n/**\n * Converts an internal (prosemirror) table node contentto a BlockNote Tablecontent\n */\nfunction contentNodeToTableContent<\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(contentNode: Node, inlineContentSchema: I, styleSchema: S) {\n  const ret: TableContent<I, S> = {\n    type: \"tableContent\",\n    rows: [],\n  };\n\n  contentNode.content.forEach((rowNode) => {\n    const row: TableContent<I, S>[\"rows\"][0] = {\n      cells: [],\n    };\n\n    rowNode.content.forEach((cellNode) => {\n      row.cells.push(\n        contentNodeToInlineContent(\n          cellNode.firstChild!,\n          inlineContentSchema,\n          styleSchema\n        )\n      );\n    });\n\n    ret.rows.push(row);\n  });\n\n  return ret;\n}\n\n/**\n * Converts an internal (prosemirror) content node to a BlockNote InlineContent array.\n */\nexport function contentNodeToInlineContent<\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(contentNode: Node, inlineContentSchema: I, styleSchema: S) {\n  const content: InlineContent<any, S>[] = [];\n  let currentContent: InlineContent<any, S> | undefined = undefined;\n\n  // Most of the logic below is for handling links because in ProseMirror links are marks\n  // while in BlockNote links are a type of inline content\n  contentNode.content.forEach((node) => {\n    // hardBreak nodes do not have an InlineContent equivalent, instead we\n    // add a newline to the previous node.\n    if (node.type.name === \"hardBreak\") {\n      if (currentContent) {\n        // Current content exists.\n        if (isStyledTextInlineContent(currentContent)) {\n          // Current content is text.\n          currentContent.text += \"\\n\";\n        } else if (isLinkInlineContent(currentContent)) {\n          // Current content is a link.\n          currentContent.content[currentContent.content.length - 1].text +=\n            \"\\n\";\n        } else {\n          throw new Error(\"unexpected\");\n        }\n      } else {\n        // Current content does not exist.\n        currentContent = {\n          type: \"text\",\n          text: \"\\n\",\n          styles: {},\n        };\n      }\n\n      return;\n    }\n\n    if (\n      node.type.name !== \"link\" &&\n      node.type.name !== \"text\" &&\n      inlineContentSchema[node.type.name]\n    ) {\n      if (currentContent) {\n        content.push(currentContent);\n        currentContent = undefined;\n      }\n\n      content.push(\n        nodeToCustomInlineContent(node, inlineContentSchema, styleSchema)\n      );\n\n      return;\n    }\n\n    const styles: Styles<S> = {};\n    let linkMark: Mark | undefined;\n\n    for (const mark of node.marks) {\n      if (mark.type.name === \"link\") {\n        linkMark = mark;\n      } else {\n        const config = styleSchema[mark.type.name];\n        if (!config) {\n          throw new Error(`style ${mark.type.name} not found in styleSchema`);\n        }\n        if (config.propSchema === \"boolean\") {\n          (styles as any)[config.type] = true;\n        } else if (config.propSchema === \"string\") {\n          (styles as any)[config.type] = mark.attrs.stringValue;\n        } else {\n          throw new UnreachableCaseError(config.propSchema);\n        }\n      }\n    }\n\n    // Parsing links and text.\n    // Current content exists.\n    if (currentContent) {\n      // Current content is text.\n      if (isStyledTextInlineContent(currentContent)) {\n        if (!linkMark) {\n          // Node is text (same type as current content).\n          if (\n            JSON.stringify(currentContent.styles) === JSON.stringify(styles)\n          ) {\n            // Styles are the same.\n            currentContent.text += node.textContent;\n          } else {\n            // Styles are different.\n            content.push(currentContent);\n            currentContent = {\n              type: \"text\",\n              text: node.textContent,\n              styles,\n            };\n          }\n        } else {\n          // Node is a link (different type to current content).\n          content.push(currentContent);\n          currentContent = {\n            type: \"link\",\n            href: linkMark.attrs.href,\n            content: [\n              {\n                type: \"text\",\n                text: node.textContent,\n                styles,\n              },\n            ],\n          };\n        }\n      } else if (isLinkInlineContent(currentContent)) {\n        // Current content is a link.\n        if (linkMark) {\n          // Node is a link (same type as current content).\n          // Link URLs are the same.\n          if (currentContent.href === linkMark.attrs.href) {\n            // Styles are the same.\n            if (\n              JSON.stringify(\n                currentContent.content[currentContent.content.length - 1].styles\n              ) === JSON.stringify(styles)\n            ) {\n              currentContent.content[currentContent.content.length - 1].text +=\n                node.textContent;\n            } else {\n              // Styles are different.\n              currentContent.content.push({\n                type: \"text\",\n                text: node.textContent,\n                styles,\n              });\n            }\n          } else {\n            // Link URLs are different.\n            content.push(currentContent);\n            currentContent = {\n              type: \"link\",\n              href: linkMark.attrs.href,\n              content: [\n                {\n                  type: \"text\",\n                  text: node.textContent,\n                  styles,\n                },\n              ],\n            };\n          }\n        } else {\n          // Node is text (different type to current content).\n          content.push(currentContent);\n          currentContent = {\n            type: \"text\",\n            text: node.textContent,\n            styles,\n          };\n        }\n      } else {\n        // TODO\n      }\n    }\n    // Current content does not exist.\n    else {\n      // Node is text.\n      if (!linkMark) {\n        currentContent = {\n          type: \"text\",\n          text: node.textContent,\n          styles,\n        };\n      }\n      // Node is a link.\n      else {\n        currentContent = {\n          type: \"link\",\n          href: linkMark.attrs.href,\n          content: [\n            {\n              type: \"text\",\n              text: node.textContent,\n              styles,\n            },\n          ],\n        };\n      }\n    }\n  });\n\n  if (currentContent) {\n    content.push(currentContent);\n  }\n\n  return content as InlineContent<I, S>[];\n}\n\nexport function nodeToCustomInlineContent<\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(node: Node, inlineContentSchema: I, styleSchema: S): InlineContent<I, S> {\n  if (node.type.name === \"text\" || node.type.name === \"link\") {\n    throw new Error(\"unexpected\");\n  }\n  const props: any = {};\n  const icConfig = inlineContentSchema[\n    node.type.name\n  ] as CustomInlineContentConfig;\n  for (const [attr, value] of Object.entries(node.attrs)) {\n    if (!icConfig) {\n      throw Error(\"ic node is of an unrecognized type: \" + node.type.name);\n    }\n\n    const propSchema = icConfig.propSchema;\n\n    if (attr in propSchema) {\n      props[attr] = value;\n    }\n  }\n\n  let content: CustomInlineContentFromConfig<any, any>[\"content\"];\n\n  if (icConfig.content === \"styled\") {\n    content = contentNodeToInlineContent(\n      node,\n      inlineContentSchema,\n      styleSchema\n    ) as any; // TODO: is this safe? could we have Links here that are undesired?\n  } else {\n    content = undefined;\n  }\n\n  const ic = {\n    type: node.type.name,\n    props,\n    content,\n  } as InlineContentFromConfig<I[keyof I], S>;\n  return ic;\n}\n\n/**\n * Convert a TipTap node to a BlockNote block.\n */\nexport function nodeToBlock<\n  BSchema extends BlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(\n  node: Node,\n  blockSchema: BSchema,\n  inlineContentSchema: I,\n  styleSchema: S,\n  blockCache?: WeakMap<Node, Block<BSchema, I, S>>\n): Block<BSchema, I, S> {\n  if (node.type.name !== \"blockContainer\") {\n    throw Error(\n      \"Node must be of type blockContainer, but is of type\" +\n        node.type.name +\n        \".\"\n    );\n  }\n\n  const cachedBlock = blockCache?.get(node);\n\n  if (cachedBlock) {\n    return cachedBlock;\n  }\n\n  const blockInfo = getBlockInfo(node);\n\n  let id = blockInfo.id;\n\n  // Only used for blocks converted from other formats.\n  if (id === null) {\n    id = UniqueID.options.generateID();\n  }\n\n  const props: any = {};\n  for (const [attr, value] of Object.entries({\n    ...node.attrs,\n    ...blockInfo.contentNode.attrs,\n  })) {\n    const blockSpec = blockSchema[blockInfo.contentType.name];\n\n    if (!blockSpec) {\n      throw Error(\n        \"Block is of an unrecognized type: \" + blockInfo.contentType.name\n      );\n    }\n\n    const propSchema = blockSpec.propSchema;\n\n    if (attr in propSchema) {\n      props[attr] = value;\n    }\n  }\n\n  const blockConfig = blockSchema[blockInfo.contentType.name];\n\n  const children: Block<BSchema, I, S>[] = [];\n  for (let i = 0; i < blockInfo.numChildBlocks; i++) {\n    children.push(\n      nodeToBlock(\n        node.lastChild!.child(i),\n        blockSchema,\n        inlineContentSchema,\n        styleSchema,\n        blockCache\n      )\n    );\n  }\n\n  let content: Block<any, any, any>[\"content\"];\n\n  if (blockConfig.content === \"inline\") {\n    content = contentNodeToInlineContent(\n      blockInfo.contentNode,\n      inlineContentSchema,\n      styleSchema\n    );\n  } else if (blockConfig.content === \"table\") {\n    content = contentNodeToTableContent(\n      blockInfo.contentNode,\n      inlineContentSchema,\n      styleSchema\n    );\n  } else if (blockConfig.content === \"none\") {\n    content = undefined;\n  } else {\n    throw new UnreachableCaseError(blockConfig.content);\n  }\n\n  const block = {\n    id,\n    type: blockConfig.type,\n    props,\n    content,\n    children,\n  } as Block<BSchema, I, S>;\n\n  blockCache?.set(node, block);\n\n  return block;\n}\n","import { DOMSerializer, Fragment, Node } from \"prosemirror-model\";\n\nimport type { BlockNoteEditor } from \"../../../../editor/BlockNoteEditor\";\nimport {\n  BlockSchema,\n  InlineContentSchema,\n  StyleSchema,\n} from \"../../../../schema\";\nimport { nodeToBlock } from \"../../../nodeConversions/nodeConversions\";\n\nfunction doc(options: { document?: Document }) {\n  return options.document || window.document;\n}\n\n// Used to implement `serializeNodeInner` for the `internalHTMLSerializer` and\n// `externalHTMLExporter`. Changes how the content of `blockContainer` nodes is\n// serialized vs the default `DOMSerializer` implementation. For the\n// `blockContent` node, the `toInternalHTML` or `toExternalHTML` function of its\n// corresponding block is used for serialization instead of the node's\n// `renderHTML` method.\nexport const serializeNodeInner = <\n  BSchema extends BlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(\n  node: Node,\n  options: { document?: Document },\n  serializer: DOMSerializer,\n  editor: BlockNoteEditor<BSchema, I, S>,\n  toExternalHTML: boolean\n) => {\n  if (!serializer.nodes[node.type.name]) {\n    throw new Error(\"Serializer is missing a node type: \" + node.type.name);\n  }\n\n  const { dom, contentDOM } = DOMSerializer.renderSpec(\n    doc(options),\n    serializer.nodes[node.type.name](node)\n  );\n\n  if (contentDOM) {\n    if (node.isLeaf) {\n      throw new RangeError(\"Content hole not allowed in a leaf node spec\");\n    }\n\n    // Handles converting `blockContainer` nodes to HTML.\n    if (node.type.name === \"blockContainer\") {\n      const blockContentNode =\n        node.childCount > 0 &&\n        node.firstChild!.type.spec.group === \"blockContent\"\n          ? node.firstChild!\n          : undefined;\n      const blockGroupNode =\n        node.childCount > 0 && node.lastChild!.type.spec.group === \"blockGroup\"\n          ? node.lastChild!\n          : undefined;\n\n      // Converts `blockContent` node using the custom `blockSpec`'s\n      // `toExternalHTML` or `toInternalHTML` function.\n      // Note: While `blockContainer` nodes should always contain a\n      // `blockContent` node according to the schema, PM Fragments don't always\n      // conform to the schema. This is unintuitive but important as it occurs\n      // when copying only nested blocks.\n      if (blockContentNode !== undefined) {\n        const impl =\n          editor.blockImplementations[blockContentNode.type.name]\n            .implementation;\n        const toHTML = toExternalHTML\n          ? impl.toExternalHTML\n          : impl.toInternalHTML;\n        const blockContent = toHTML(\n          nodeToBlock(\n            node,\n            editor.schema.blockSchema,\n            editor.schema.inlineContentSchema,\n            editor.schema.styleSchema,\n            editor.blockCache\n          ),\n          editor as any\n        );\n\n        // Converts inline nodes in the `blockContent` node's content to HTML\n        // using their `renderHTML` methods.\n        if (blockContent.contentDOM !== undefined) {\n          if (node.isLeaf) {\n            throw new RangeError(\n              \"Content hole not allowed in a leaf node spec\"\n            );\n          }\n\n          blockContent.contentDOM.appendChild(\n            serializer.serializeFragment(blockContentNode.content, options)\n          );\n        }\n\n        contentDOM.appendChild(blockContent.dom);\n      }\n\n      // Converts `blockGroup` node to HTML using its `renderHTML` method.\n      if (blockGroupNode !== undefined) {\n        serializer.serializeFragment(\n          Fragment.from(blockGroupNode),\n          options,\n          contentDOM\n        );\n      }\n    } else {\n      // Converts the node normally, i.e. using its `renderHTML method`.\n      serializer.serializeFragment(node.content, options, contentDOM);\n    }\n  }\n\n  return dom as HTMLElement;\n};\n\n// Used to implement `serializeProseMirrorFragment` for the\n// `internalHTMLSerializer` and `externalHTMLExporter`. Does basically the same\n// thing as `serializer.serializeFragment`, but takes fewer arguments and\n// returns a string instead, to make it easier to use.\nexport const serializeProseMirrorFragment = (\n  fragment: Fragment,\n  serializer: DOMSerializer\n) => {\n  const internalHTML = serializer.serializeFragment(fragment);\n  const parent = document.createElement(\"div\");\n  parent.appendChild(internalHTML);\n\n  return parent.innerHTML;\n};\n","import { Element as HASTElement, Parent as HASTParent } from \"hast\";\nimport { fromDom } from \"hast-util-from-dom\";\n\ntype SimplifyBlocksOptions = {\n  orderedListItemBlockTypes: Set<string>;\n  unorderedListItemBlockTypes: Set<string>;\n};\n\n/**\n * Rehype plugin which converts the HTML output string rendered by BlockNote into a simplified structure which better\n * follows HTML standards. It does several things:\n * - Removes all block related div elements, leaving only the actual content inside the block.\n * - Lifts nested blocks to a higher level for all block types that don't represent list items.\n * - Wraps blocks which represent list items in corresponding ul/ol HTML elements and restructures them to comply\n * with HTML list structure.\n * @param options Options for specifying which block types represent ordered and unordered list items.\n */\nexport function simplifyBlocks(options: SimplifyBlocksOptions) {\n  const listItemBlockTypes = new Set<string>([\n    ...options.orderedListItemBlockTypes,\n    ...options.unorderedListItemBlockTypes,\n  ]);\n\n  const simplifyBlocksHelper = (tree: HASTParent) => {\n    // Checks whether blocks in the tree are wrapped by a parent `blockGroup`\n    // element, in which case the `blockGroup`'s children are lifted out, and it\n    // is removed.\n    if (\n      tree.children.length === 1 &&\n      (tree.children[0] as HASTElement).properties?.[\"dataNodeType\"] ===\n        \"blockGroup\"\n    ) {\n      const blockGroup = tree.children[0] as HASTElement;\n      tree.children.pop();\n      tree.children.push(...blockGroup.children);\n    }\n\n    let numChildElements = tree.children.length;\n    let activeList: HASTElement | undefined;\n\n    for (let i = 0; i < numChildElements; i++) {\n      const blockOuter = tree.children[i] as HASTElement;\n      const blockContainer = blockOuter.children[0] as HASTElement;\n      const blockContent = blockContainer.children[0] as HASTElement;\n      const blockGroup =\n        blockContainer.children.length === 2\n          ? (blockContainer.children[1] as HASTElement)\n          : null;\n\n      const isListItemBlock = listItemBlockTypes.has(\n        blockContent.properties![\"dataContentType\"] as string\n      );\n\n      const listItemBlockType = isListItemBlock\n        ? options.orderedListItemBlockTypes.has(\n            blockContent.properties![\"dataContentType\"] as string\n          )\n          ? \"ol\"\n          : \"ul\"\n        : null;\n\n      // Plugin runs recursively to process nested blocks.\n      if (blockGroup !== null) {\n        simplifyBlocksHelper(blockGroup);\n      }\n\n      // Checks that there is an active list, but the block can't be added to it as it's of a different type.\n      if (activeList && activeList.tagName !== listItemBlockType) {\n        // Blocks that were copied into the list are removed and the list is inserted in their place.\n        tree.children.splice(\n          i - activeList.children.length,\n          activeList.children.length,\n          activeList\n        );\n\n        // Updates the current index and number of child elements.\n        const numElementsRemoved = activeList.children.length - 1;\n        i -= numElementsRemoved;\n        numChildElements -= numElementsRemoved;\n\n        activeList = undefined;\n      }\n\n      // Checks if the block represents a list item.\n      if (isListItemBlock) {\n        // Checks if a list isn't already active. We don't have to check if the block and the list are of the same\n        // type as this was already done earlier.\n        if (!activeList) {\n          // Creates a new list element to represent an active list.\n          activeList = fromDom(\n            document.createElement(listItemBlockType!)\n          ) as HASTElement;\n        }\n\n        // Creates a new list item element to represent the block.\n        const listItemElement = fromDom(\n          document.createElement(\"li\")\n        ) as HASTElement;\n\n        // Adds only the content inside the block to the active list.\n        listItemElement.children.push(...blockContent.children);\n        // Nested blocks have already been processed in the recursive function call, so the resulting elements are\n        // also added to the active list.\n        if (blockGroup !== null) {\n          listItemElement.children.push(...blockGroup.children);\n        }\n\n        // Adds the list item representing the block to the active list.\n        activeList.children.push(listItemElement);\n      } else if (blockGroup !== null) {\n        // Lifts all children out of the current block, as only list items should allow nesting.\n        tree.children.splice(i + 1, 0, ...blockGroup.children);\n        // Replaces the block with only the content inside it.\n        tree.children[i] = blockContent.children[0];\n\n        // Updates the current index and number of child elements.\n        const numElementsAdded = blockGroup.children.length;\n        i += numElementsAdded;\n        numChildElements += numElementsAdded;\n      } else {\n        // Replaces the block with only the content inside it.\n        tree.children[i] = blockContent.children[0];\n      }\n    }\n\n    // Since the active list is only inserted after encountering a block which can't be added to it, there are cases\n    // where it remains un-inserted after processing all blocks, which are handled here.\n    if (activeList) {\n      tree.children.splice(\n        numChildElements - activeList.children.length,\n        activeList.children.length,\n        activeList\n      );\n    }\n  };\n\n  return simplifyBlocksHelper;\n}\n","import { DOMSerializer, Fragment, Node, Schema } from \"prosemirror-model\";\nimport rehypeParse from \"rehype-parse\";\nimport rehypeStringify from \"rehype-stringify\";\nimport { unified } from \"unified\";\n\nimport { PartialBlock } from \"../../../blocks/defaultBlocks\";\nimport type { BlockNoteEditor } from \"../../../editor/BlockNoteEditor\";\nimport { BlockSchema, InlineContentSchema, StyleSchema } from \"../../../schema\";\nimport { blockToNode } from \"../../nodeConversions/nodeConversions\";\nimport {\n  serializeNodeInner,\n  serializeProseMirrorFragment,\n} from \"./util/sharedHTMLConversion\";\nimport { simplifyBlocks } from \"./util/simplifyBlocksRehypePlugin\";\n\n// Used to export BlockNote blocks and ProseMirror nodes to HTML for use outside\n// the editor. Blocks are exported using the `toExternalHTML` method in their\n// `blockSpec`, or `toInternalHTML` if `toExternalHTML` is not defined.\n//\n// The HTML created by this serializer is different to what's rendered by the\n// editor to the DOM. This also means that data is likely to be lost when\n// converting back to original blocks. The differences in the output HTML are:\n// 1. It doesn't include the `blockGroup` and `blockContainer` wrappers meaning\n// that nesting is not preserved for non-list-item blocks.\n// 2. `li` items in the output HTML are wrapped in `ul` or `ol` elements.\n// 3. While nesting for list items is preserved, other types of blocks nested\n// inside a list are un-nested and a new list is created after them.\n// 4. The HTML is wrapped in a single `div` element.\n//\n// The serializer has 2 main methods:\n// `exportBlocks`: Exports an array of blocks to HTML.\n// `exportFragment`: Exports a ProseMirror fragment to HTML. This is mostly\n// useful if you want to export a selection which may not start/end at the\n// start/end of a block.\nexport interface ExternalHTMLExporter<\n  BSchema extends BlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n> {\n  exportBlocks: (blocks: PartialBlock<BSchema, I, S>[]) => string;\n  exportProseMirrorFragment: (fragment: Fragment) => string;\n}\n\nexport const createExternalHTMLExporter = <\n  BSchema extends BlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(\n  schema: Schema,\n  editor: BlockNoteEditor<BSchema, I, S>\n): ExternalHTMLExporter<BSchema, I, S> => {\n  const serializer = DOMSerializer.fromSchema(schema) as DOMSerializer & {\n    serializeNodeInner: (\n      node: Node,\n      options: { document?: Document }\n    ) => HTMLElement;\n    exportProseMirrorFragment: (fragment: Fragment) => string;\n    exportBlocks: (blocks: PartialBlock<BSchema, I, S>[]) => string;\n  };\n\n  serializer.serializeNodeInner = (\n    node: Node,\n    options: { document?: Document }\n  ) => serializeNodeInner(node, options, serializer, editor, true);\n\n  // Like the `internalHTMLSerializer`, also uses `serializeProseMirrorFragment`\n  // but additionally runs it through the `simplifyBlocks` rehype plugin to\n  // convert the internal HTML to external.\n  serializer.exportProseMirrorFragment = (fragment) => {\n    const externalHTML = unified()\n      .use(rehypeParse, { fragment: true })\n      .use(simplifyBlocks, {\n        orderedListItemBlockTypes: new Set<string>([\"numberedListItem\"]),\n        unorderedListItemBlockTypes: new Set<string>([\n          \"bulletListItem\",\n          \"checkListItem\",\n        ]),\n      })\n      .use(rehypeStringify)\n      .processSync(serializeProseMirrorFragment(fragment, serializer));\n\n    return externalHTML.value as string;\n  };\n\n  serializer.exportBlocks = (blocks: PartialBlock<BSchema, I, S>[]) => {\n    const nodes = blocks.map((block) =>\n      blockToNode(block, schema, editor.schema.styleSchema)\n    );\n    const blockGroup = schema.nodes[\"blockGroup\"].create(null, nodes);\n\n    return serializer.exportProseMirrorFragment(Fragment.from(blockGroup));\n  };\n\n  return serializer;\n};\n","import { DOMSerializer, Fragment, Node, Schema } from \"prosemirror-model\";\nimport { PartialBlock } from \"../../../blocks/defaultBlocks\";\nimport type { BlockNoteEditor } from \"../../../editor/BlockNoteEditor\";\nimport { BlockSchema, InlineContentSchema, StyleSchema } from \"../../../schema\";\nimport { blockToNode } from \"../../nodeConversions/nodeConversions\";\nimport {\n  serializeNodeInner,\n  serializeProseMirrorFragment,\n} from \"./util/sharedHTMLConversion\";\n\n// Used to serialize BlockNote blocks and ProseMirror nodes to HTML without\n// losing data. Blocks are exported using the `toInternalHTML` method in their\n// `blockSpec`.\n//\n// The HTML created by this serializer is the same as what's rendered by the\n// editor to the DOM. This means that it retains the same structure as the\n// editor, including the `blockGroup` and `blockContainer` wrappers. This also\n// means that it can be converted back to the original blocks without any data\n// loss.\n//\n// The serializer has 2 main methods:\n// `serializeFragment`: Serializes a ProseMirror fragment to HTML. This is\n// mostly useful if you want to serialize a selection which may not start/end at\n// the start/end of a block.\n// `serializeBlocks`: Serializes an array of blocks to HTML.\nexport interface InternalHTMLSerializer<\n  BSchema extends BlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n> {\n  // TODO: Ideally we would expand the BlockNote API to support partial\n  //  selections so we don't need this.\n  serializeProseMirrorFragment: (fragment: Fragment) => string;\n  serializeBlocks: (blocks: PartialBlock<BSchema, I, S>[]) => string;\n}\n\nexport const createInternalHTMLSerializer = <\n  BSchema extends BlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(\n  schema: Schema,\n  editor: BlockNoteEditor<BSchema, I, S>\n): InternalHTMLSerializer<BSchema, I, S> => {\n  const serializer = DOMSerializer.fromSchema(schema) as DOMSerializer & {\n    serializeNodeInner: (\n      node: Node,\n      options: { document?: Document }\n    ) => HTMLElement;\n    serializeBlocks: (blocks: PartialBlock<BSchema, I, S>[]) => string;\n    serializeProseMirrorFragment: (\n      fragment: Fragment,\n      options?: { document?: Document | undefined } | undefined,\n      target?: HTMLElement | DocumentFragment | undefined\n    ) => string;\n  };\n\n  serializer.serializeNodeInner = (\n    node: Node,\n    options: { document?: Document }\n  ) => serializeNodeInner(node, options, serializer, editor, false);\n\n  serializer.serializeProseMirrorFragment = (fragment: Fragment) =>\n    serializeProseMirrorFragment(fragment, serializer);\n\n  serializer.serializeBlocks = (blocks: PartialBlock<BSchema, I, S>[]) => {\n    const nodes = blocks.map((block) =>\n      blockToNode(block, schema, editor.schema.styleSchema)\n    );\n    const blockGroup = schema.nodes[\"blockGroup\"].create(null, nodes);\n\n    return serializer.serializeProseMirrorFragment(Fragment.from(blockGroup));\n  };\n\n  return serializer;\n};\n","export const isAppleOS = () =>\n  typeof navigator !== \"undefined\" &&\n  (/Mac/.test(navigator.platform) ||\n    (/AppleWebKit/.test(navigator.userAgent) &&\n      /Mobile\\/\\w+/.test(navigator.userAgent)));\n\nexport function formatKeyboardShortcut(shortcut: string, ctrlText = \"Ctrl\") {\n  if (isAppleOS()) {\n    return shortcut.replace(\"Mod\", \"⌘\");\n  } else {\n    return shortcut.replace(\"Mod\", ctrlText);\n  }\n}\n\nexport function mergeCSSClasses(...classes: string[]) {\n  return classes.filter((c) => c).join(\" \");\n}\n\nexport const isSafari = () =>\n  /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\n","import { blockToNode } from \"../api/nodeConversions/nodeConversions\";\nimport type { BlockNoteEditor } from \"../editor/BlockNoteEditor\";\nimport type {\n  BlockNoDefaults,\n  BlockSchema,\n  InlineContentSchema,\n  StyleSchema,\n} from \"../schema\";\nimport { mergeCSSClasses } from \"../util/browser\";\n\n// Function that creates a ProseMirror `DOMOutputSpec` for a default block.\n// Since all default blocks have the same structure (`blockContent` div with a\n// `inlineContent` element inside), this function only needs the block's name\n// for the `data-content-type` attribute of the `blockContent` element and the\n// HTML tag of the `inlineContent` element, as well as any HTML attributes to\n// add to those.\nexport function createDefaultBlockDOMOutputSpec(\n  blockName: string,\n  htmlTag: string,\n  blockContentHTMLAttributes: Record<string, string>,\n  inlineContentHTMLAttributes: Record<string, string>\n) {\n  const blockContent = document.createElement(\"div\");\n  blockContent.className = mergeCSSClasses(\n    \"bn-block-content\",\n    blockContentHTMLAttributes.class\n  );\n  blockContent.setAttribute(\"data-content-type\", blockName);\n  for (const [attribute, value] of Object.entries(blockContentHTMLAttributes)) {\n    if (attribute !== \"class\") {\n      blockContent.setAttribute(attribute, value);\n    }\n  }\n\n  const inlineContent = document.createElement(htmlTag);\n  inlineContent.className = mergeCSSClasses(\n    \"bn-inline-content\",\n    inlineContentHTMLAttributes.class\n  );\n  for (const [attribute, value] of Object.entries(\n    inlineContentHTMLAttributes\n  )) {\n    if (attribute !== \"class\") {\n      inlineContent.setAttribute(attribute, value);\n    }\n  }\n\n  blockContent.appendChild(inlineContent);\n\n  return {\n    dom: blockContent,\n    contentDOM: inlineContent,\n  };\n}\n\n// Function used to convert default blocks to HTML. It uses the corresponding\n// node's `renderHTML` method to do the conversion by using a default\n// `DOMSerializer`.\nexport const defaultBlockToHTML = <\n  BSchema extends BlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(\n  block: BlockNoDefaults<BSchema, I, S>,\n  editor: BlockNoteEditor<BSchema, I, S>\n): {\n  dom: HTMLElement;\n  contentDOM?: HTMLElement;\n} => {\n  const node = blockToNode(\n    block,\n    editor._tiptapEditor.schema,\n    editor.schema.styleSchema\n  ).firstChild!;\n  const toDOM = editor._tiptapEditor.schema.nodes[node.type.name].spec.toDOM;\n\n  if (toDOM === undefined) {\n    throw new Error(\n      \"This block has no default HTML serialization as its corresponding TipTap node doesn't implement `renderHTML`.\"\n    );\n  }\n\n  const renderSpec = toDOM(node);\n\n  if (typeof renderSpec !== \"object\" || !(\"dom\" in renderSpec)) {\n    throw new Error(\n      \"Cannot use this block's default HTML serialization as its corresponding TipTap node's `renderHTML` function does not return an object with the `dom` property.\"\n    );\n  }\n\n  return renderSpec as {\n    dom: HTMLElement;\n    contentDOM?: HTMLElement;\n  };\n};\n","import type { Props, PropSchema } from \"../schema\";\n\n// TODO: this system should probably be moved / refactored.\n// The dependency from schema on this file doesn't make sense\n\nexport const defaultProps = {\n  backgroundColor: {\n    default: \"default\" as const,\n  },\n  textColor: {\n    default: \"default\" as const,\n  },\n  textAlignment: {\n    default: \"left\" as const,\n    values: [\"left\", \"center\", \"right\", \"justify\"] as const,\n  },\n} satisfies PropSchema;\n\nexport type DefaultProps = Props<typeof defaultProps>;\n\n// Default props which are set on `blockContainer` nodes rather than\n// `blockContent` nodes. Ensures that they are not redundantly added to\n// a custom block's TipTap node attributes.\nexport const inheritedProps = [\"backgroundColor\", \"textColor\"];\n","export function camelToDataKebab(str: string): string {\n  return \"data-\" + str.replace(/([a-z])([A-Z])/g, \"$1-$2\").toLowerCase();\n}\n\nexport function filenameFromURL(url: string): string {\n  const parts = url.split(\"/\");\n  if (\n    !parts.length || // invalid?\n    parts[parts.length - 1] === \"\" // for example, URL ends in a directory-like trailing slash\n  ) {\n    // in this case just return the original url\n    return url;\n  }\n  return parts[parts.length - 1];\n}\n","import {\n  Attribute,\n  Attributes,\n  Editor,\n  Extension,\n  Node,\n  NodeConfig,\n} from \"@tiptap/core\";\nimport { defaultBlockToHTML } from \"../../blocks/defaultBlockHelpers\";\nimport { inheritedProps } from \"../../blocks/defaultProps\";\nimport type { BlockNoteEditor } from \"../../editor/BlockNoteEditor\";\nimport { mergeCSSClasses } from \"../../util/browser\";\nimport { camelToDataKebab } from \"../../util/string\";\nimport { InlineContentSchema } from \"../inlineContent/types\";\nimport { PropSchema, Props } from \"../propTypes\";\nimport { StyleSchema } from \"../styles/types\";\nimport {\n  BlockConfig,\n  BlockSchemaFromSpecs,\n  BlockSchemaWithBlock,\n  BlockSpec,\n  BlockSpecs,\n  SpecificBlock,\n  TiptapBlockImplementation,\n} from \"./types\";\n\n// Function that uses the 'propSchema' of a blockConfig to create a TipTap\n// node's `addAttributes` property.\n// TODO: extract function\nexport function propsToAttributes(propSchema: PropSchema): Attributes {\n  const tiptapAttributes: Record<string, Attribute> = {};\n\n  Object.entries(propSchema)\n    .filter(([name, _spec]) => !inheritedProps.includes(name))\n    .forEach(([name, spec]) => {\n      tiptapAttributes[name] = {\n        default: spec.default,\n        keepOnSplit: true,\n        // Props are displayed in kebab-case as HTML attributes. If a prop's\n        // value is the same as its default, we don't display an HTML\n        // attribute for it.\n        parseHTML: (element) => {\n          const value = element.getAttribute(camelToDataKebab(name));\n\n          if (value === null) {\n            return null;\n          }\n\n          if (typeof spec.default === \"boolean\") {\n            if (value === \"true\") {\n              return true;\n            }\n\n            if (value === \"false\") {\n              return false;\n            }\n\n            return null;\n          }\n\n          if (typeof spec.default === \"number\") {\n            const asNumber = parseFloat(value);\n            const isNumeric =\n              !Number.isNaN(asNumber) && Number.isFinite(asNumber);\n\n            if (isNumeric) {\n              return asNumber;\n            }\n\n            return null;\n          }\n\n          return value;\n        },\n        renderHTML: (attributes) =>\n          attributes[name] !== spec.default\n            ? {\n                [camelToDataKebab(name)]: attributes[name],\n              }\n            : {},\n      };\n    });\n\n  return tiptapAttributes;\n}\n\n// Used to figure out which block should be rendered. This block is then used to\n// create the node view.\nexport function getBlockFromPos<\n  BType extends string,\n  Config extends BlockConfig,\n  BSchema extends BlockSchemaWithBlock<BType, Config>,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(\n  getPos: (() => number) | boolean,\n  editor: BlockNoteEditor<BSchema, I, S>,\n  tipTapEditor: Editor,\n  type: BType\n) {\n  // Gets position of the node\n  if (typeof getPos === \"boolean\") {\n    throw new Error(\n      \"Cannot find node position as getPos is a boolean, not a function.\"\n    );\n  }\n  const pos = getPos();\n  // Gets parent blockContainer node\n  const blockContainer = tipTapEditor.state.doc.resolve(pos!).node();\n  // Gets block identifier\n  const blockIdentifier = blockContainer.attrs.id;\n\n  if (!blockIdentifier) {\n    throw new Error(\"Block doesn't have id\");\n  }\n\n  // Gets the block\n  const block = editor.getBlock(blockIdentifier)! as SpecificBlock<\n    BSchema,\n    BType,\n    I,\n    S\n  >;\n  if (block.type !== type) {\n    throw new Error(\"Block type does not match\");\n  }\n\n  return block;\n}\n\n// Function that wraps the `dom` element returned from 'blockConfig.render' in a\n// `blockContent` div, which contains the block type and props as HTML\n// attributes. If `blockConfig.render` also returns a `contentDOM`, it also adds\n// an `inlineContent` class to it.\nexport function wrapInBlockStructure<\n  BType extends string,\n  PSchema extends PropSchema\n>(\n  element: {\n    dom: HTMLElement;\n    contentDOM?: HTMLElement;\n    destroy?: () => void;\n  },\n  blockType: BType,\n  blockProps: Props<PSchema>,\n  propSchema: PSchema,\n  isFileBlock = false,\n  domAttributes?: Record<string, string>\n): {\n  dom: HTMLElement;\n  contentDOM?: HTMLElement;\n  destroy?: () => void;\n} {\n  // Creates `blockContent` element\n  const blockContent = document.createElement(\"div\");\n\n  // Adds custom HTML attributes\n  if (domAttributes !== undefined) {\n    for (const [attr, value] of Object.entries(domAttributes)) {\n      if (attr !== \"class\") {\n        blockContent.setAttribute(attr, value);\n      }\n    }\n  }\n  // Sets blockContent class\n  blockContent.className = mergeCSSClasses(\n    \"bn-block-content\",\n    domAttributes?.class || \"\"\n  );\n  // Sets content type attribute\n  blockContent.setAttribute(\"data-content-type\", blockType);\n  // Adds props as HTML attributes in kebab-case with \"data-\" prefix. Skips props\n  // which are already added as HTML attributes to the parent `blockContent`\n  // element (inheritedProps) and props set to their default values.\n  for (const [prop, value] of Object.entries(blockProps)) {\n    if (!inheritedProps.includes(prop) && value !== propSchema[prop].default) {\n      blockContent.setAttribute(camelToDataKebab(prop), value);\n    }\n  }\n  // Adds file block attribute\n  if (isFileBlock) {\n    blockContent.setAttribute(\"data-file-block\", \"\");\n  }\n\n  blockContent.appendChild(element.dom);\n\n  if (element.contentDOM !== undefined) {\n    element.contentDOM.className = mergeCSSClasses(\n      \"bn-inline-content\",\n      element.contentDOM.className\n    );\n    element.contentDOM.setAttribute(\"data-editable\", \"\");\n  }\n\n  return {\n    ...element,\n    dom: blockContent,\n  };\n}\n\n// Helper type to keep track of the `name` and `content` properties after calling Node.create.\ntype StronglyTypedTipTapNode<\n  Name extends string,\n  Content extends \"inline*\" | \"tableRow+\" | \"\"\n> = Node & { name: Name; config: { content: Content } };\n\nexport function createStronglyTypedTiptapNode<\n  Name extends string,\n  Content extends \"inline*\" | \"tableRow+\" | \"\"\n>(config: NodeConfig & { name: Name; content: Content }) {\n  return Node.create(config) as StronglyTypedTipTapNode<Name, Content>; // force re-typing (should be safe as it's type-checked from the config)\n}\n\n// This helper function helps to instantiate a blockspec with a\n// config and implementation that conform to the type of Config\nexport function createInternalBlockSpec<T extends BlockConfig>(\n  config: T,\n  implementation: TiptapBlockImplementation<\n    T,\n    any,\n    InlineContentSchema,\n    StyleSchema\n  >\n) {\n  return {\n    config,\n    implementation,\n  } satisfies BlockSpec<T, any, InlineContentSchema, StyleSchema>;\n}\n\nexport function createBlockSpecFromStronglyTypedTiptapNode<\n  T extends Node,\n  P extends PropSchema\n>(node: T, propSchema: P, requiredExtensions?: Array<Extension | Node>) {\n  return createInternalBlockSpec(\n    {\n      type: node.name as T[\"name\"],\n      content: (node.config.content === \"inline*\"\n        ? \"inline\"\n        : node.config.content === \"tableRow+\"\n        ? \"table\"\n        : \"none\") as T[\"config\"][\"content\"] extends \"inline*\"\n        ? \"inline\"\n        : T[\"config\"][\"content\"] extends \"tableRow+\"\n        ? \"table\"\n        : \"none\",\n      propSchema,\n    },\n    {\n      node,\n      requiredExtensions,\n      toInternalHTML: defaultBlockToHTML,\n      toExternalHTML: defaultBlockToHTML,\n      // parse: () => undefined, // parse rules are in node already\n    }\n  );\n}\n\nexport function getBlockSchemaFromSpecs<T extends BlockSpecs>(specs: T) {\n  return Object.fromEntries(\n    Object.entries(specs).map(([key, value]) => [key, value.config])\n  ) as BlockSchemaFromSpecs<T>;\n}\n","import { TagParseRule } from \"@tiptap/pm/model\";\nimport type { BlockNoteEditor } from \"../../editor/BlockNoteEditor\";\nimport { InlineContentSchema } from \"../inlineContent/types\";\nimport { StyleSchema } from \"../styles/types\";\nimport {\n  createInternalBlockSpec,\n  createStronglyTypedTiptapNode,\n  getBlockFromPos,\n  propsToAttributes,\n  wrapInBlockStructure,\n} from \"./internal\";\nimport {\n  BlockConfig,\n  BlockFromConfig,\n  BlockSchemaWithBlock,\n  PartialBlockFromConfig,\n} from \"./types\";\n\n// restrict content to \"inline\" and \"none\" only\nexport type CustomBlockConfig = BlockConfig & {\n  content: \"inline\" | \"none\";\n};\n\nexport type CustomBlockImplementation<\n  T extends CustomBlockConfig,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n> = {\n  render: (\n    /**\n     * The custom block to render\n     */\n    block: BlockFromConfig<T, I, S>,\n    /**\n     * The BlockNote editor instance\n     * This is typed generically. If you want an editor with your custom schema, you need to\n     * cast it manually, e.g.: `const e = editor as BlockNoteEditor<typeof mySchema>;`\n     */\n    editor: BlockNoteEditor<BlockSchemaWithBlock<T[\"type\"], T>, I, S>\n    // (note) if we want to fix the manual cast, we need to prevent circular references and separate block definition and render implementations\n    // or allow manually passing <BSchema>, but that's not possible without passing the other generics because Typescript doesn't support partial inferred generics\n  ) => {\n    dom: HTMLElement;\n    contentDOM?: HTMLElement;\n    destroy?: () => void;\n  };\n  // Exports block to external HTML. If not defined, the output will be the same\n  // as `render(...).dom`. Used to create clipboard data when pasting outside\n  // BlockNote.\n  // TODO: Maybe can return undefined to ignore when serializing?\n  toExternalHTML?: (\n    block: BlockFromConfig<T, I, S>,\n    editor: BlockNoteEditor<BlockSchemaWithBlock<T[\"type\"], T>, I, S>\n  ) => {\n    dom: HTMLElement;\n    contentDOM?: HTMLElement;\n  };\n\n  parse?: (\n    el: HTMLElement\n  ) => PartialBlockFromConfig<T, I, S>[\"props\"] | undefined;\n};\n\n// Function that uses the 'parse' function of a blockConfig to create a\n// TipTap node's `parseHTML` property. This is only used for parsing content\n// from the clipboard.\nexport function getParseRules(\n  config: BlockConfig,\n  customParseFunction: CustomBlockImplementation<any, any, any>[\"parse\"]\n) {\n  const rules: TagParseRule[] = [\n    {\n      tag: \"[data-content-type=\" + config.type + \"]\",\n      contentElement: \"[data-editable]\",\n    },\n  ];\n\n  if (customParseFunction) {\n    rules.push({\n      tag: \"*\",\n      getAttrs(node: string | HTMLElement) {\n        if (typeof node === \"string\") {\n          return false;\n        }\n\n        const props = customParseFunction?.(node);\n\n        if (props === undefined) {\n          return false;\n        }\n\n        return props;\n      },\n    });\n  }\n  //     getContent(node, schema) {\n  //       const block = blockConfig.parse?.(node as HTMLElement);\n  //\n  //       if (block !== undefined && block.content !== undefined) {\n  //         return Fragment.from(\n  //           typeof block.content === \"string\"\n  //             ? schema.text(block.content)\n  //             : inlineContentToNodes(block.content, schema)\n  //         );\n  //       }\n  //\n  //       return Fragment.empty;\n  //     },\n  //   });\n  // }\n\n  return rules;\n}\n\n// A function to create custom block for API consumers\n// we want to hide the tiptap node from API consumers and provide a simpler API surface instead\nexport function createBlockSpec<\n  T extends CustomBlockConfig,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(blockConfig: T, blockImplementation: CustomBlockImplementation<T, I, S>) {\n  const node = createStronglyTypedTiptapNode({\n    name: blockConfig.type as T[\"type\"],\n    content: (blockConfig.content === \"inline\"\n      ? \"inline*\"\n      : \"\") as T[\"content\"] extends \"inline\" ? \"inline*\" : \"\",\n    group: \"blockContent\",\n    selectable: true,\n\n    addAttributes() {\n      return propsToAttributes(blockConfig.propSchema);\n    },\n\n    parseHTML() {\n      return getParseRules(blockConfig, blockImplementation.parse);\n    },\n\n    renderHTML() {\n      // renderHTML is not really used, as we always use a nodeView, and we use toExternalHTML / toInternalHTML for serialization\n      // There's an edge case when this gets called nevertheless; before the nodeviews have been mounted\n      // this is why we implement it with a temporary placeholder\n      const div = document.createElement(\"div\");\n      div.setAttribute(\"data-tmp-placeholder\", \"true\");\n      return {\n        dom: div,\n      };\n    },\n\n    addNodeView() {\n      return ({ getPos }) => {\n        // Gets the BlockNote editor instance\n        const editor = this.options.editor;\n        // Gets the block\n        const block = getBlockFromPos(\n          getPos,\n          editor,\n          this.editor,\n          blockConfig.type\n        );\n        // Gets the custom HTML attributes for `blockContent` nodes\n        const blockContentDOMAttributes =\n          this.options.domAttributes?.blockContent || {};\n\n        const output = blockImplementation.render(block as any, editor);\n\n        return wrapInBlockStructure(\n          output,\n          block.type,\n          block.props,\n          blockConfig.propSchema,\n          blockContentDOMAttributes\n        );\n      };\n    },\n  });\n\n  if (node.name !== blockConfig.type) {\n    throw new Error(\n      \"Node name does not match block type. This is a bug in BlockNote.\"\n    );\n  }\n\n  return createInternalBlockSpec(blockConfig, {\n    node,\n    toInternalHTML: (block, editor) => {\n      const blockContentDOMAttributes =\n        node.options.domAttributes?.blockContent || {};\n\n      const output = blockImplementation.render(block as any, editor as any);\n\n      return wrapInBlockStructure(\n        output,\n        block.type,\n        block.props,\n        blockConfig.propSchema,\n        blockConfig.isFileBlock,\n        blockContentDOMAttributes\n      );\n    },\n    toExternalHTML: (block, editor) => {\n      const blockContentDOMAttributes =\n        node.options.domAttributes?.blockContent || {};\n\n      let output = blockImplementation.toExternalHTML?.(\n        block as any,\n        editor as any\n      );\n      if (output === undefined) {\n        output = blockImplementation.render(block as any, editor as any);\n      }\n\n      return wrapInBlockStructure(\n        output,\n        block.type,\n        block.props,\n        blockConfig.propSchema,\n        blockContentDOMAttributes\n      );\n    },\n  });\n}\n","import { KeyboardShortcutCommand, Node } from \"@tiptap/core\";\n\nimport { camelToDataKebab } from \"../../util/string\";\nimport { PropSchema, Props } from \"../propTypes\";\nimport {\n  CustomInlineContentConfig,\n  InlineContentConfig,\n  InlineContentImplementation,\n  InlineContentSchemaFromSpecs,\n  InlineContentSpec,\n  InlineContentSpecs,\n} from \"./types\";\n\n// Function that adds necessary classes and attributes to the `dom` element\n// returned from a custom inline content's 'render' function, to ensure no data\n// is lost on internal copy & paste.\nexport function addInlineContentAttributes<\n  IType extends string,\n  PSchema extends PropSchema\n>(\n  element: {\n    dom: HTMLElement;\n    contentDOM?: HTMLElement;\n  },\n  inlineContentType: IType,\n  inlineContentProps: Props<PSchema>,\n  propSchema: PSchema\n): {\n  dom: HTMLElement;\n  contentDOM?: HTMLElement;\n} {\n  // Sets content type attribute\n  element.dom.setAttribute(\"data-inline-content-type\", inlineContentType);\n  // Adds props as HTML attributes in kebab-case with \"data-\" prefix. Skips props\n  // set to their default values.\n  Object.entries(inlineContentProps)\n    .filter(([prop, value]) => value !== propSchema[prop].default)\n    .map(([prop, value]) => {\n      return [camelToDataKebab(prop), value];\n    })\n    .forEach(([prop, value]) => element.dom.setAttribute(prop, value));\n\n  if (element.contentDOM !== undefined) {\n    element.contentDOM.setAttribute(\"data-editable\", \"\");\n  }\n\n  return element;\n}\n\n// see https://github.com/TypeCellOS/BlockNote/pull/435\nexport function addInlineContentKeyboardShortcuts<\n  T extends CustomInlineContentConfig\n>(\n  config: T\n): {\n  [p: string]: KeyboardShortcutCommand;\n} {\n  return {\n    Backspace: ({ editor }) => {\n      const resolvedPos = editor.state.selection.$from;\n\n      return (\n        editor.state.selection.empty &&\n        resolvedPos.node().type.name === config.type &&\n        resolvedPos.parentOffset === 0\n      );\n    },\n  };\n}\n\n// This helper function helps to instantiate a InlineContentSpec with a\n// config and implementation that conform to the type of Config\nexport function createInternalInlineContentSpec<T extends InlineContentConfig>(\n  config: T,\n  implementation: InlineContentImplementation<T>\n) {\n  return {\n    config,\n    implementation,\n  } satisfies InlineContentSpec<T>;\n}\n\nexport function createInlineContentSpecFromTipTapNode<\n  T extends Node,\n  P extends PropSchema\n>(node: T, propSchema: P) {\n  return createInternalInlineContentSpec(\n    {\n      type: node.name as T[\"name\"],\n      propSchema,\n      content: node.config.content === \"inline*\" ? \"styled\" : \"none\",\n    },\n    {\n      node,\n    }\n  );\n}\n\nexport function getInlineContentSchemaFromSpecs<T extends InlineContentSpecs>(\n  specs: T\n) {\n  return Object.fromEntries(\n    Object.entries(specs).map(([key, value]) => [key, value.config])\n  ) as InlineContentSchemaFromSpecs<T>;\n}\n","import { Node } from \"@tiptap/core\";\nimport { TagParseRule } from \"@tiptap/pm/model\";\nimport { nodeToCustomInlineContent } from \"../../api/nodeConversions/nodeConversions\";\nimport { propsToAttributes } from \"../blocks/internal\";\nimport { Props } from \"../propTypes\";\nimport { StyleSchema } from \"../styles/types\";\nimport {\n  addInlineContentAttributes,\n  addInlineContentKeyboardShortcuts,\n  createInlineContentSpecFromTipTapNode,\n} from \"./internal\";\nimport {\n  CustomInlineContentConfig,\n  InlineContentConfig,\n  InlineContentFromConfig,\n  InlineContentSpec,\n} from \"./types\";\n\n// TODO: support serialization\n\nexport type CustomInlineContentImplementation<\n  T extends InlineContentConfig,\n  // B extends BlockSchema,\n  // I extends InlineContentSchema,\n  S extends StyleSchema\n> = {\n  render: (\n    /**\n     * The custom inline content to render\n     */\n    inlineContent: InlineContentFromConfig<T, S>\n    /**\n     * The BlockNote editor instance\n     * This is typed generically. If you want an editor with your custom schema, you need to\n     * cast it manually, e.g.: `const e = editor as BlockNoteEditor<typeof mySchema>;`\n     */\n    // editor: BlockNoteEditor<B, I, S>\n    // (note) if we want to fix the manual cast, we need to prevent circular references and separate block definition and render implementations\n    // or allow manually passing <BSchema>, but that's not possible without passing the other generics because Typescript doesn't support partial inferred generics\n  ) => {\n    dom: HTMLElement;\n    contentDOM?: HTMLElement;\n    // destroy?: () => void;\n  };\n};\n\nexport function getInlineContentParseRules(\n  config: CustomInlineContentConfig\n): TagParseRule[] {\n  return [\n    {\n      tag: `[data-inline-content-type=\"${config.type}\"]`,\n      contentElement: (element) => {\n        const htmlElement = element as HTMLElement;\n\n        if (htmlElement.matches(\"[data-editable]\")) {\n          return htmlElement;\n        }\n\n        return htmlElement.querySelector(\"[data-editable]\") || htmlElement;\n      },\n    },\n  ];\n}\n\nexport function createInlineContentSpec<\n  T extends CustomInlineContentConfig,\n  S extends StyleSchema\n>(\n  inlineContentConfig: T,\n  inlineContentImplementation: CustomInlineContentImplementation<T, S>\n): InlineContentSpec<T> {\n  const node = Node.create({\n    name: inlineContentConfig.type,\n    inline: true,\n    group: \"inline\",\n    selectable: inlineContentConfig.content === \"styled\",\n    atom: inlineContentConfig.content === \"none\",\n    content: (inlineContentConfig.content === \"styled\"\n      ? \"inline*\"\n      : \"\") as T[\"content\"] extends \"styled\" ? \"inline*\" : \"\",\n\n    addAttributes() {\n      return propsToAttributes(inlineContentConfig.propSchema);\n    },\n\n    addKeyboardShortcuts() {\n      return addInlineContentKeyboardShortcuts(inlineContentConfig);\n    },\n\n    parseHTML() {\n      return getInlineContentParseRules(inlineContentConfig);\n    },\n\n    renderHTML({ node }) {\n      const editor = this.options.editor;\n\n      const output = inlineContentImplementation.render(\n        nodeToCustomInlineContent(\n          node,\n          editor.schema.inlineContentSchema,\n          editor.schema.styleSchema\n        ) as any as InlineContentFromConfig<T, S> // TODO: fix cast\n      );\n\n      return addInlineContentAttributes(\n        output,\n        inlineContentConfig.type,\n        node.attrs as Props<T[\"propSchema\"]>,\n        inlineContentConfig.propSchema\n      );\n    },\n  });\n\n  return createInlineContentSpecFromTipTapNode(\n    node,\n    inlineContentConfig.propSchema\n  ) as InlineContentSpec<T>; // TODO: fix cast\n}\n","import { Attributes, Mark } from \"@tiptap/core\";\nimport {\n  StyleConfig,\n  StyleImplementation,\n  StylePropSchema,\n  StyleSchemaFromSpecs,\n  StyleSpec,\n  StyleSpecs,\n} from \"./types\";\n\nexport function stylePropsToAttributes(\n  propSchema: StylePropSchema\n): Attributes {\n  if (propSchema === \"boolean\") {\n    return {};\n  }\n  return {\n    stringValue: {\n      default: undefined,\n      keepOnSplit: true,\n      parseHTML: (element) => element.getAttribute(\"data-value\"),\n      renderHTML: (attributes) =>\n        attributes.stringValue !== undefined\n          ? {\n              \"data-value\": attributes.stringValue,\n            }\n          : {},\n    },\n  };\n}\n\n// Function that adds necessary classes and attributes to the `dom` element\n// returned from a custom style's 'render' function, to ensure no data is lost\n// on internal copy & paste.\nexport function addStyleAttributes<\n  SType extends string,\n  PSchema extends StylePropSchema\n>(\n  element: {\n    dom: HTMLElement;\n    contentDOM?: HTMLElement;\n  },\n  styleType: SType,\n  styleValue: PSchema extends \"boolean\" ? undefined : string,\n  propSchema: PSchema\n): {\n  dom: HTMLElement;\n  contentDOM?: HTMLElement;\n} {\n  // Sets content type attribute\n  element.dom.setAttribute(\"data-style-type\", styleType);\n  // Adds style value as an HTML attribute in kebab-case with \"data-\" prefix, if\n  // the style takes a string value.\n  if (propSchema === \"string\") {\n    element.dom.setAttribute(\"data-value\", styleValue as string);\n  }\n\n  if (element.contentDOM !== undefined) {\n    element.contentDOM.setAttribute(\"data-editable\", \"\");\n  }\n\n  return element;\n}\n\n// This helper function helps to instantiate a stylespec with a\n// config and implementation that conform to the type of Config\nexport function createInternalStyleSpec<T extends StyleConfig>(\n  config: T,\n  implementation: StyleImplementation\n) {\n  return {\n    config,\n    implementation,\n  } satisfies StyleSpec<T>;\n}\n\nexport function createStyleSpecFromTipTapMark<\n  T extends Mark,\n  P extends StylePropSchema\n>(mark: T, propSchema: P) {\n  return createInternalStyleSpec(\n    {\n      type: mark.name as T[\"name\"],\n      propSchema,\n    },\n    {\n      mark,\n    }\n  );\n}\n\nexport function getStyleSchemaFromSpecs<T extends StyleSpecs>(specs: T) {\n  return Object.fromEntries(\n    Object.entries(specs).map(([key, value]) => [key, value.config])\n  ) as StyleSchemaFromSpecs<T>;\n}\n","import { Mark } from \"@tiptap/core\";\nimport { ParseRule } from \"@tiptap/pm/model\";\nimport {\n  addStyleAttributes,\n  createInternalStyleSpec,\n  stylePropsToAttributes,\n} from \"./internal\";\nimport { StyleConfig, StyleSpec } from \"./types\";\nimport {UnreachableCaseError} from \"../../util/typescript\";\n\nexport type CustomStyleImplementation<T extends StyleConfig> = {\n  render: T[\"propSchema\"] extends \"boolean\"\n    ? () => {\n        dom: HTMLElement;\n        contentDOM?: HTMLElement;\n      }\n    : (value: string) => {\n        dom: HTMLElement;\n        contentDOM?: HTMLElement;\n      };\n};\n\n// TODO: support serialization\n\nexport function getStyleParseRules(config: StyleConfig): ParseRule[] {\n  return [\n    {\n      tag: `[data-style-type=\"${config.type}\"]`,\n      contentElement: (element) => {\n        const htmlElement = element as HTMLElement;\n\n        if (htmlElement.matches(\"[data-editable]\")) {\n          return htmlElement;\n        }\n\n        return htmlElement.querySelector(\"[data-editable]\") || htmlElement;\n      },\n    },\n  ];\n}\n\nexport function createStyleSpec<T extends StyleConfig>(\n  styleConfig: T,\n  styleImplementation: CustomStyleImplementation<T>\n): StyleSpec<T> {\n  const mark = Mark.create({\n    name: styleConfig.type,\n\n    addAttributes() {\n      return stylePropsToAttributes(styleConfig.propSchema);\n    },\n\n    parseHTML() {\n      return getStyleParseRules(styleConfig);\n    },\n\n    renderHTML({ mark }) {\n      let renderResult: {\n        dom: HTMLElement;\n        contentDOM?: HTMLElement;\n      };\n\n      if (styleConfig.propSchema === \"boolean\") {\n        // @ts-ignore not sure why this is complaining\n        renderResult = styleImplementation.render();\n      } else if (styleConfig.propSchema === \"string\") {\n        renderResult = styleImplementation.render(mark.attrs.stringValue);\n      } else {\n        throw new UnreachableCaseError(styleConfig.propSchema);\n      }\n\n      // const renderResult = styleImplementation.render();\n      return addStyleAttributes(\n        renderResult,\n        styleConfig.type,\n        mark.attrs.stringValue,\n        styleConfig.propSchema\n      );\n    },\n  });\n\n  return createInternalStyleSpec(styleConfig, {\n    mark,\n  });\n}\n","import type { BlockNoteEditor } from \"../../editor/BlockNoteEditor\";\nimport { BlockFromConfig, FileBlockConfig } from \"../../schema\";\n\n// Default file preview, displaying a file icon and file name.\nexport const createDefaultFilePreview = (\n  block: BlockFromConfig<FileBlockConfig, any, any>\n): { dom: HTMLElement; destroy?: () => void } => {\n  const file = document.createElement(\"div\");\n  file.className = \"bn-file-default-preview\";\n\n  const icon = document.createElement(\"div\");\n  icon.className = \"bn-file-default-preview-icon\";\n  icon.innerHTML =\n    '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"currentColor\"><path d=\"M3 8L9.00319 2H19.9978C20.5513 2 21 2.45531 21 2.9918V21.0082C21 21.556 20.5551 22 20.0066 22H3.9934C3.44476 22 3 21.5501 3 20.9932V8ZM10 4V9H5V20H19V4H10Z\"></path></svg>';\n\n  const fileName = document.createElement(\"p\");\n  fileName.className = \"bn-file-default-preview-name\";\n  fileName.textContent = block.props.name || \"\";\n\n  file.appendChild(icon);\n  file.appendChild(fileName);\n\n  return {\n    dom: file,\n  };\n};\n\n// Wrapper element containing file preview and caption.\nexport const createFileAndCaptionWrapper = (\n  block: BlockFromConfig<FileBlockConfig, any, any>,\n  file: HTMLElement\n) => {\n  const fileAndCaptionWrapper = document.createElement(\"div\");\n  fileAndCaptionWrapper.className = \"bn-file-and-caption-wrapper\";\n\n  const caption = document.createElement(\"p\");\n  caption.className = \"bn-file-caption\";\n  caption.textContent = block.props.caption;\n\n  fileAndCaptionWrapper.appendChild(file);\n  fileAndCaptionWrapper.appendChild(caption);\n\n  return {\n    dom: fileAndCaptionWrapper,\n  };\n};\n\n// Button element that acts as a placeholder for files with no src.\nexport const createAddFileButton = (\n  block: BlockFromConfig<FileBlockConfig, any, any>,\n  editor: BlockNoteEditor<any, any, any>,\n  buttonText?: string,\n  buttonIcon?: HTMLElement\n) => {\n  const addFileButton = document.createElement(\"div\");\n  addFileButton.className = \"bn-add-file-button\";\n\n  const addFileButtonIcon = document.createElement(\"div\");\n  addFileButtonIcon.className = \"bn-add-file-button-icon\";\n  if (buttonIcon) {\n    addFileButtonIcon.appendChild(buttonIcon);\n  } else {\n    addFileButtonIcon.innerHTML =\n      '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"currentColor\"><path d=\"M3 8L9.00319 2H19.9978C20.5513 2 21 2.45531 21 2.9918V21.0082C21 21.556 20.5551 22 20.0066 22H3.9934C3.44476 22 3 21.5501 3 20.9932V8ZM10 4V9H5V20H19V4H10Z\"></path></svg>';\n  }\n\n  const addFileButtonText = document.createElement(\"p\");\n  addFileButtonText.className = \"bn-add-file-button-text\";\n  addFileButtonText.innerHTML =\n    buttonText || editor.dictionary.file_blocks.file.add_button_text;\n\n  // Prevents focus from moving to the button.\n  const addFileButtonMouseDownHandler = (event: MouseEvent) => {\n    event.preventDefault();\n  };\n  // Opens the file toolbar.\n  const addFileButtonClickHandler = () => {\n    editor._tiptapEditor.view.dispatch(\n      editor._tiptapEditor.state.tr.setMeta(editor.filePanel!.plugin, {\n        block: block,\n      })\n    );\n  };\n\n  addFileButton.appendChild(addFileButtonIcon);\n  addFileButton.appendChild(addFileButtonText);\n\n  addFileButton.addEventListener(\n    \"mousedown\",\n    addFileButtonMouseDownHandler,\n    true\n  );\n  addFileButton.addEventListener(\"click\", addFileButtonClickHandler, true);\n\n  return {\n    dom: addFileButton,\n    destroy: () => {\n      addFileButton.removeEventListener(\n        \"mousedown\",\n        addFileButtonMouseDownHandler,\n        true\n      );\n      addFileButton.removeEventListener(\n        \"click\",\n        addFileButtonClickHandler,\n        true\n      );\n    },\n  };\n};\n\nexport const parseEmbedElement = (embedElement: HTMLEmbedElement) => {\n  const url = embedElement.src || undefined;\n\n  return { url };\n};\n\nexport const parseFigureElement = (\n  figureElement: HTMLElement,\n  targetTag: string\n) => {\n  const targetElement = figureElement.querySelector(\n    targetTag\n  ) as HTMLElement | null;\n  if (!targetElement) {\n    return undefined;\n  }\n\n  const captionElement = figureElement.querySelector(\"figcaption\");\n  const caption = captionElement?.textContent ?? undefined;\n\n  return { targetElement, caption };\n};\n\n// Wrapper figure element to display file link with caption. Used for external\n// HTML\nexport const createLinkWithCaption = (\n  element: HTMLElement,\n  caption: string\n) => {\n  const wrapper = document.createElement(\"div\");\n  const fileCaption = document.createElement(\"p\");\n  fileCaption.textContent = caption;\n\n  wrapper.appendChild(element);\n  wrapper.appendChild(fileCaption);\n\n  return {\n    dom: wrapper,\n  };\n};\n\n// Wrapper figure element to display file preview with caption. Used for\n// external HTML.\nexport const createFigureWithCaption = (\n  element: HTMLElement,\n  caption: string\n) => {\n  const figure = document.createElement(\"figure\");\n  const captionElement = document.createElement(\"figcaption\");\n  captionElement.textContent = caption;\n\n  figure.appendChild(element);\n  figure.appendChild(captionElement);\n\n  return { dom: figure };\n};\n\n// Wrapper element which adds resize handles & logic for visual media file\n// previews.\nexport const createResizeHandlesWrapper = (\n  block: BlockFromConfig<FileBlockConfig, any, any>,\n  editor: BlockNoteEditor<any, any, any>,\n  element: HTMLElement,\n  getWidth: () => number,\n  setWidth: (width: number) => void\n): { dom: HTMLElement; destroy: () => void } => {\n  if (!block.props.previewWidth) {\n    throw new Error(\"Block must have a `previewWidth` prop.\");\n  }\n\n  // Wrapper element for rendered element and resize handles.\n  const wrapper = document.createElement(\"div\");\n  wrapper.className = \"bn-visual-media-wrapper\";\n\n  // Resize handle elements.\n  const leftResizeHandle = document.createElement(\"div\");\n  leftResizeHandle.className = \"bn-visual-media-resize-handle\";\n  leftResizeHandle.style.left = \"4px\";\n  const rightResizeHandle = document.createElement(\"div\");\n  rightResizeHandle.className = \"bn-visual-media-resize-handle\";\n  rightResizeHandle.style.right = \"4px\";\n\n  // Temporary parameters set when the user begins resizing the element, used to\n  // calculate the new width of the element.\n  let resizeParams:\n    | {\n        handleUsed: \"left\" | \"right\";\n        initialWidth: number;\n        initialClientX: number;\n      }\n    | undefined;\n\n  // Updates the element width with an updated width depending on the cursor X\n  // offset from when the resize began, and which resize handle is being used.\n  const windowMouseMoveHandler = (event: MouseEvent) => {\n    if (!resizeParams) {\n      if (\n        !editor.isEditable &&\n        wrapper.contains(leftResizeHandle) &&\n        wrapper.contains(rightResizeHandle)\n      ) {\n        wrapper.removeChild(leftResizeHandle);\n        wrapper.removeChild(rightResizeHandle);\n      }\n\n      return;\n    }\n\n    let newWidth: number;\n\n    if (block.props.textAlignment === \"center\") {\n      if (resizeParams.handleUsed === \"left\") {\n        newWidth =\n          resizeParams.initialWidth +\n          (resizeParams.initialClientX - event.clientX) * 2;\n      } else {\n        newWidth =\n          resizeParams.initialWidth +\n          (event.clientX - resizeParams.initialClientX) * 2;\n      }\n    } else {\n      if (resizeParams.handleUsed === \"left\") {\n        newWidth =\n          resizeParams.initialWidth +\n          resizeParams.initialClientX -\n          event.clientX;\n      } else {\n        newWidth =\n          resizeParams.initialWidth +\n          event.clientX -\n          resizeParams.initialClientX;\n      }\n    }\n\n    // Min element width in px.\n    const minWidth = 64;\n\n    // Ensures the element is not wider than the editor and not smaller than a\n    // predetermined minimum width.\n    if (newWidth < minWidth) {\n      setWidth(minWidth);\n    } else if (newWidth > editor.domElement.firstElementChild!.clientWidth) {\n      setWidth(editor.domElement.firstElementChild!.clientWidth);\n    } else {\n      setWidth(newWidth);\n    }\n  };\n  // Stops mouse movements from resizing the element and updates the block's\n  // `width` prop to the new value.\n  const windowMouseUpHandler = (event: MouseEvent) => {\n    // Hides the drag handles if the cursor is no longer over the element.\n    if (\n      (!event.target ||\n        !wrapper.contains(event.target as Node) ||\n        !editor.isEditable) &&\n      wrapper.contains(leftResizeHandle) &&\n      wrapper.contains(rightResizeHandle)\n    ) {\n      wrapper.removeChild(leftResizeHandle);\n      wrapper.removeChild(rightResizeHandle);\n    }\n\n    if (!resizeParams) {\n      return;\n    }\n\n    resizeParams = undefined;\n\n    editor.updateBlock(block, {\n      props: {\n        previewWidth: getWidth(),\n      },\n    });\n  };\n\n  // Shows the resize handles when hovering over the element with the cursor.\n  const elementMouseEnterHandler = () => {\n    if (editor.isEditable) {\n      wrapper.appendChild(leftResizeHandle);\n      wrapper.appendChild(rightResizeHandle);\n    }\n  };\n  // Hides the resize handles when the cursor leaves the element, unless the\n  // cursor moves to one of the resize handles.\n  const elementMouseLeaveHandler = (event: MouseEvent) => {\n    if (\n      event.relatedTarget === leftResizeHandle ||\n      event.relatedTarget === rightResizeHandle\n    ) {\n      return;\n    }\n\n    if (resizeParams) {\n      return;\n    }\n\n    if (\n      editor.isEditable &&\n      wrapper.contains(leftResizeHandle) &&\n      wrapper.contains(rightResizeHandle)\n    ) {\n      wrapper.removeChild(leftResizeHandle);\n      wrapper.removeChild(rightResizeHandle);\n    }\n  };\n\n  // Sets the resize params, allowing the user to begin resizing the element by\n  // moving the cursor left or right.\n  const leftResizeHandleMouseDownHandler = (event: MouseEvent) => {\n    event.preventDefault();\n\n    wrapper.appendChild(leftResizeHandle);\n    wrapper.appendChild(rightResizeHandle);\n\n    resizeParams = {\n      handleUsed: \"left\",\n      initialWidth: block.props.previewWidth!,\n      initialClientX: event.clientX,\n    };\n  };\n  const rightResizeHandleMouseDownHandler = (event: MouseEvent) => {\n    event.preventDefault();\n\n    wrapper.appendChild(leftResizeHandle);\n    wrapper.appendChild(rightResizeHandle);\n\n    resizeParams = {\n      handleUsed: \"right\",\n      initialWidth: block.props.previewWidth!,\n      initialClientX: event.clientX,\n    };\n  };\n\n  wrapper.appendChild(element);\n\n  window.addEventListener(\"mousemove\", windowMouseMoveHandler);\n  window.addEventListener(\"mouseup\", windowMouseUpHandler);\n  element.addEventListener(\"mouseenter\", elementMouseEnterHandler);\n  element.addEventListener(\"mouseleave\", elementMouseLeaveHandler);\n  leftResizeHandle.addEventListener(\n    \"mousedown\",\n    leftResizeHandleMouseDownHandler\n  );\n  rightResizeHandle.addEventListener(\n    \"mousedown\",\n    rightResizeHandleMouseDownHandler\n  );\n\n  return {\n    dom: wrapper,\n    destroy: () => {\n      window.removeEventListener(\"mousemove\", windowMouseMoveHandler);\n      window.removeEventListener(\"mouseup\", windowMouseUpHandler);\n      element.removeEventListener(\"mouseenter\", elementMouseEnterHandler);\n      element.removeEventListener(\"mouseleave\", elementMouseLeaveHandler);\n      leftResizeHandle.removeEventListener(\n        \"mousedown\",\n        leftResizeHandleMouseDownHandler\n      );\n      rightResizeHandle.removeEventListener(\n        \"mousedown\",\n        rightResizeHandleMouseDownHandler\n      );\n    },\n  };\n};\n","import type { BlockNoteEditor } from \"../../editor/BlockNoteEditor\";\nimport {\n  BlockFromConfig,\n  FileBlockConfig,\n  PropSchema,\n  createBlockSpec,\n} from \"../../schema\";\nimport { defaultProps } from \"../defaultProps\";\nimport {\n  createAddFileButton,\n  createDefaultFilePreview,\n  createFileAndCaptionWrapper,\n  createLinkWithCaption,\n  parseEmbedElement,\n  parseFigureElement,\n} from \"./fileBlockHelpers\";\n\nexport const filePropSchema = {\n  backgroundColor: defaultProps.backgroundColor,\n  // File name.\n  name: {\n    default: \"\" as const,\n  },\n  // File url.\n  url: {\n    default: \"\" as const,\n  },\n  // File caption.\n  caption: {\n    default: \"\" as const,\n  },\n} satisfies PropSchema;\n\nexport const fileBlockConfig = {\n  type: \"file\" as const,\n  propSchema: filePropSchema,\n  content: \"none\",\n  isFileBlock: true,\n} satisfies FileBlockConfig;\n\nexport const fileRender = (\n  block: BlockFromConfig<typeof fileBlockConfig, any, any>,\n  editor: BlockNoteEditor<any, any, any>\n) => {\n  // Wrapper element to set the file alignment, contains both file/file\n  // upload dashboard and caption.\n  const wrapper = document.createElement(\"div\");\n  wrapper.className = \"bn-file-block-content-wrapper\";\n\n  if (block.props.url === \"\") {\n    const addFileButton = createAddFileButton(block, editor);\n    wrapper.appendChild(addFileButton.dom);\n\n    return {\n      dom: wrapper,\n      destroy: addFileButton.destroy,\n    };\n  } else {\n    const file = createDefaultFilePreview(block).dom;\n    const element = createFileAndCaptionWrapper(block, file);\n    wrapper.appendChild(element.dom);\n\n    return {\n      dom: wrapper,\n    };\n  }\n};\n\nexport const fileParse = (element: HTMLElement) => {\n  if (element.tagName === \"EMBED\") {\n    return parseEmbedElement(element as HTMLEmbedElement);\n  }\n\n  if (element.tagName === \"FIGURE\") {\n    const parsedFigure = parseFigureElement(element, \"embed\");\n    if (!parsedFigure) {\n      return undefined;\n    }\n\n    const { targetElement, caption } = parsedFigure;\n\n    return {\n      ...parseEmbedElement(targetElement as HTMLEmbedElement),\n      caption,\n    };\n  }\n\n  return undefined;\n};\n\nexport const fileToExternalHTML = (\n  block: BlockFromConfig<typeof fileBlockConfig, any, any>\n) => {\n  if (!block.props.url) {\n    const div = document.createElement(\"p\");\n    div.textContent = \"Add file\";\n\n    return {\n      dom: div,\n    };\n  }\n\n  const fileSrcLink = document.createElement(\"a\");\n  fileSrcLink.href = block.props.url;\n  fileSrcLink.textContent = block.props.name || block.props.url;\n\n  if (block.props.caption) {\n    return createLinkWithCaption(fileSrcLink, block.props.caption);\n  }\n\n  return {\n    dom: fileSrcLink,\n  };\n};\n\nexport const FileBlock = createBlockSpec(fileBlockConfig, {\n  render: fileRender,\n  parse: fileParse,\n  toExternalHTML: fileToExternalHTML,\n});\n","export const parseImageElement = (imageElement: HTMLImageElement) => {\n  const url = imageElement.src || undefined;\n  const previewWidth = imageElement.width || undefined;\n\n  return { url, previewWidth };\n};\n","import type { BlockNoteEditor } from \"../../editor/BlockNoteEditor\";\nimport {\n  BlockFromConfig,\n  createBlockSpec,\n  FileBlockConfig,\n  Props,\n  PropSchema,\n} from \"../../schema\";\nimport { defaultProps } from \"../defaultProps\";\n\nimport {\n  createAddFileButton,\n  createDefaultFilePreview,\n  createFigureWithCaption,\n  createFileAndCaptionWrapper,\n  createLinkWithCaption,\n  createResizeHandlesWrapper,\n  parseFigureElement,\n} from \"../FileBlockContent/fileBlockHelpers\";\nimport { parseImageElement } from \"./imageBlockHelpers\";\n\nexport const imagePropSchema = {\n  textAlignment: defaultProps.textAlignment,\n  backgroundColor: defaultProps.backgroundColor,\n  // File name.\n  name: {\n    default: \"\" as const,\n  },\n  // File url.\n  url: {\n    default: \"\" as const,\n  },\n  // File caption.\n  caption: {\n    default: \"\" as const,\n  },\n\n  showPreview: {\n    default: true,\n  },\n  // File preview width in px.\n  previewWidth: {\n    default: 512,\n  },\n} satisfies PropSchema;\n\nexport const imageBlockConfig = {\n  type: \"image\" as const,\n  propSchema: imagePropSchema,\n  content: \"none\",\n  isFileBlock: true,\n  fileBlockAcceptMimeTypes: [\"image/*\"],\n} satisfies FileBlockConfig;\n\nexport const imageRender = (\n  block: BlockFromConfig<typeof imageBlockConfig, any, any>,\n  editor: BlockNoteEditor<any, any, any>\n) => {\n  const wrapper = document.createElement(\"div\");\n  wrapper.className = \"bn-file-block-content-wrapper\";\n\n  if (block.props.url === \"\") {\n    const fileBlockImageIcon = document.createElement(\"div\");\n    fileBlockImageIcon.innerHTML =\n      '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"currentColor\"><path d=\"M5 11.1005L7 9.1005L12.5 14.6005L16 11.1005L19 14.1005V5H5V11.1005ZM4 3H20C20.5523 3 21 3.44772 21 4V20C21 20.5523 20.5523 21 20 21H4C3.44772 21 3 20.5523 3 20V4C3 3.44772 3.44772 3 4 3ZM15.5 10C14.6716 10 14 9.32843 14 8.5C14 7.67157 14.6716 7 15.5 7C16.3284 7 17 7.67157 17 8.5C17 9.32843 16.3284 10 15.5 10Z\"></path></svg>';\n    const addImageButton = createAddFileButton(\n      block,\n      editor,\n      editor.dictionary.file_blocks.image.add_button_text,\n      fileBlockImageIcon.firstElementChild as HTMLElement\n    );\n    wrapper.appendChild(addImageButton.dom);\n\n    return {\n      dom: wrapper,\n      destroy: () => {\n        addImageButton?.destroy?.();\n      },\n    };\n  } else if (!block.props.showPreview) {\n    const file = createDefaultFilePreview(block).dom;\n    const element = createFileAndCaptionWrapper(block, file);\n\n    return {\n      dom: element.dom,\n    };\n  } else {\n    const image = document.createElement(\"img\");\n    image.className = \"bn-visual-media\";\n    editor.resolveFileUrl(block.props.url).then((downloadUrl) => {\n      image.src = downloadUrl;\n    });\n    image.alt = block.props.name || block.props.caption || \"BlockNote image\";\n    image.contentEditable = \"false\";\n    image.draggable = false;\n    image.width = Math.min(\n      block.props.previewWidth,\n      editor.domElement.firstElementChild!.clientWidth\n    );\n\n    const file = createResizeHandlesWrapper(\n      block,\n      editor,\n      image,\n      () => image.width,\n      (width) => (image.width = width)\n    );\n\n    const element = createFileAndCaptionWrapper(block, file.dom);\n    wrapper.appendChild(element.dom);\n\n    return {\n      dom: wrapper,\n      destroy: file.destroy,\n    };\n  }\n};\n\nexport const imageParse = (\n  element: HTMLElement\n): Partial<Props<typeof imageBlockConfig.propSchema>> | undefined => {\n  if (element.tagName === \"IMG\") {\n    return parseImageElement(element as HTMLImageElement);\n  }\n\n  if (element.tagName === \"FIGURE\") {\n    const parsedFigure = parseFigureElement(element, \"img\");\n    if (!parsedFigure) {\n      return undefined;\n    }\n\n    const { targetElement, caption } = parsedFigure;\n\n    return {\n      ...parseImageElement(targetElement as HTMLImageElement),\n      caption,\n    };\n  }\n\n  return undefined;\n};\n\nexport const imageToExternalHTML = (\n  block: BlockFromConfig<typeof imageBlockConfig, any, any>\n) => {\n  if (!block.props.url) {\n    const div = document.createElement(\"p\");\n    div.textContent = \"Add image\";\n\n    return {\n      dom: div,\n    };\n  }\n\n  let image;\n  if (block.props.showPreview) {\n    image = document.createElement(\"img\");\n    image.src = block.props.url;\n    image.alt = block.props.name || block.props.caption || \"BlockNote image\";\n    image.width = block.props.previewWidth;\n  } else {\n    image = document.createElement(\"a\");\n    image.href = block.props.url;\n    image.textContent = block.props.name || block.props.url;\n  }\n\n  if (block.props.caption) {\n    if (block.props.showPreview) {\n      return createFigureWithCaption(image, block.props.caption);\n    } else {\n      return createLinkWithCaption(image, block.props.caption);\n    }\n  }\n\n  return {\n    dom: image,\n  };\n};\n\nexport const ImageBlock = createBlockSpec(imageBlockConfig, {\n  render: imageRender,\n  parse: imageParse,\n  toExternalHTML: imageToExternalHTML,\n});\n","export const parseVideoElement = (videoElement: HTMLVideoElement) => {\n  const url = videoElement.src || undefined;\n  const previewWidth = videoElement.width || undefined;\n\n  return { url, previewWidth };\n};\n","import type { BlockNoteEditor } from \"../../editor/BlockNoteEditor\";\nimport {\n  BlockFromConfig,\n  createBlockSpec,\n  FileBlockConfig,\n  Props,\n  PropSchema,\n} from \"../../schema\";\nimport { defaultProps } from \"../defaultProps\";\n\nimport {\n  createAddFileButton,\n  createDefaultFilePreview,\n  createFigureWithCaption,\n  createFileAndCaptionWrapper,\n  createLinkWithCaption,\n  createResizeHandlesWrapper,\n  parseFigureElement,\n} from \"../FileBlockContent/fileBlockHelpers\";\nimport { parseVideoElement } from \"./videoBlockHelpers\";\n\nexport const videoPropSchema = {\n  textAlignment: defaultProps.textAlignment,\n  backgroundColor: defaultProps.backgroundColor,\n  // File name.\n  name: {\n    default: \"\" as const,\n  },\n  // File url.\n  url: {\n    default: \"\" as const,\n  },\n  // File caption.\n  caption: {\n    default: \"\" as const,\n  },\n\n  showPreview: {\n    default: true,\n  },\n  // File preview width in px.\n  previewWidth: {\n    default: 512,\n  },\n} satisfies PropSchema;\n\nexport const videoBlockConfig = {\n  type: \"video\" as const,\n  propSchema: videoPropSchema,\n  content: \"none\",\n  isFileBlock: true,\n  fileBlockAcceptMimeTypes: [\"video/*\"],\n} satisfies FileBlockConfig;\n\nexport const videoRender = (\n  block: BlockFromConfig<typeof videoBlockConfig, any, any>,\n  editor: BlockNoteEditor<any, any, any>\n) => {\n  const wrapper = document.createElement(\"div\");\n  wrapper.className = \"bn-file-block-content-wrapper\";\n\n  if (block.props.url === \"\") {\n    const fileBlockVideoIcon = document.createElement(\"div\");\n    fileBlockVideoIcon.innerHTML =\n      '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"currentColor\"><path d=\"M2 3.9934C2 3.44476 2.45531 3 2.9918 3H21.0082C21.556 3 22 3.44495 22 3.9934V20.0066C22 20.5552 21.5447 21 21.0082 21H2.9918C2.44405 21 2 20.5551 2 20.0066V3.9934ZM8 5V19H16V5H8ZM4 5V7H6V5H4ZM18 5V7H20V5H18ZM4 9V11H6V9H4ZM18 9V11H20V9H18ZM4 13V15H6V13H4ZM18 13V15H20V13H18ZM4 17V19H6V17H4ZM18 17V19H20V17H18Z\"></path></svg>';\n    const addVideoButton = createAddFileButton(\n      block,\n      editor,\n      editor.dictionary.file_blocks.video.add_button_text,\n      fileBlockVideoIcon.firstElementChild as HTMLElement\n    );\n    wrapper.appendChild(addVideoButton.dom);\n\n    return {\n      dom: wrapper,\n      destroy: () => {\n        addVideoButton?.destroy?.();\n      },\n    };\n  } else if (!block.props.showPreview) {\n    const file = createDefaultFilePreview(block).dom;\n    const element = createFileAndCaptionWrapper(block, file);\n\n    return {\n      dom: element.dom,\n    };\n  } else {\n    const video = document.createElement(\"video\");\n    video.className = \"bn-visual-media\";\n    video.src = block.props.url;\n    video.controls = true;\n    video.contentEditable = \"false\";\n    video.draggable = false;\n    video.width = Math.min(\n      block.props.previewWidth,\n      editor.domElement.firstElementChild!.clientWidth\n    );\n\n    const file = createResizeHandlesWrapper(\n      block,\n      editor,\n      video,\n      () => video.width,\n      (width) => (video.width = width)\n    );\n\n    const element = createFileAndCaptionWrapper(block, file.dom);\n    wrapper.appendChild(element.dom);\n\n    return {\n      dom: wrapper,\n      destroy: file.destroy,\n    };\n  }\n};\n\nexport const videoParse = (\n  element: HTMLElement\n): Partial<Props<typeof videoBlockConfig.propSchema>> | undefined => {\n  if (element.tagName === \"VIDEO\") {\n    return parseVideoElement(element as HTMLVideoElement);\n  }\n\n  if (element.tagName === \"FIGURE\") {\n    const parsedFigure = parseFigureElement(element, \"video\");\n    if (!parsedFigure) {\n      return undefined;\n    }\n\n    const { targetElement, caption } = parsedFigure;\n\n    return {\n      ...parseVideoElement(targetElement as HTMLVideoElement),\n      caption,\n    };\n  }\n\n  return undefined;\n};\n\nexport const videoToExternalHTML = (\n  block: BlockFromConfig<typeof videoBlockConfig, any, any>\n) => {\n  if (!block.props.url) {\n    const div = document.createElement(\"p\");\n    div.textContent = \"Add video\";\n\n    return {\n      dom: div,\n    };\n  }\n\n  let video;\n  if (block.props.showPreview) {\n    video = document.createElement(\"video\");\n    video.src = block.props.url;\n    video.width = block.props.previewWidth;\n  } else {\n    video = document.createElement(\"a\");\n    video.href = block.props.url;\n    video.textContent = block.props.name || block.props.url;\n  }\n\n  if (block.props.caption) {\n    if (block.props.showPreview) {\n      return createFigureWithCaption(video, block.props.caption);\n    } else {\n      return createLinkWithCaption(video, block.props.caption);\n    }\n  }\n\n  return {\n    dom: video,\n  };\n};\n\nexport const VideoBlock = createBlockSpec(videoBlockConfig, {\n  render: videoRender,\n  parse: videoParse,\n  toExternalHTML: videoToExternalHTML,\n});\n","export const parseAudioElement = (audioElement: HTMLAudioElement) => {\n  const url = audioElement.src || undefined;\n\n  return { url };\n};\n","import type { BlockNoteEditor } from \"../../editor/BlockNoteEditor\";\nimport {\n  BlockFromConfig,\n  createBlockSpec,\n  FileBlockConfig,\n  Props,\n  PropSchema,\n} from \"../../schema\";\nimport { defaultProps } from \"../defaultProps\";\n\nimport {\n  createAddFileButton,\n  createDefaultFilePreview,\n  createFigureWithCaption,\n  createFileAndCaptionWrapper,\n  createLinkWithCaption,\n  parseFigureElement,\n} from \"../FileBlockContent/fileBlockHelpers\";\nimport { parseAudioElement } from \"./audioBlockHelpers\";\n\nexport const audioPropSchema = {\n  backgroundColor: defaultProps.backgroundColor,\n  // File name.\n  name: {\n    default: \"\" as const,\n  },\n  // File url.\n  url: {\n    default: \"\" as const,\n  },\n  // File caption.\n  caption: {\n    default: \"\" as const,\n  },\n\n  showPreview: {\n    default: true,\n  },\n} satisfies PropSchema;\n\nexport const audioBlockConfig = {\n  type: \"audio\" as const,\n  propSchema: audioPropSchema,\n  content: \"none\",\n  isFileBlock: true,\n  fileBlockAcceptMimeTypes: [\"audio/*\"],\n} satisfies FileBlockConfig;\n\nexport const audioRender = (\n  block: BlockFromConfig<typeof audioBlockConfig, any, any>,\n  editor: BlockNoteEditor<any, any, any>\n) => {\n  const wrapper = document.createElement(\"div\");\n  wrapper.className = \"bn-file-block-content-wrapper\";\n\n  if (block.props.url === \"\") {\n    const fileBlockAudioIcon = document.createElement(\"div\");\n    fileBlockAudioIcon.innerHTML =\n      '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"currentColor\"><path d=\"M2 16.0001H5.88889L11.1834 20.3319C11.2727 20.405 11.3846 20.4449 11.5 20.4449C11.7761 20.4449 12 20.2211 12 19.9449V4.05519C12 3.93977 11.9601 3.8279 11.887 3.73857C11.7121 3.52485 11.3971 3.49335 11.1834 3.66821L5.88889 8.00007H2C1.44772 8.00007 1 8.44778 1 9.00007V15.0001C1 15.5524 1.44772 16.0001 2 16.0001ZM23 12C23 15.292 21.5539 18.2463 19.2622 20.2622L17.8445 18.8444C19.7758 17.1937 21 14.7398 21 12C21 9.26016 19.7758 6.80629 17.8445 5.15557L19.2622 3.73779C21.5539 5.75368 23 8.70795 23 12ZM18 12C18 10.0883 17.106 8.38548 15.7133 7.28673L14.2842 8.71584C15.3213 9.43855 16 10.64 16 12C16 13.36 15.3213 14.5614 14.2842 15.2841L15.7133 16.7132C17.106 15.6145 18 13.9116 18 12Z\"></path></svg>';\n    const addAudioButton = createAddFileButton(\n      block,\n      editor,\n      editor.dictionary.file_blocks.audio.add_button_text,\n      fileBlockAudioIcon.firstElementChild as HTMLElement\n    );\n    wrapper.appendChild(addAudioButton.dom);\n\n    return {\n      dom: wrapper,\n      destroy: () => {\n        addAudioButton?.destroy?.();\n      },\n    };\n  } else if (!block.props.showPreview) {\n    const file = createDefaultFilePreview(block).dom;\n    const element = createFileAndCaptionWrapper(block, file);\n\n    return {\n      dom: element.dom,\n    };\n  } else {\n    const audio = document.createElement(\"audio\");\n    audio.className = \"bn-audio\";\n    editor.resolveFileUrl(block.props.url).then((downloadUrl) => {\n      audio.src = downloadUrl;\n    });\n    audio.controls = true;\n    audio.contentEditable = \"false\";\n    audio.draggable = false;\n\n    const element = createFileAndCaptionWrapper(block, audio);\n    wrapper.appendChild(element.dom);\n\n    return {\n      dom: wrapper,\n    };\n  }\n};\n\nexport const audioParse = (\n  element: HTMLElement\n): Partial<Props<typeof audioBlockConfig.propSchema>> | undefined => {\n  if (element.tagName === \"AUDIO\") {\n    return parseAudioElement(element as HTMLAudioElement);\n  }\n\n  if (element.tagName === \"FIGURE\") {\n    const parsedFigure = parseFigureElement(element, \"audio\");\n    if (!parsedFigure) {\n      return undefined;\n    }\n\n    const { targetElement, caption } = parsedFigure;\n\n    return {\n      ...parseAudioElement(targetElement as HTMLAudioElement),\n      caption,\n    };\n  }\n\n  return undefined;\n};\n\nexport const audioToExternalHTML = (\n  block: BlockFromConfig<typeof audioBlockConfig, any, any>\n) => {\n  if (!block.props.url) {\n    const div = document.createElement(\"p\");\n    div.textContent = \"Add audio\";\n\n    return {\n      dom: div,\n    };\n  }\n\n  let audio;\n  if (block.props.showPreview) {\n    audio = document.createElement(\"audio\");\n    audio.src = block.props.url;\n  } else {\n    audio = document.createElement(\"a\");\n    audio.href = block.props.url;\n    audio.textContent = block.props.name || block.props.url;\n  }\n\n  if (block.props.caption) {\n    if (block.props.showPreview) {\n      return createFigureWithCaption(audio, block.props.caption);\n    } else {\n      return createLinkWithCaption(audio, block.props.caption);\n    }\n  }\n\n  return {\n    dom: audio,\n  };\n};\n\nexport const AudioBlock = createBlockSpec(audioBlockConfig, {\n  render: audioRender,\n  parse: audioParse,\n  toExternalHTML: audioToExternalHTML,\n});\n","/**\n * Uploads a file to tmpfiles.org and returns the URL to the uploaded file.\n *\n * @warning This function should only be used for development purposes, replace with your own backend!\n */\nexport const uploadToTmpFilesDotOrg_DEV_ONLY = async (\n  file: File\n): Promise<string> => {\n  const body = new FormData();\n  body.append(\"file\", file);\n\n  const ret = await fetch(\"https://tmpfiles.org/api/v1/upload\", {\n    method: \"POST\",\n    body: body,\n  });\n  return (await ret.json()).data.url.replace(\n    \"tmpfiles.org/\",\n    \"tmpfiles.org/dl/\"\n  );\n};\n","import { Mark } from \"@tiptap/core\";\nimport { createStyleSpecFromTipTapMark } from \"../../schema\";\n\nconst BackgroundColorMark = Mark.create({\n  name: \"backgroundColor\",\n\n  addAttributes() {\n    return {\n      stringValue: {\n        default: undefined,\n        parseHTML: (element) => element.getAttribute(\"data-background-color\"),\n        renderHTML: (attributes) => ({\n          \"data-background-color\": attributes.stringValue,\n        }),\n      },\n    };\n  },\n\n  parseHTML() {\n    return [\n      {\n        tag: \"span\",\n        getAttrs: (element) => {\n          if (typeof element === \"string\") {\n            return false;\n          }\n\n          if (element.hasAttribute(\"data-background-color\")) {\n            return {\n              stringValue: element.getAttribute(\"data-background-color\"),\n            };\n          }\n\n          return false;\n        },\n      },\n    ];\n  },\n\n  renderHTML({ HTMLAttributes }) {\n    return [\"span\", HTMLAttributes, 0];\n  },\n});\n\nexport const BackgroundColor = createStyleSpecFromTipTapMark(\n  BackgroundColorMark,\n  \"string\"\n);\n","import { Mark } from \"@tiptap/core\";\nimport { createStyleSpecFromTipTapMark } from \"../../schema\";\n\nconst TextColorMark = Mark.create({\n  name: \"textColor\",\n\n  addAttributes() {\n    return {\n      stringValue: {\n        default: undefined,\n        parseHTML: (element) => element.getAttribute(\"data-text-color\"),\n        renderHTML: (attributes) => ({\n          \"data-text-color\": attributes.stringValue,\n        }),\n      },\n    };\n  },\n\n  parseHTML() {\n    return [\n      {\n        tag: \"span\",\n        getAttrs: (element) => {\n          if (typeof element === \"string\") {\n            return false;\n          }\n\n          if (element.hasAttribute(\"data-text-color\")) {\n            return { stringValue: element.getAttribute(\"data-text-color\") };\n          }\n\n          return false;\n        },\n      },\n    ];\n  },\n\n  renderHTML({ HTMLAttributes }) {\n    return [\"span\", HTMLAttributes, 0];\n  },\n});\n\nexport const TextColor = createStyleSpecFromTipTapMark(TextColorMark, \"string\");\n","import { Editor } from \"@tiptap/core\";\nimport { getBlockInfoFromPos } from \"./getBlockInfoFromPos\";\n\n// Used to get the content type of the block that the text cursor is in. This is\n// a band-aid fix to prevent input rules and keyboard shortcuts from triggering\n// in tables, but really those should be extended to work with block selections.\nexport const getCurrentBlockContentType = (editor: Editor) => {\n  const { contentType } = getBlockInfoFromPos(\n    editor.state.doc,\n    editor.state.selection.from\n  );\n\n  return contentType.spec.content;\n};\n","import { InputRule } from \"@tiptap/core\";\nimport {\n  PropSchema,\n  createBlockSpecFromStronglyTypedTiptapNode,\n  createStronglyTypedTiptapNode,\n} from \"../../schema\";\nimport { createDefaultBlockDOMOutputSpec } from \"../defaultBlockHelpers\";\nimport { defaultProps } from \"../defaultProps\";\nimport { getCurrentBlockContentType } from \"../../api/getCurrentBlockContentType\";\n\nexport const headingPropSchema = {\n  ...defaultProps,\n  level: { default: 1, values: [1, 2, 3] as const },\n} satisfies PropSchema;\n\nconst HeadingBlockContent = createStronglyTypedTiptapNode({\n  name: \"heading\",\n  content: \"inline*\",\n  group: \"blockContent\",\n  addAttributes() {\n    return {\n      level: {\n        default: 1,\n        // instead of \"level\" attributes, use \"data-level\"\n        parseHTML: (element) => {\n          const attr = element.getAttribute(\"data-level\")!;\n          const parsed = parseInt(attr);\n          if (isFinite(parsed)) {\n            return parsed;\n          }\n          return undefined;\n        },\n        renderHTML: (attributes) => {\n          return {\n            \"data-level\": (attributes.level as number).toString(),\n          };\n        },\n      },\n    };\n  },\n\n  addInputRules() {\n    return [\n      ...[1, 2, 3].map((level) => {\n        // Creates a heading of appropriate level when starting with \"#\", \"##\", or \"###\".\n        return new InputRule({\n          find: new RegExp(`^(#{${level}})\\\\s$`),\n          handler: ({ state, chain, range }) => {\n            if (getCurrentBlockContentType(this.editor) !== \"inline*\") {\n              return;\n            }\n\n            chain()\n              .BNUpdateBlock(state.selection.from, {\n                type: \"heading\",\n                props: {\n                  level: level as any,\n                },\n              })\n              // Removes the \"#\" character(s) used to set the heading.\n              .deleteRange({ from: range.from, to: range.to });\n          },\n        });\n      }),\n    ];\n  },\n\n  addKeyboardShortcuts() {\n    return {\n      \"Mod-Alt-1\": () => {\n        if (getCurrentBlockContentType(this.editor) !== \"inline*\") {\n          return true;\n        }\n\n        return this.editor.commands.BNUpdateBlock(\n          this.editor.state.selection.anchor,\n          {\n            type: \"heading\",\n            props: {\n              level: 1 as any,\n            },\n          }\n        );\n      },\n      \"Mod-Alt-2\": () => {\n        if (getCurrentBlockContentType(this.editor) !== \"inline*\") {\n          return true;\n        }\n\n        return this.editor.commands.BNUpdateBlock(\n          this.editor.state.selection.anchor,\n          {\n            type: \"heading\",\n            props: {\n              level: 2 as any,\n            },\n          }\n        );\n      },\n      \"Mod-Alt-3\": () => {\n        if (getCurrentBlockContentType(this.editor) !== \"inline*\") {\n          return true;\n        }\n\n        return this.editor.commands.BNUpdateBlock(\n          this.editor.state.selection.anchor,\n          {\n            type: \"heading\",\n            props: {\n              level: 3 as any,\n            },\n          }\n        );\n      },\n    };\n  },\n  parseHTML() {\n    return [\n      {\n        tag: \"div[data-content-type=\" + this.name + \"]\",\n        getAttrs: (element) => {\n          if (typeof element === \"string\") {\n            return false;\n          }\n\n          return {\n            level: element.getAttribute(\"data-level\"),\n          };\n        },\n      },\n      {\n        tag: \"h1\",\n        attrs: { level: 1 },\n        node: \"heading\",\n      },\n      {\n        tag: \"h2\",\n        attrs: { level: 2 },\n        node: \"heading\",\n      },\n      {\n        tag: \"h3\",\n        attrs: { level: 3 },\n        node: \"heading\",\n      },\n    ];\n  },\n\n  renderHTML({ node, HTMLAttributes }) {\n    return createDefaultBlockDOMOutputSpec(\n      this.name,\n      `h${node.attrs.level}`,\n      {\n        ...(this.options.domAttributes?.blockContent || {}),\n        ...HTMLAttributes,\n      },\n      this.options.domAttributes?.inlineContent || {}\n    );\n  },\n});\n\nexport const Heading = createBlockSpecFromStronglyTypedTiptapNode(\n  HeadingBlockContent,\n  headingPropSchema\n);\n","import { Editor } from \"@tiptap/core\";\nimport { getBlockInfoFromPos } from \"../../api/getBlockInfoFromPos\";\n\nexport const handleEnter = (editor: Editor) => {\n  const { contentNode, contentType } = getBlockInfoFromPos(\n    editor.state.doc,\n    editor.state.selection.from\n  )!;\n\n  const selectionEmpty =\n    editor.state.selection.anchor === editor.state.selection.head;\n\n  if (\n    !(\n      contentType.name === \"bulletListItem\" ||\n      contentType.name === \"numberedListItem\" ||\n      contentType.name === \"checkListItem\"\n    ) ||\n    !selectionEmpty\n  ) {\n    return false;\n  }\n\n  return editor.commands.first(({ state, chain, commands }) => [\n    () =>\n      // Changes list item block to a paragraph block if the content is empty.\n      commands.command(() => {\n        if (contentNode.childCount === 0) {\n          return commands.BNUpdateBlock(state.selection.from, {\n            type: \"paragraph\",\n            props: {},\n          });\n        }\n\n        return false;\n      }),\n\n    () =>\n      // Splits the current block, moving content inside that's after the cursor\n      // to a new block of the same type below.\n      commands.command(() => {\n        if (contentNode.childCount > 0) {\n          chain()\n            .deleteSelection()\n            .BNSplitBlock(state.selection.from, true)\n            .run();\n\n          return true;\n        }\n\n        return false;\n      }),\n  ]);\n};\n","import { InputRule } from \"@tiptap/core\";\nimport {\n  PropSchema,\n  createBlockSpecFromStronglyTypedTiptapNode,\n  createStronglyTypedTiptapNode,\n} from \"../../../schema\";\nimport { createDefaultBlockDOMOutputSpec } from \"../../defaultBlockHelpers\";\nimport { defaultProps } from \"../../defaultProps\";\nimport { handleEnter } from \"../ListItemKeyboardShortcuts\";\nimport { getCurrentBlockContentType } from \"../../../api/getCurrentBlockContentType\";\n\nexport const bulletListItemPropSchema = {\n  ...defaultProps,\n} satisfies PropSchema;\n\nconst BulletListItemBlockContent = createStronglyTypedTiptapNode({\n  name: \"bulletListItem\",\n  content: \"inline*\",\n  group: \"blockContent\",\n  // This is to make sure that check list parse rules run before, since they\n  // both parse `li` elements but check lists are more specific.\n  priority: 90,\n  addInputRules() {\n    return [\n      // Creates an unordered list when starting with \"-\", \"+\", or \"*\".\n      new InputRule({\n        find: new RegExp(`^[-+*]\\\\s$`),\n        handler: ({ state, chain, range }) => {\n          if (getCurrentBlockContentType(this.editor) !== \"inline*\") {\n            return;\n          }\n\n          chain()\n            .BNUpdateBlock(state.selection.from, {\n              type: \"bulletListItem\",\n              props: {},\n            })\n            // Removes the \"-\", \"+\", or \"*\" character used to set the list.\n            .deleteRange({ from: range.from, to: range.to });\n        },\n      }),\n    ];\n  },\n\n  addKeyboardShortcuts() {\n    return {\n      Enter: () => handleEnter(this.editor),\n      \"Mod-Shift-8\": () => {\n        if (getCurrentBlockContentType(this.editor) !== \"inline*\") {\n          return true;\n        }\n\n        return this.editor.commands.BNUpdateBlock(\n          this.editor.state.selection.anchor,\n          {\n            type: \"bulletListItem\",\n            props: {},\n          }\n        );\n      },\n    };\n  },\n\n  parseHTML() {\n    return [\n      // Case for regular HTML list structure.\n      {\n        tag: \"div[data-content-type=\" + this.name + \"]\", // TODO: remove if we can't come up with test case that needs this\n      },\n      {\n        tag: \"li\",\n        getAttrs: (element) => {\n          if (typeof element === \"string\") {\n            return false;\n          }\n\n          const parent = element.parentElement;\n\n          if (parent === null) {\n            return false;\n          }\n\n          if (\n            parent.tagName === \"UL\" ||\n            (parent.tagName === \"DIV\" && parent.parentElement!.tagName === \"UL\")\n          ) {\n            return {};\n          }\n\n          return false;\n        },\n        node: \"bulletListItem\",\n      },\n      // Case for BlockNote list structure.\n      {\n        tag: \"p\",\n        getAttrs: (element) => {\n          if (typeof element === \"string\") {\n            return false;\n          }\n\n          const parent = element.parentElement;\n\n          if (parent === null) {\n            return false;\n          }\n\n          if (parent.getAttribute(\"data-content-type\") === \"bulletListItem\") {\n            return {};\n          }\n\n          return false;\n        },\n        priority: 300,\n        node: \"bulletListItem\",\n      },\n    ];\n  },\n\n  renderHTML({ HTMLAttributes }) {\n    return createDefaultBlockDOMOutputSpec(\n      this.name,\n      // We use a <p> tag, because for <li> tags we'd need a <ul> element to put\n      // them in to be semantically correct, which we can't have due to the\n      // schema.\n      \"p\",\n      {\n        ...(this.options.domAttributes?.blockContent || {}),\n        ...HTMLAttributes,\n      },\n      this.options.domAttributes?.inlineContent || {}\n    );\n  },\n});\n\nexport const BulletListItem = createBlockSpecFromStronglyTypedTiptapNode(\n  BulletListItemBlockContent,\n  bulletListItemPropSchema\n);\n","import { Plugin, PluginKey } from \"prosemirror-state\";\nimport { getBlockInfoFromPos } from \"../../../api/getBlockInfoFromPos\";\n\n// ProseMirror Plugin which automatically assigns indices to ordered list items per nesting level.\nconst PLUGIN_KEY = new PluginKey(`numbered-list-indexing`);\nexport const NumberedListIndexingPlugin = () => {\n  return new Plugin({\n    key: PLUGIN_KEY,\n    appendTransaction: (_transactions, _oldState, newState) => {\n      const tr = newState.tr;\n      tr.setMeta(\"numberedListIndexing\", true);\n\n      let modified = false;\n\n      // Traverses each node the doc using DFS, so blocks which are on the same nesting level will be traversed in the\n      // same order they appear. This means the index of each list item block can be calculated by incrementing the\n      // index of the previous list item block.\n      newState.doc.descendants((node, pos) => {\n        if (\n          node.type.name === \"blockContainer\" &&\n          node.firstChild!.type.name === \"numberedListItem\"\n        ) {\n          let newIndex = \"1\";\n          const isFirstBlockInDoc = pos === 1;\n\n          const blockInfo = getBlockInfoFromPos(tr.doc, pos + 1)!;\n          if (blockInfo === undefined) {\n            return;\n          }\n\n          // Checks if this block is the start of a new ordered list, i.e. if it's the first block in the document, the\n          // first block in its nesting level, or the previous block is not an ordered list item.\n          if (!isFirstBlockInDoc) {\n            const prevBlockInfo = getBlockInfoFromPos(tr.doc, pos - 2)!;\n            if (prevBlockInfo === undefined) {\n              return;\n            }\n\n            const isFirstBlockInNestingLevel =\n              blockInfo.depth !== prevBlockInfo.depth;\n\n            if (!isFirstBlockInNestingLevel) {\n              const prevBlockContentNode = prevBlockInfo.contentNode;\n              const prevBlockContentType = prevBlockInfo.contentType;\n\n              const isPrevBlockOrderedListItem =\n                prevBlockContentType.name === \"numberedListItem\";\n\n              if (isPrevBlockOrderedListItem) {\n                const prevBlockIndex = prevBlockContentNode.attrs[\"index\"];\n\n                newIndex = (parseInt(prevBlockIndex) + 1).toString();\n              }\n            }\n          }\n\n          const contentNode = blockInfo.contentNode;\n          const index = contentNode.attrs[\"index\"];\n\n          if (index !== newIndex) {\n            modified = true;\n\n            tr.setNodeMarkup(pos + 1, undefined, {\n              index: newIndex,\n            });\n          }\n        }\n      });\n\n      return modified ? tr : null;\n    },\n  });\n};\n","import { InputRule } from \"@tiptap/core\";\nimport {\n  PropSchema,\n  createBlockSpecFromStronglyTypedTiptapNode,\n  createStronglyTypedTiptapNode,\n} from \"../../../schema\";\nimport { createDefaultBlockDOMOutputSpec } from \"../../defaultBlockHelpers\";\nimport { defaultProps } from \"../../defaultProps\";\nimport { handleEnter } from \"../ListItemKeyboardShortcuts\";\nimport { NumberedListIndexingPlugin } from \"./NumberedListIndexingPlugin\";\nimport { getCurrentBlockContentType } from \"../../../api/getCurrentBlockContentType\";\n\nexport const numberedListItemPropSchema = {\n  ...defaultProps,\n} satisfies PropSchema;\n\nconst NumberedListItemBlockContent = createStronglyTypedTiptapNode({\n  name: \"numberedListItem\",\n  content: \"inline*\",\n  group: \"blockContent\",\n  priority: 90,\n  addAttributes() {\n    return {\n      index: {\n        default: null,\n        parseHTML: (element) => element.getAttribute(\"data-index\"),\n        renderHTML: (attributes) => {\n          return {\n            \"data-index\": attributes.index,\n          };\n        },\n      },\n    };\n  },\n\n  addInputRules() {\n    return [\n      // Creates an ordered list when starting with \"1.\".\n      new InputRule({\n        find: new RegExp(`^1\\\\.\\\\s$`),\n        handler: ({ state, chain, range }) => {\n          if (getCurrentBlockContentType(this.editor) !== \"inline*\") {\n            return;\n          }\n\n          chain()\n            .BNUpdateBlock(state.selection.from, {\n              type: \"numberedListItem\",\n              props: {},\n            })\n            // Removes the \"1.\" characters used to set the list.\n            .deleteRange({ from: range.from, to: range.to });\n        },\n      }),\n    ];\n  },\n\n  addKeyboardShortcuts() {\n    return {\n      Enter: () => handleEnter(this.editor),\n      \"Mod-Shift-7\": () => {\n        if (getCurrentBlockContentType(this.editor) !== \"inline*\") {\n          return true;\n        }\n\n        return this.editor.commands.BNUpdateBlock(\n          this.editor.state.selection.anchor,\n          {\n            type: \"numberedListItem\",\n            props: {},\n          }\n        );\n      },\n    };\n  },\n\n  addProseMirrorPlugins() {\n    return [NumberedListIndexingPlugin()];\n  },\n\n  parseHTML() {\n    return [\n      {\n        tag: \"div[data-content-type=\" + this.name + \"]\", // TODO: remove if we can't come up with test case that needs this\n      },\n      // Case for regular HTML list structure.\n      // (e.g.: when pasting from other apps)\n      {\n        tag: \"li\",\n        getAttrs: (element) => {\n          if (typeof element === \"string\") {\n            return false;\n          }\n\n          const parent = element.parentElement;\n\n          if (parent === null) {\n            return false;\n          }\n\n          if (\n            parent.tagName === \"OL\" ||\n            (parent.tagName === \"DIV\" && parent.parentElement!.tagName === \"OL\")\n          ) {\n            return {};\n          }\n\n          return false;\n        },\n        node: \"numberedListItem\",\n      },\n      // Case for BlockNote list structure.\n      // (e.g.: when pasting from blocknote)\n      {\n        tag: \"p\",\n        getAttrs: (element) => {\n          if (typeof element === \"string\") {\n            return false;\n          }\n\n          const parent = element.parentElement;\n\n          if (parent === null) {\n            return false;\n          }\n\n          if (parent.getAttribute(\"data-content-type\") === \"numberedListItem\") {\n            return {};\n          }\n\n          return false;\n        },\n        priority: 300,\n        node: \"numberedListItem\",\n      },\n    ];\n  },\n\n  renderHTML({ HTMLAttributes }) {\n    return createDefaultBlockDOMOutputSpec(\n      this.name,\n      // We use a <p> tag, because for <li> tags we'd need an <ol> element to\n      // put them in to be semantically correct, which we can't have due to the\n      // schema.\n      \"p\",\n      {\n        ...(this.options.domAttributes?.blockContent || {}),\n        ...HTMLAttributes,\n      },\n      this.options.domAttributes?.inlineContent || {}\n    );\n  },\n});\n\nexport const NumberedListItem = createBlockSpecFromStronglyTypedTiptapNode(\n  NumberedListItemBlockContent,\n  numberedListItemPropSchema\n);\n","import { InputRule } from \"@tiptap/core\";\nimport {\n  PropSchema,\n  createBlockSpecFromStronglyTypedTiptapNode,\n  createStronglyTypedTiptapNode,\n} from \"../../../schema\";\nimport { createDefaultBlockDOMOutputSpec } from \"../../defaultBlockHelpers\";\nimport { defaultProps } from \"../../defaultProps\";\nimport { handleEnter } from \"../ListItemKeyboardShortcuts\";\nimport { getCurrentBlockContentType } from \"../../../api/getCurrentBlockContentType\";\n\nexport const checkListItemPropSchema = {\n  ...defaultProps,\n  checked: {\n    default: false,\n  },\n} satisfies PropSchema;\n\nconst checkListItemBlockContent = createStronglyTypedTiptapNode({\n  name: \"checkListItem\",\n  content: \"inline*\",\n  group: \"blockContent\",\n  addAttributes() {\n    return {\n      checked: {\n        default: false,\n        // instead of \"checked\" attributes, use \"data-checked\"\n        parseHTML: (element) =>\n          element.getAttribute(\"data-checked\") === \"true\" || undefined,\n        renderHTML: (attributes) => {\n          return attributes.checked\n            ? {\n                \"data-checked\": (attributes.checked as boolean).toString(),\n              }\n            : {};\n        },\n      },\n    };\n  },\n\n  addInputRules() {\n    return [\n      // Creates a checklist when starting with \"[]\" or \"[X]\".\n      new InputRule({\n        find: new RegExp(`\\\\[\\\\s*\\\\]\\\\s$`),\n        handler: ({ state, chain, range }) => {\n          if (getCurrentBlockContentType(this.editor) !== \"inline*\") {\n            return;\n          }\n\n          chain()\n            .BNUpdateBlock(state.selection.from, {\n              type: \"checkListItem\",\n              props: {\n                checked: false as any,\n              },\n            })\n            // Removes the characters used to set the list.\n            .deleteRange({ from: range.from, to: range.to });\n        },\n      }),\n      new InputRule({\n        find: new RegExp(`\\\\[[Xx]\\\\]\\\\s$`),\n        handler: ({ state, chain, range }) => {\n          if (getCurrentBlockContentType(this.editor) !== \"inline*\") {\n            return;\n          }\n\n          chain()\n            .BNUpdateBlock(state.selection.from, {\n              type: \"checkListItem\",\n              props: {\n                checked: true as any,\n              },\n            })\n            // Removes the characters used to set the list.\n            .deleteRange({ from: range.from, to: range.to });\n        },\n      }),\n    ];\n  },\n\n  addKeyboardShortcuts() {\n    return {\n      Enter: () => handleEnter(this.editor),\n      \"Mod-Shift-9\": () => {\n        if (getCurrentBlockContentType(this.editor) !== \"inline*\") {\n          return true;\n        }\n\n        return this.editor.commands.BNUpdateBlock(\n          this.editor.state.selection.anchor,\n          {\n            type: \"checkListItem\",\n            props: {},\n          }\n        );\n      },\n    };\n  },\n\n  parseHTML() {\n    return [\n      {\n        tag: \"div[data-content-type=\" + this.name + \"]\", // TODO: remove if we can't come up with test case that needs this\n      },\n      // Checkbox only.\n      {\n        tag: \"input\",\n        getAttrs: (element) => {\n          if (typeof element === \"string\") {\n            return false;\n          }\n\n          if ((element as HTMLInputElement).type === \"checkbox\") {\n            return { checked: (element as HTMLInputElement).checked };\n          }\n\n          return false;\n        },\n        node: \"checkListItem\",\n      },\n      // Container element for checkbox + label.\n      {\n        tag: \"li\",\n        getAttrs: (element) => {\n          if (typeof element === \"string\") {\n            return false;\n          }\n\n          const parent = element.parentElement;\n\n          if (parent === null) {\n            return false;\n          }\n\n          if (\n            parent.tagName === \"UL\" ||\n            (parent.tagName === \"DIV\" && parent.parentElement!.tagName === \"UL\")\n          ) {\n            const checkbox =\n              (element.querySelector(\n                \"input[type=checkbox]\"\n              ) as HTMLInputElement) || null;\n\n            if (checkbox === null) {\n              return false;\n            }\n\n            return { checked: checkbox.checked };\n          }\n\n          return false;\n        },\n        node: \"checkListItem\",\n      },\n    ];\n  },\n\n  // Since there is no HTML checklist element, there isn't really any\n  // standardization for what checklists should look like in the DOM. GDocs'\n  // and Notion's aren't cross compatible, for example. This implementation\n  // has a semantically correct DOM structure (though missing a label for the\n  // checkbox) which is also converted correctly to Markdown by remark.\n  renderHTML({ node, HTMLAttributes }) {\n    const checkbox = document.createElement(\"input\");\n    checkbox.type = \"checkbox\";\n    checkbox.checked = node.attrs.checked;\n    if (node.attrs.checked) {\n      checkbox.setAttribute(\"checked\", \"\");\n    }\n\n    const { dom, contentDOM } = createDefaultBlockDOMOutputSpec(\n      this.name,\n      \"p\",\n      {\n        ...(this.options.domAttributes?.blockContent || {}),\n        ...HTMLAttributes,\n      },\n      this.options.domAttributes?.inlineContent || {}\n    );\n\n    dom.insertBefore(checkbox, contentDOM);\n\n    return { dom, contentDOM };\n  },\n\n  // Need to render node view since the checkbox needs to be able to update the\n  // node. This is only possible with a node view as it exposes `getPos`.\n  addNodeView() {\n    return ({ node, getPos, editor, HTMLAttributes }) => {\n      // Need to wrap certain elements in a div or keyboard navigation gets\n      // confused.\n      const wrapper = document.createElement(\"div\");\n      const checkboxWrapper = document.createElement(\"div\");\n      checkboxWrapper.contentEditable = \"false\";\n\n      const checkbox = document.createElement(\"input\");\n      checkbox.type = \"checkbox\";\n      checkbox.checked = node.attrs.checked;\n      if (node.attrs.checked) {\n        checkbox.setAttribute(\"checked\", \"\");\n      }\n\n      const changeHandler = () => {\n        if (!editor.isEditable) {\n          // This seems like the most effective way of blocking the checkbox\n          // from being toggled, as event.preventDefault() does not stop it for\n          // \"click\" or \"change\" events.\n          checkbox.checked = !checkbox.checked;\n          return;\n        }\n\n        if (typeof getPos !== \"boolean\") {\n          this.editor.commands.BNUpdateBlock(getPos(), {\n            type: \"checkListItem\",\n            props: {\n              checked: checkbox.checked as any,\n            },\n          });\n        }\n      };\n      checkbox.addEventListener(\"change\", changeHandler);\n\n      const { dom, contentDOM } = createDefaultBlockDOMOutputSpec(\n        this.name,\n        \"p\",\n        {\n          ...(this.options.domAttributes?.blockContent || {}),\n          ...HTMLAttributes,\n        },\n        this.options.domAttributes?.inlineContent || {}\n      );\n\n      if (typeof getPos !== \"boolean\") {\n        // Since `node` is a blockContent node, we have to get the block ID from\n        // the parent blockContainer node. This means we can't add the label in\n        // `renderHTML` as we can't use `getPos` and therefore can't get the\n        // parent blockContainer node.\n        const blockID = this.editor.state.doc.resolve(getPos()).node().attrs.id;\n        const label = \"label-\" + blockID;\n        checkbox.setAttribute(\"aria-labelledby\", label);\n        contentDOM.id = label;\n      }\n\n      dom.removeChild(contentDOM);\n      dom.appendChild(wrapper);\n      wrapper.appendChild(checkboxWrapper);\n      wrapper.appendChild(contentDOM);\n      checkboxWrapper.appendChild(checkbox);\n\n      return {\n        dom,\n        contentDOM,\n        destroy: () => {\n          checkbox.removeEventListener(\"change\", changeHandler);\n        },\n      };\n    };\n  },\n});\n\nexport const CheckListItem = createBlockSpecFromStronglyTypedTiptapNode(\n  checkListItemBlockContent,\n  checkListItemPropSchema\n);\n","import {\n  createBlockSpecFromStronglyTypedTiptapNode,\n  createStronglyTypedTiptapNode,\n} from \"../../schema\";\nimport { createDefaultBlockDOMOutputSpec } from \"../defaultBlockHelpers\";\nimport { defaultProps } from \"../defaultProps\";\nimport { getCurrentBlockContentType } from \"../../api/getCurrentBlockContentType\";\n\nexport const paragraphPropSchema = {\n  ...defaultProps,\n};\n\nexport const ParagraphBlockContent = createStronglyTypedTiptapNode({\n  name: \"paragraph\",\n  content: \"inline*\",\n  group: \"blockContent\",\n\n  addKeyboardShortcuts() {\n    return {\n      \"Mod-Alt-0\": () => {\n        if (getCurrentBlockContentType(this.editor) !== \"inline*\") {\n          return true;\n        }\n\n        return this.editor.commands.BNUpdateBlock(\n          this.editor.state.selection.anchor,\n          {\n            type: \"paragraph\",\n            props: {},\n          }\n        );\n      },\n    };\n  },\n\n  parseHTML() {\n    return [\n      { tag: \"div[data-content-type=\" + this.name + \"]\" },\n      {\n        tag: \"p\",\n        priority: 200,\n        getAttrs: (element) => {\n          if (typeof element === \"string\" || !element.textContent?.trim()) {\n            return false;\n          }\n\n          return {};\n        },\n        node: \"paragraph\",\n      },\n    ];\n  },\n\n  renderHTML({ HTMLAttributes }) {\n    return createDefaultBlockDOMOutputSpec(\n      this.name,\n      \"p\",\n      {\n        ...(this.options.domAttributes?.blockContent || {}),\n        ...HTMLAttributes,\n      },\n      this.options.domAttributes?.inlineContent || {}\n    );\n  },\n});\n\nexport const Paragraph = createBlockSpecFromStronglyTypedTiptapNode(\n  ParagraphBlockContent,\n  paragraphPropSchema\n);\n","import { callOrReturn, Extension, getExtensionField } from \"@tiptap/core\";\nimport { columnResizing, tableEditing } from \"prosemirror-tables\";\n\nexport const TableExtension = Extension.create({\n  name: \"BlockNoteTableExtension\",\n\n  addProseMirrorPlugins: () => {\n    return [\n      columnResizing({\n        cellMinWidth: 100,\n      }),\n      tableEditing(),\n    ];\n  },\n\n  addKeyboardShortcuts() {\n    return {\n      // Makes enter create a new line within the cell.\n      Enter: () => {\n        if (\n          this.editor.state.selection.empty &&\n          this.editor.state.selection.$head.parent.type.name ===\n            \"tableParagraph\"\n        ) {\n          this.editor.commands.setHardBreak();\n\n          return true;\n        }\n\n        return false;\n      },\n      // Ensures that backspace won't delete the table if the text cursor is at\n      // the start of a cell and the selection is empty.\n      Backspace: () => {\n        const selection = this.editor.state.selection;\n        const selectionIsEmpty = selection.empty;\n        const selectionIsAtStartOfNode = selection.$head.parentOffset === 0;\n        const selectionIsInTableParagraphNode =\n          selection.$head.node().type.name === \"tableParagraph\";\n\n        return (\n          selectionIsEmpty &&\n          selectionIsAtStartOfNode &&\n          selectionIsInTableParagraphNode\n        );\n      },\n    };\n  },\n\n  extendNodeSchema(extension) {\n    const context = {\n      name: extension.name,\n      options: extension.options,\n      storage: extension.storage,\n    };\n\n    return {\n      tableRole: callOrReturn(\n        getExtensionField(extension, \"tableRole\", context)\n      ),\n    };\n  },\n});\n","import { mergeAttributes, Node } from \"@tiptap/core\";\nimport { TableCell } from \"@tiptap/extension-table-cell\";\nimport { TableHeader } from \"@tiptap/extension-table-header\";\nimport { TableRow } from \"@tiptap/extension-table-row\";\nimport {\n  createBlockSpecFromStronglyTypedTiptapNode,\n  createStronglyTypedTiptapNode,\n} from \"../../schema\";\nimport { createDefaultBlockDOMOutputSpec } from \"../defaultBlockHelpers\";\nimport { defaultProps } from \"../defaultProps\";\nimport { TableExtension } from \"./TableExtension\";\n\nexport const tablePropSchema = {\n  ...defaultProps,\n};\n\nexport const TableBlockContent = createStronglyTypedTiptapNode({\n  name: \"table\",\n  content: \"tableRow+\",\n  group: \"blockContent\",\n  tableRole: \"table\",\n\n  isolating: true,\n\n  parseHTML() {\n    return [{ tag: \"table\" }];\n  },\n\n  renderHTML({ HTMLAttributes }) {\n    return createDefaultBlockDOMOutputSpec(\n      this.name,\n      \"table\",\n      {\n        ...(this.options.domAttributes?.blockContent || {}),\n        ...HTMLAttributes,\n      },\n      this.options.domAttributes?.inlineContent || {}\n    );\n  },\n});\n\nconst TableParagraph = Node.create({\n  name: \"tableParagraph\",\n  group: \"tableContent\",\n  content: \"inline*\",\n\n  parseHTML() {\n    return [\n      { tag: \"td\" },\n      {\n        tag: \"p\",\n        getAttrs: (element) => {\n          if (typeof element === \"string\" || !element.textContent) {\n            return false;\n          }\n\n          const parent = element.parentElement;\n\n          if (parent === null) {\n            return false;\n          }\n\n          if (parent.tagName === \"TD\") {\n            return {};\n          }\n\n          return false;\n        },\n      },\n    ];\n  },\n\n  renderHTML({ HTMLAttributes }) {\n    return [\n      \"p\",\n      mergeAttributes(this.options.HTMLAttributes, HTMLAttributes),\n      0,\n    ];\n  },\n});\n\nexport const Table = createBlockSpecFromStronglyTypedTiptapNode(\n  TableBlockContent,\n  tablePropSchema,\n  [\n    TableExtension,\n    TableParagraph,\n    TableHeader.extend({\n      content: \"tableContent\",\n    }),\n    TableCell.extend({\n      content: \"tableContent\",\n    }),\n    TableRow,\n  ]\n);\n","import Bold from \"@tiptap/extension-bold\";\nimport Code from \"@tiptap/extension-code\";\nimport Italic from \"@tiptap/extension-italic\";\nimport Strike from \"@tiptap/extension-strike\";\nimport Underline from \"@tiptap/extension-underline\";\nimport { BackgroundColor } from \"../extensions/BackgroundColor/BackgroundColorMark\";\nimport { TextColor } from \"../extensions/TextColor/TextColorMark\";\nimport {\n  BlockNoDefaults,\n  BlockSchema,\n  BlockSpecs,\n  InlineContentSchema,\n  InlineContentSpecs,\n  PartialBlockNoDefaults,\n  StyleSchema,\n  StyleSpecs,\n  createStyleSpecFromTipTapMark,\n  getBlockSchemaFromSpecs,\n  getInlineContentSchemaFromSpecs,\n  getStyleSchemaFromSpecs,\n} from \"../schema\";\n\nimport { Heading } from \"./HeadingBlockContent/HeadingBlockContent\";\nimport { BulletListItem } from \"./ListItemBlockContent/BulletListItemBlockContent/BulletListItemBlockContent\";\nimport { NumberedListItem } from \"./ListItemBlockContent/NumberedListItemBlockContent/NumberedListItemBlockContent\";\nimport { CheckListItem } from \"./ListItemBlockContent/CheckListItemBlockContent/CheckListItemBlockContent\";\nimport { Paragraph } from \"./ParagraphBlockContent/ParagraphBlockContent\";\nimport { Table } from \"./TableBlockContent/TableBlockContent\";\nimport { FileBlock } from \"./FileBlockContent/FileBlockContent\";\nimport { ImageBlock } from \"./ImageBlockContent/ImageBlockContent\";\nimport { VideoBlock } from \"./VideoBlockContent/VideoBlockContent\";\nimport { AudioBlock } from \"./AudioBlockContent/AudioBlockContent\";\n\nexport const defaultBlockSpecs = {\n  paragraph: Paragraph,\n  heading: Heading,\n  bulletListItem: BulletListItem,\n  numberedListItem: NumberedListItem,\n  checkListItem: CheckListItem,\n  table: Table,\n  file: FileBlock,\n  image: ImageBlock,\n  video: VideoBlock,\n  audio: AudioBlock,\n} satisfies BlockSpecs;\n\nexport const defaultBlockSchema = getBlockSchemaFromSpecs(defaultBlockSpecs);\n\n// underscore is used that in case a user overrides DefaultBlockSchema,\n// they can still access the original default block schema\nexport type _DefaultBlockSchema = typeof defaultBlockSchema;\nexport type DefaultBlockSchema = _DefaultBlockSchema;\n\nexport const defaultStyleSpecs = {\n  bold: createStyleSpecFromTipTapMark(Bold, \"boolean\"),\n  italic: createStyleSpecFromTipTapMark(Italic, \"boolean\"),\n  underline: createStyleSpecFromTipTapMark(Underline, \"boolean\"),\n  strike: createStyleSpecFromTipTapMark(Strike, \"boolean\"),\n  code: createStyleSpecFromTipTapMark(Code, \"boolean\"),\n  textColor: TextColor,\n  backgroundColor: BackgroundColor,\n} satisfies StyleSpecs;\n\nexport const defaultStyleSchema = getStyleSchemaFromSpecs(defaultStyleSpecs);\n\n// underscore is used that in case a user overrides DefaultStyleSchema,\n// they can still access the original default style schema\nexport type _DefaultStyleSchema = typeof defaultStyleSchema;\nexport type DefaultStyleSchema = _DefaultStyleSchema;\n\nexport const defaultInlineContentSpecs = {\n  text: { config: \"text\", implementation: {} as any },\n  link: { config: \"link\", implementation: {} as any },\n} satisfies InlineContentSpecs;\n\nexport const defaultInlineContentSchema = getInlineContentSchemaFromSpecs(\n  defaultInlineContentSpecs\n);\n\n// underscore is used that in case a user overrides DefaultInlineContentSchema,\n// they can still access the original default inline content schema\nexport type _DefaultInlineContentSchema = typeof defaultInlineContentSchema;\nexport type DefaultInlineContentSchema = _DefaultInlineContentSchema;\n\nexport type PartialBlock<\n  BSchema extends BlockSchema = DefaultBlockSchema,\n  I extends InlineContentSchema = DefaultInlineContentSchema,\n  S extends StyleSchema = DefaultStyleSchema\n> = PartialBlockNoDefaults<BSchema, I, S>;\n\nexport type Block<\n  BSchema extends BlockSchema = DefaultBlockSchema,\n  I extends InlineContentSchema = DefaultInlineContentSchema,\n  S extends StyleSchema = DefaultStyleSchema\n> = BlockNoDefaults<BSchema, I, S>;\n","import type { BlockNoteEditor } from \"../editor/BlockNoteEditor\";\nimport {\n  BlockFromConfig,\n  BlockSchema,\n  FileBlockConfig,\n  InlineContentSchema,\n  StyleSchema,\n} from \"../schema\";\nimport { Block, DefaultBlockSchema, defaultBlockSchema } from \"./defaultBlocks\";\nimport { defaultProps } from \"./defaultProps\";\n\nexport function checkDefaultBlockTypeInSchema<\n  BlockType extends keyof DefaultBlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(\n  blockType: BlockType,\n  editor: BlockNoteEditor<any, I, S>\n): editor is BlockNoteEditor<{ Type: DefaultBlockSchema[BlockType] }, I, S> {\n  return (\n    blockType in editor.schema.blockSchema &&\n    editor.schema.blockSchema[blockType] === defaultBlockSchema[blockType]\n  );\n}\n\nexport function checkBlockIsDefaultType<\n  BlockType extends keyof DefaultBlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(\n  blockType: BlockType,\n  block: Block<any, I, S>,\n  editor: BlockNoteEditor<any, I, S>\n): block is BlockFromConfig<DefaultBlockSchema[BlockType], I, S> {\n  return (\n    block.type === blockType &&\n    block.type in editor.schema.blockSchema &&\n    checkDefaultBlockTypeInSchema(block.type, editor)\n  );\n}\n\nexport function checkBlockIsFileBlock<\n  B extends BlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(\n  block: Block<any, I, S>,\n  editor: BlockNoteEditor<B, I, S>\n): block is BlockFromConfig<FileBlockConfig, I, S> {\n  return (\n    (block.type in editor.schema.blockSchema &&\n      editor.schema.blockSchema[block.type].isFileBlock) ||\n    false\n  );\n}\n\nexport function checkBlockIsFileBlockWithPreview<\n  B extends BlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(\n  block: Block<any, I, S>,\n  editor: BlockNoteEditor<B, I, S>\n): block is BlockFromConfig<\n  FileBlockConfig & {\n    propSchema: Required<FileBlockConfig[\"propSchema\"]>;\n  },\n  I,\n  S\n> {\n  return (\n    (block.type in editor.schema.blockSchema &&\n      editor.schema.blockSchema[block.type].isFileBlock &&\n      \"showPreview\" in editor.schema.blockSchema[block.type].propSchema) ||\n    false\n  );\n}\n\nexport function checkBlockIsFileBlockWithPlaceholder<\n  B extends BlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(block: Block<B, I, S>, editor: BlockNoteEditor<B, I, S>) {\n  const config = editor.schema.blockSchema[block.type];\n  return config.isFileBlock && !block.props.url;\n}\n\nexport function checkBlockTypeHasDefaultProp<\n  Prop extends keyof typeof defaultProps,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(\n  prop: Prop,\n  blockType: string,\n  editor: BlockNoteEditor<any, I, S>\n): editor is BlockNoteEditor<\n  {\n    [BT in string]: {\n      type: BT;\n      propSchema: {\n        [P in Prop]: (typeof defaultProps)[P];\n      };\n      content: \"table\" | \"inline\" | \"none\";\n    };\n  },\n  I,\n  S\n> {\n  return (\n    blockType in editor.schema.blockSchema &&\n    prop in editor.schema.blockSchema[blockType].propSchema &&\n    editor.schema.blockSchema[blockType].propSchema[prop] === defaultProps[prop]\n  );\n}\n\nexport function checkBlockHasDefaultProp<\n  Prop extends keyof typeof defaultProps,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(\n  prop: Prop,\n  block: Block<any, I, S>,\n  editor: BlockNoteEditor<any, I, S>\n): block is BlockFromConfig<\n  {\n    type: string;\n    propSchema: {\n      [P in Prop]: (typeof defaultProps)[P];\n    };\n    content: \"table\" | \"inline\" | \"none\";\n  },\n  I,\n  S\n> {\n  return checkBlockTypeHasDefaultProp(prop, block.type, editor);\n}\n","import { Node } from \"prosemirror-model\";\n\n/**\n * Get a TipTap node by id\n */\nexport function getNodeById(\n  id: string,\n  doc: Node\n): { node: Node; posBeforeNode: number } {\n  let targetNode: Node | undefined = undefined;\n  let posBeforeNode: number | undefined = undefined;\n\n  doc.firstChild!.descendants((node, pos) => {\n    // Skips traversing nodes after node with target ID has been found.\n    if (targetNode) {\n      return false;\n    }\n\n    // Keeps traversing nodes if block with target ID has not been found.\n    if (node.type.name !== \"blockContainer\" || node.attrs.id !== id) {\n      return true;\n    }\n\n    targetNode = node;\n    posBeforeNode = pos + 1;\n\n    return false;\n  });\n\n  if (targetNode === undefined || posBeforeNode === undefined) {\n    throw Error(\"Could not find block in the editor with matching ID.\");\n  }\n\n  return {\n    node: targetNode,\n    posBeforeNode: posBeforeNode,\n  };\n}\n","import { Node } from \"prosemirror-model\";\n\nimport { selectionToInsertionEnd } from \"@tiptap/core\";\nimport { Transaction } from \"prosemirror-state\";\nimport { Block, PartialBlock } from \"../../blocks/defaultBlocks\";\nimport type { BlockNoteEditor } from \"../../editor/BlockNoteEditor\";\nimport {\n  BlockIdentifier,\n  BlockSchema,\n  InlineContentSchema,\n  StyleSchema,\n} from \"../../schema\";\nimport { blockToNode, nodeToBlock } from \"../nodeConversions/nodeConversions\";\nimport { getNodeById } from \"../nodeUtil\";\n\nexport function insertBlocks<\n  BSchema extends BlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(\n  blocksToInsert: PartialBlock<BSchema, I, S>[],\n  referenceBlock: BlockIdentifier,\n  placement: \"before\" | \"after\" | \"nested\" = \"before\",\n  editor: BlockNoteEditor<BSchema, I, S>\n): Block<BSchema, I, S>[] {\n  const ttEditor = editor._tiptapEditor;\n\n  const id =\n    typeof referenceBlock === \"string\" ? referenceBlock : referenceBlock.id;\n\n  const nodesToInsert: Node[] = [];\n  for (const blockSpec of blocksToInsert) {\n    nodesToInsert.push(\n      blockToNode(blockSpec, ttEditor.schema, editor.schema.styleSchema)\n    );\n  }\n\n  const { node, posBeforeNode } = getNodeById(id, ttEditor.state.doc);\n\n  if (placement === \"before\") {\n    ttEditor.view.dispatch(\n      ttEditor.state.tr.insert(posBeforeNode, nodesToInsert)\n    );\n  }\n\n  if (placement === \"after\") {\n    ttEditor.view.dispatch(\n      ttEditor.state.tr.insert(posBeforeNode + node.nodeSize, nodesToInsert)\n    );\n  }\n\n  if (placement === \"nested\") {\n    // Case if block doesn't already have children.\n    if (node.childCount < 2) {\n      const blockGroupNode = ttEditor.state.schema.nodes[\"blockGroup\"].create(\n        {},\n        nodesToInsert\n      );\n\n      ttEditor.view.dispatch(\n        ttEditor.state.tr.insert(\n          posBeforeNode + node.firstChild!.nodeSize + 1,\n          blockGroupNode\n        )\n      );\n    }\n  }\n\n  // Now that the `PartialBlock`s have been converted to nodes, we can\n  // re-convert them into full `Block`s.\n  const insertedBlocks: Block<BSchema, I, S>[] = [];\n  for (const node of nodesToInsert) {\n    insertedBlocks.push(\n      nodeToBlock(\n        node,\n        editor.schema.blockSchema,\n        editor.schema.inlineContentSchema,\n        editor.schema.styleSchema,\n        editor.blockCache\n      )\n    );\n  }\n\n  return insertedBlocks;\n}\n\nexport function updateBlock<\n  BSchema extends BlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(\n  blockToUpdate: BlockIdentifier,\n  update: PartialBlock<BSchema, I, S>,\n  editor: BlockNoteEditor<BSchema, I, S>\n): Block<BSchema, I, S> {\n  const ttEditor = editor._tiptapEditor;\n\n  const id =\n    typeof blockToUpdate === \"string\" ? blockToUpdate : blockToUpdate.id;\n  const { posBeforeNode } = getNodeById(id, ttEditor.state.doc);\n\n  ttEditor.commands.BNUpdateBlock(posBeforeNode + 1, update);\n\n  const blockContainerNode = ttEditor.state.doc\n    .resolve(posBeforeNode + 1)\n    .node();\n\n  return nodeToBlock(\n    blockContainerNode,\n    editor.schema.blockSchema,\n    editor.schema.inlineContentSchema,\n    editor.schema.styleSchema,\n    editor.blockCache\n  );\n}\n\nfunction removeBlocksWithCallback<\n  BSchema extends BlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(\n  blocksToRemove: BlockIdentifier[],\n  editor: BlockNoteEditor<BSchema, I, S>,\n  // Should return new removedSize.\n  callback?: (\n    node: Node,\n    pos: number,\n    tr: Transaction,\n    removedSize: number\n  ) => number\n): Block<BSchema, I, S>[] {\n  const ttEditor = editor._tiptapEditor;\n  const tr = ttEditor.state.tr;\n\n  const idsOfBlocksToRemove = new Set<string>(\n    blocksToRemove.map((block) =>\n      typeof block === \"string\" ? block : block.id\n    )\n  );\n  const removedBlocks: Block<BSchema, I, S>[] = [];\n  let removedSize = 0;\n\n  ttEditor.state.doc.descendants((node, pos) => {\n    // Skips traversing nodes after all target blocks have been removed.\n    if (idsOfBlocksToRemove.size === 0) {\n      return false;\n    }\n\n    // Keeps traversing nodes if block with target ID has not been found.\n    if (\n      node.type.name !== \"blockContainer\" ||\n      !idsOfBlocksToRemove.has(node.attrs.id)\n    ) {\n      return true;\n    }\n\n    // Saves the block that is being deleted.\n    removedBlocks.push(\n      nodeToBlock(\n        node,\n        editor.schema.blockSchema,\n        editor.schema.inlineContentSchema,\n        editor.schema.styleSchema,\n        editor.blockCache\n      )\n    );\n    idsOfBlocksToRemove.delete(node.attrs.id);\n\n    // Removes the block and calculates the change in document size.\n    removedSize = callback?.(node, pos, tr, removedSize) || removedSize;\n    const oldDocSize = tr.doc.nodeSize;\n    tr.delete(pos - removedSize - 1, pos - removedSize + node.nodeSize + 1);\n    const newDocSize = tr.doc.nodeSize;\n    removedSize += oldDocSize - newDocSize;\n\n    return false;\n  });\n\n  // Throws an error if now all blocks could be found.\n  if (idsOfBlocksToRemove.size > 0) {\n    const notFoundIds = [...idsOfBlocksToRemove].join(\"\\n\");\n\n    throw Error(\n      \"Blocks with the following IDs could not be found in the editor: \" +\n        notFoundIds\n    );\n  }\n\n  ttEditor.view.dispatch(tr);\n\n  return removedBlocks;\n}\n\nexport function removeBlocks<\n  BSchema extends BlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(\n  blocksToRemove: BlockIdentifier[],\n  editor: BlockNoteEditor<BSchema, I, S>\n): Block<BSchema, I, S>[] {\n  return removeBlocksWithCallback(blocksToRemove, editor);\n}\n\nexport function replaceBlocks<\n  BSchema extends BlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(\n  blocksToRemove: BlockIdentifier[],\n  blocksToInsert: PartialBlock<BSchema, I, S>[],\n  editor: BlockNoteEditor<BSchema, I, S>\n): {\n  insertedBlocks: Block<BSchema, I, S>[];\n  removedBlocks: Block<BSchema, I, S>[];\n} {\n  const ttEditor = editor._tiptapEditor;\n\n  const nodesToInsert: Node[] = [];\n  for (const block of blocksToInsert) {\n    nodesToInsert.push(\n      blockToNode(block, ttEditor.schema, editor.schema.styleSchema)\n    );\n  }\n\n  const idOfFirstBlock =\n    typeof blocksToRemove[0] === \"string\"\n      ? blocksToRemove[0]\n      : blocksToRemove[0].id;\n  const removedBlocks = removeBlocksWithCallback(\n    blocksToRemove,\n    editor,\n    (node, pos, tr, removedSize) => {\n      if (node.attrs.id === idOfFirstBlock) {\n        const oldDocSize = tr.doc.nodeSize;\n        tr.insert(pos, nodesToInsert);\n        const newDocSize = tr.doc.nodeSize;\n\n        return removedSize + oldDocSize - newDocSize;\n      }\n\n      return removedSize;\n    }\n  );\n\n  // Now that the `PartialBlock`s have been converted to nodes, we can\n  // re-convert them into full `Block`s.\n  const insertedBlocks: Block<BSchema, I, S>[] = [];\n  for (const node of nodesToInsert) {\n    insertedBlocks.push(\n      nodeToBlock(\n        node,\n        editor.schema.blockSchema,\n        editor.schema.inlineContentSchema,\n        editor.schema.styleSchema,\n        editor.blockCache\n      )\n    );\n  }\n\n  return { insertedBlocks, removedBlocks };\n}\n\n// similar to tiptap insertContentAt\nexport function insertContentAt<\n  BSchema extends BlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(\n  position: any,\n  nodes: Node[],\n  editor: BlockNoteEditor<BSchema, I, S>,\n  options: {\n    updateSelection: boolean;\n  } = { updateSelection: true }\n) {\n  const ttEditor = editor._tiptapEditor;\n  const tr = ttEditor.state.tr;\n\n  // don’t dispatch an empty fragment because this can lead to strange errors\n  // if (content.toString() === \"<>\") {\n  //   return true;\n  // }\n\n  let { from, to } =\n    typeof position === \"number\"\n      ? { from: position, to: position }\n      : { from: position.from, to: position.to };\n\n  let isOnlyTextContent = true;\n  let isOnlyBlockContent = true;\n  // const nodes = isFragment(content) ? content : [content];\n\n  let text = \"\";\n\n  nodes.forEach((node) => {\n    // check if added node is valid\n    node.check();\n\n    if (isOnlyTextContent && node.isText && node.marks.length === 0) {\n      text += node.text;\n    } else {\n      isOnlyTextContent = false;\n    }\n\n    isOnlyBlockContent = isOnlyBlockContent ? node.isBlock : false;\n  });\n\n  // check if we can replace the wrapping node by\n  // the newly inserted content\n  // example:\n  // replace an empty paragraph by an inserted image\n  // instead of inserting the image below the paragraph\n  if (from === to && isOnlyBlockContent) {\n    const { parent } = tr.doc.resolve(from);\n    const isEmptyTextBlock =\n      parent.isTextblock && !parent.type.spec.code && !parent.childCount;\n\n    if (isEmptyTextBlock) {\n      from -= 1;\n      to += 1;\n    }\n  }\n\n  // if there is only plain text we have to use `insertText`\n  // because this will keep the current marks\n  if (isOnlyTextContent) {\n    // if value is string, we can use it directly\n    // otherwise if it is an array, we have to join it\n    // if (Array.isArray(value)) {\n    //   tr.insertText(value.map((v) => v.text || \"\").join(\"\"), from, to);\n    // } else if (typeof value === \"object\" && !!value && !!value.text) {\n    //   tr.insertText(value.text, from, to);\n    // } else {\n    //   tr.insertText(value as string, from, to);\n    // }\n    tr.insertText(text, from, to);\n  } else {\n    tr.replaceWith(from, to, nodes);\n  }\n\n  // set cursor at end of inserted content\n  if (options.updateSelection) {\n    selectionToInsertionEnd(tr, tr.steps.length - 1, -1);\n  }\n\n  ttEditor.view.dispatch(tr);\n\n  return true;\n}\n","import { Element as HASTElement, Parent as HASTParent } from \"hast\";\n\n/**\n * Rehype plugin which removes <u> tags. Used to remove underlines before converting HTML to markdown, as Markdown\n * doesn't support underlines.\n */\nexport function removeUnderlines() {\n  const removeUnderlinesHelper = (tree: HASTParent) => {\n    let numChildElements = tree.children.length;\n\n    for (let i = 0; i < numChildElements; i++) {\n      const node = tree.children[i];\n\n      if (node.type === \"element\") {\n        // Recursively removes underlines from child elements.\n        removeUnderlinesHelper(node);\n\n        if ((node as HASTElement).tagName === \"u\") {\n          // Lifts child nodes outside underline element, deletes the underline element, and updates current index &\n          // the number of child elements.\n          if (node.children.length > 0) {\n            tree.children.splice(i, 1, ...node.children);\n\n            const numElementsAdded = node.children.length - 1;\n            numChildElements += numElementsAdded;\n            i += numElementsAdded;\n          } else {\n            tree.children.splice(i, 1);\n\n            numChildElements--;\n            i--;\n          }\n        }\n      }\n    }\n  };\n\n  return removeUnderlinesHelper;\n}\n","import { Element as HASTElement, Parent as HASTParent } from \"hast\";\nimport { fromDom } from \"hast-util-from-dom\";\n\n/**\n * Rehype plugin which adds a space after each checkbox input element. This is\n * because remark doesn't add any spaces between the checkbox input and the text\n * itself, but these are needed for correct Markdown syntax.\n */\nexport function addSpacesToCheckboxes() {\n  const helper = (tree: HASTParent) => {\n    if (tree.children && \"length\" in tree.children && tree.children.length) {\n      for (let i = tree.children.length - 1; i >= 0; i--) {\n        const child = tree.children[i];\n        const nextChild =\n          i + 1 < tree.children.length ? tree.children[i + 1] : undefined;\n\n        // Checks for paragraph element after checkbox input element.\n        if (\n          child.type === \"element\" &&\n          child.tagName === \"input\" &&\n          child.properties?.type === \"checkbox\" &&\n          nextChild?.type === \"element\" &&\n          nextChild.tagName === \"p\"\n        ) {\n          // Converts paragraph to span, otherwise remark will think it needs to\n          // be on a new line.\n          nextChild.tagName = \"span\";\n          // Adds a space after the checkbox input element.\n          nextChild.children.splice(\n            0,\n            0,\n            fromDom(document.createTextNode(\" \")) as HASTElement\n          );\n        } else {\n          helper(child as HASTParent);\n        }\n      }\n    }\n  };\n\n  return helper;\n}\n","import { Schema } from \"prosemirror-model\";\nimport rehypeParse from \"rehype-parse\";\nimport rehypeRemark from \"rehype-remark\";\nimport remarkGfm from \"remark-gfm\";\nimport remarkStringify from \"remark-stringify\";\nimport { unified } from \"unified\";\nimport { Block } from \"../../../blocks/defaultBlocks\";\nimport type { BlockNoteEditor } from \"../../../editor/BlockNoteEditor\";\nimport { BlockSchema, InlineContentSchema, StyleSchema } from \"../../../schema\";\nimport { createExternalHTMLExporter } from \"../html/externalHTMLExporter\";\nimport { removeUnderlines } from \"./removeUnderlinesRehypePlugin\";\nimport { addSpacesToCheckboxes } from \"./util/addSpacesToCheckboxesRehypePlugin\";\n\nexport function cleanHTMLToMarkdown(cleanHTMLString: string) {\n  const markdownString = unified()\n    .use(rehypeParse, { fragment: true })\n    .use(removeUnderlines)\n    .use(addSpacesToCheckboxes)\n    .use(rehypeRemark)\n    .use(remarkGfm)\n    .use(remarkStringify, { handlers: { text: (node) => node.value } })\n    .processSync(cleanHTMLString);\n\n  return markdownString.value as string;\n}\n\nexport function blocksToMarkdown<\n  BSchema extends BlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(\n  blocks: Block<BSchema, I, S>[],\n  schema: Schema,\n  editor: BlockNoteEditor<BSchema, I, S>\n): string {\n  const exporter = createExternalHTMLExporter(schema, editor);\n  const externalHTML = exporter.exportBlocks(blocks);\n\n  return cleanHTMLToMarkdown(externalHTML);\n}\n","function getChildIndex(node: Element) {\n  return Array.prototype.indexOf.call(node.parentElement!.childNodes, node);\n}\n\nfunction isWhitespaceNode(node: Node) {\n  return node.nodeType === 3 && !/\\S/.test(node.nodeValue || \"\");\n}\n\n/**\n * Step 1, Turns:\n *\n * <ul>\n *  <li>item</li>\n *  <li>\n *   <ul>\n *      <li>...</li>\n *      <li>...</li>\n *   </ul>\n * </li>\n *\n * Into:\n * <ul>\n *  <li>item</li>\n *  <ul>\n *      <li>...</li>\n *      <li>...</li>\n *  </ul>\n * </ul>\n *\n */\nfunction liftNestedListsToParent(element: HTMLElement) {\n  element.querySelectorAll(\"li > ul, li > ol\").forEach((list) => {\n    const index = getChildIndex(list);\n    const parentListItem = list.parentElement!;\n    const siblingsAfter = Array.from(parentListItem.childNodes).slice(\n      index + 1\n    );\n    list.remove();\n    siblingsAfter.forEach((sibling) => {\n      sibling.remove();\n    });\n\n    parentListItem.insertAdjacentElement(\"afterend\", list);\n\n    siblingsAfter.reverse().forEach((sibling) => {\n      if (isWhitespaceNode(sibling)) {\n        return;\n      }\n      const siblingContainer = document.createElement(\"li\");\n      siblingContainer.append(sibling);\n      list.insertAdjacentElement(\"afterend\", siblingContainer);\n    });\n    if (parentListItem.childNodes.length === 0) {\n      parentListItem.remove();\n    }\n  });\n}\n\n/**\n * Step 2, Turns (output of liftNestedListsToParent):\n *\n * <li>item</li>\n * <ul>\n *   <li>...</li>\n *   <li>...</li>\n * </ul>\n *\n * Into:\n * <div>\n *  <li>item</li>\n *  <div data-node-type=\"blockGroup\">\n *      <ul>\n *          <li>...</li>\n *          <li>...</li>\n *      </ul>\n *  </div>\n * </div>\n *\n * This resulting format is parsed\n */\nfunction createGroups(element: HTMLElement) {\n  element.querySelectorAll(\"li + ul, li + ol\").forEach((list) => {\n    const listItem = list.previousElementSibling as HTMLElement;\n    const blockContainer = document.createElement(\"div\");\n\n    listItem.insertAdjacentElement(\"afterend\", blockContainer);\n    blockContainer.append(listItem);\n\n    const blockGroup = document.createElement(\"div\");\n    blockGroup.setAttribute(\"data-node-type\", \"blockGroup\");\n    blockContainer.append(blockGroup);\n\n    while (\n      blockContainer.nextElementSibling?.nodeName === \"UL\" ||\n      blockContainer.nextElementSibling?.nodeName === \"OL\"\n    ) {\n      blockGroup.append(blockContainer.nextElementSibling);\n    }\n  });\n}\n\n// prevent XSS, similar to https://github.com/ProseMirror/prosemirror-view/blob/1251b2b412656a2a06263e4187574beb43651273/src/clipboard.ts#L204\n// https://github.com/TypeCellOS/BlockNote/issues/601\nlet _detachedDoc: Document | null = null;\nfunction detachedDoc() {\n  return (\n    _detachedDoc ||\n    (_detachedDoc = document.implementation.createHTMLDocument(\"title\"))\n  );\n}\n\nexport function nestedListsToBlockNoteStructure(\n  elementOrHTML: HTMLElement | string\n) {\n  if (typeof elementOrHTML === \"string\") {\n    const element = detachedDoc().createElement(\"div\");\n    element.innerHTML = elementOrHTML;\n    elementOrHTML = element;\n  }\n  liftNestedListsToParent(elementOrHTML);\n  createGroups(elementOrHTML);\n  return elementOrHTML;\n}\n","import { DOMParser, Schema } from \"prosemirror-model\";\nimport { BlockSchema, InlineContentSchema, StyleSchema } from \"../../../schema\";\n\nimport { Block } from \"../../../blocks/defaultBlocks\";\nimport { nodeToBlock } from \"../../nodeConversions/nodeConversions\";\nimport { nestedListsToBlockNoteStructure } from \"./util/nestedLists\";\nexport async function HTMLToBlocks<\n  BSchema extends BlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(\n  html: string,\n  blockSchema: BSchema,\n  icSchema: I,\n  styleSchema: S,\n  pmSchema: Schema\n): Promise<Block<BSchema, I, S>[]> {\n  const htmlNode = nestedListsToBlockNoteStructure(html);\n  const parser = DOMParser.fromSchema(pmSchema);\n\n  // Other approach might be to use\n  // const doc = pmSchema.nodes[\"doc\"].createAndFill()!;\n  // and context: doc.resolve(3),\n\n  const parentNode = parser.parse(htmlNode, {\n    topNode: pmSchema.nodes[\"blockGroup\"].create(),\n  });\n\n  const blocks: Block<BSchema, I, S>[] = [];\n\n  for (let i = 0; i < parentNode.childCount; i++) {\n    blocks.push(\n      nodeToBlock(parentNode.child(i), blockSchema, icSchema, styleSchema)\n    );\n  }\n\n  return blocks;\n}\n","import { Schema } from \"prosemirror-model\";\nimport rehypeStringify from \"rehype-stringify\";\nimport remarkGfm from \"remark-gfm\";\nimport remarkParse from \"remark-parse\";\nimport remarkRehype, { defaultHandlers } from \"remark-rehype\";\nimport { unified } from \"unified\";\nimport { Block } from \"../../../blocks/defaultBlocks\";\nimport { BlockSchema, InlineContentSchema, StyleSchema } from \"../../../schema\";\nimport { HTMLToBlocks } from \"../html/parseHTML\";\n\n// modified version of https://github.com/syntax-tree/mdast-util-to-hast/blob/main/lib/handlers/code.js\n// that outputs a data-language attribute instead of a CSS class (e.g.: language-typescript)\nfunction code(state: any, node: any) {\n  const value = node.value ? node.value + \"\\n\" : \"\";\n  /** @type {Properties} */\n  const properties: any = {};\n\n  if (node.lang) {\n    // changed line\n    properties[\"data-language\"] = node.lang;\n  }\n\n  // Create `<code>`.\n  /** @type {Element} */\n  let result: any = {\n    type: \"element\",\n    tagName: \"code\",\n    properties,\n    children: [{ type: \"text\", value }],\n  };\n\n  if (node.meta) {\n    result.data = { meta: node.meta };\n  }\n\n  state.patch(node, result);\n  result = state.applyData(node, result);\n\n  // Create `<pre>`.\n  result = {\n    type: \"element\",\n    tagName: \"pre\",\n    properties: {},\n    children: [result],\n  };\n  state.patch(node, result);\n  return result;\n}\n\nexport function markdownToBlocks<\n  BSchema extends BlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(\n  markdown: string,\n  blockSchema: BSchema,\n  icSchema: I,\n  styleSchema: S,\n  pmSchema: Schema\n): Promise<Block<BSchema, I, S>[]> {\n  const htmlString = unified()\n    .use(remarkParse)\n    .use(remarkGfm)\n    .use(remarkRehype, {\n      handlers: {\n        ...(defaultHandlers as any),\n        code,\n      },\n    })\n    .use(rehypeStringify)\n    .processSync(markdown);\n\n  return HTMLToBlocks(\n    htmlString.value as string,\n    blockSchema,\n    icSchema,\n    styleSchema,\n    pmSchema\n  );\n}\n","// from https://raw.githubusercontent.com/ueberdosis/tiptap/develop/packages/core/src/EventEmitter.ts (MIT)\n\ntype StringKeyOf<T> = Extract<keyof T, string>;\ntype CallbackType<\n  T extends Record<string, any>,\n  EventName extends StringKeyOf<T>\n> = T[EventName] extends any[] ? T[EventName] : [T[EventName]];\ntype CallbackFunction<\n  T extends Record<string, any>,\n  EventName extends StringKeyOf<T>\n> = (...props: CallbackType<T, EventName>) => any;\n\nexport class EventEmitter<T extends Record<string, any>> {\n  // eslint-disable-next-line @typescript-eslint/ban-types\n  private callbacks: { [key: string]: Function[] } = {};\n\n  public on<EventName extends StringKeyOf<T>>(\n    event: EventName,\n    fn: CallbackFunction<T, EventName>\n  ) {\n    if (!this.callbacks[event]) {\n      this.callbacks[event] = [];\n    }\n\n    this.callbacks[event].push(fn);\n\n    return () => this.off(event, fn);\n  }\n\n  protected emit<EventName extends StringKeyOf<T>>(\n    event: EventName,\n    ...args: CallbackType<T, EventName>\n  ) {\n    const callbacks = this.callbacks[event];\n\n    if (callbacks) {\n      callbacks.forEach((callback) => callback.apply(this, args));\n    }\n  }\n\n  public off<EventName extends StringKeyOf<T>>(\n    event: EventName,\n    fn?: CallbackFunction<T, EventName>\n  ) {\n    const callbacks = this.callbacks[event];\n\n    if (callbacks) {\n      if (fn) {\n        this.callbacks[event] = callbacks.filter((callback) => callback !== fn);\n      } else {\n        delete this.callbacks[event];\n      }\n    }\n  }\n\n  protected removeAllListeners(): void {\n    this.callbacks = {};\n  }\n}\n","import { EditorState, Plugin, PluginKey, PluginView } from \"prosemirror-state\";\nimport { EditorView } from \"prosemirror-view\";\n\nimport type { BlockNoteEditor } from \"../../editor/BlockNoteEditor\";\nimport { UiElementPosition } from \"../../extensions-shared/UiElementPosition\";\nimport type {\n  BlockFromConfig,\n  FileBlockConfig,\n  InlineContentSchema,\n  StyleSchema,\n} from \"../../schema\";\nimport { EventEmitter } from \"../../util/EventEmitter\";\n\nexport type FilePanelState<\n  I extends InlineContentSchema,\n  S extends StyleSchema\n> = UiElementPosition & {\n  // TODO: This typing is not quite right (children should be from BSchema)\n  block: BlockFromConfig<FileBlockConfig, I, S>;\n};\n\nexport class FilePanelView<I extends InlineContentSchema, S extends StyleSchema>\n  implements PluginView\n{\n  public state?: FilePanelState<I, S>;\n  public emitUpdate: () => void;\n\n  constructor(\n    private readonly editor: BlockNoteEditor<\n      Record<string, FileBlockConfig>,\n      I,\n      S\n    >,\n    private readonly pluginKey: PluginKey,\n    private readonly pmView: EditorView,\n    emitUpdate: (state: FilePanelState<I, S>) => void\n  ) {\n    this.emitUpdate = () => {\n      if (!this.state) {\n        throw new Error(\"Attempting to update uninitialized file panel\");\n      }\n\n      emitUpdate(this.state);\n    };\n\n    pmView.dom.addEventListener(\"mousedown\", this.mouseDownHandler);\n    pmView.dom.addEventListener(\"dragstart\", this.dragstartHandler);\n\n    // Setting capture=true ensures that any parent container of the editor that\n    // gets scrolled will trigger the scroll event. Scroll events do not bubble\n    // and so won't propagate to the document by default.\n    pmView.root.addEventListener(\"scroll\", this.scrollHandler, true);\n  }\n\n  mouseDownHandler = () => {\n    if (this.state?.show) {\n      this.state.show = false;\n      this.emitUpdate();\n    }\n  };\n\n  // For dragging the whole editor.\n  dragstartHandler = () => {\n    if (this.state?.show) {\n      this.state.show = false;\n      this.emitUpdate();\n    }\n  };\n\n  scrollHandler = () => {\n    if (this.state?.show) {\n      const blockElement = this.pmView.root.querySelector(\n        `[data-node-type=\"blockContainer\"][data-id=\"${this.state.block.id}\"]`\n      )!;\n\n      this.state.referencePos = blockElement.getBoundingClientRect();\n      this.emitUpdate();\n    }\n  };\n\n  update(view: EditorView, prevState: EditorState) {\n    const pluginState: {\n      block: BlockFromConfig<FileBlockConfig, I, S>;\n    } = this.pluginKey.getState(view.state);\n\n    if (!this.state?.show && pluginState.block && this.editor.isEditable) {\n      const blockElement = this.pmView.root.querySelector(\n        `[data-node-type=\"blockContainer\"][data-id=\"${pluginState.block.id}\"]`\n      )!;\n\n      this.state = {\n        show: true,\n        referencePos: blockElement.getBoundingClientRect(),\n        block: pluginState.block,\n      };\n\n      this.emitUpdate();\n\n      return;\n    }\n\n    if (\n      !view.state.selection.eq(prevState.selection) ||\n      !view.state.doc.eq(prevState.doc) ||\n      !this.editor.isEditable\n    ) {\n      if (this.state?.show) {\n        this.state.show = false;\n\n        this.emitUpdate();\n      }\n    }\n  }\n\n  closeMenu = () => {\n    if (this.state?.show) {\n      this.state.show = false;\n      this.emitUpdate();\n    }\n  };\n\n  destroy() {\n    this.pmView.dom.removeEventListener(\"mousedown\", this.mouseDownHandler);\n\n    this.pmView.dom.removeEventListener(\"dragstart\", this.dragstartHandler);\n\n    this.pmView.root.removeEventListener(\"scroll\", this.scrollHandler, true);\n  }\n}\n\nconst filePanelPluginKey = new PluginKey(\"FilePanelPlugin\");\n\nexport class FilePanelProsemirrorPlugin<\n  I extends InlineContentSchema,\n  S extends StyleSchema\n> extends EventEmitter<any> {\n  private view: FilePanelView<I, S> | undefined;\n  public readonly plugin: Plugin;\n\n  constructor(editor: BlockNoteEditor<Record<string, FileBlockConfig>, I, S>) {\n    super();\n    this.plugin = new Plugin<{\n      block: BlockFromConfig<FileBlockConfig, I, S> | undefined;\n    }>({\n      key: filePanelPluginKey,\n      view: (editorView) => {\n        this.view = new FilePanelView<I, S>(\n          editor,\n          filePanelPluginKey,\n          editorView,\n          (state) => {\n            this.emit(\"update\", state);\n          }\n        );\n        return this.view;\n      },\n      props: {\n        handleKeyDown: (_view, event: KeyboardEvent) => {\n          if (event.key === \"Escape\" && this.shown) {\n            this.view!.closeMenu();\n            return true;\n          }\n          return false;\n        },\n      },\n      state: {\n        init: () => {\n          return {\n            block: undefined,\n          };\n        },\n        apply: (transaction) => {\n          const block: BlockFromConfig<FileBlockConfig, I, S> | undefined =\n            transaction.getMeta(filePanelPluginKey)?.block;\n\n          return {\n            block,\n          };\n        },\n      },\n    });\n  }\n\n  public get shown() {\n    return this.view?.state?.show || false;\n  }\n\n  public onUpdate(callback: (state: FilePanelState<I, S>) => void) {\n    return this.on(\"update\", callback);\n  }\n\n  public closeMenu = () => this.view!.closeMenu();\n}\n","import { isNodeSelection, isTextSelection, posToDOMRect } from \"@tiptap/core\";\nimport { EditorState, Plugin, PluginKey, PluginView } from \"prosemirror-state\";\nimport { EditorView } from \"prosemirror-view\";\n\nimport type { BlockNoteEditor } from \"../../editor/BlockNoteEditor\";\nimport { UiElementPosition } from \"../../extensions-shared/UiElementPosition\";\nimport { BlockSchema, InlineContentSchema, StyleSchema } from \"../../schema\";\nimport { EventEmitter } from \"../../util/EventEmitter\";\n\nexport type FormattingToolbarState = UiElementPosition;\n\nexport class FormattingToolbarView implements PluginView {\n  public state?: FormattingToolbarState;\n  public emitUpdate: () => void;\n\n  public preventHide = false;\n  public preventShow = false;\n\n  public shouldShow: (props: {\n    view: EditorView;\n    state: EditorState;\n    from: number;\n    to: number;\n  }) => boolean = ({ state, from, to, view }) => {\n    const { doc, selection } = state;\n    const { empty } = selection;\n\n    // Sometime check for `empty` is not enough.\n    // Doubleclick an empty paragraph returns a node size of 2.\n    // So we check also for an empty text size.\n    const isEmptyTextBlock =\n      !doc.textBetween(from, to).length && isTextSelection(state.selection);\n\n    // check view.hasFocus so that the toolbar doesn't show up when the editor is not focused or when for example a code block is focused\n    return !(!view.hasFocus() || empty || isEmptyTextBlock);\n  };\n\n  constructor(\n    private readonly editor: BlockNoteEditor<\n      BlockSchema,\n      InlineContentSchema,\n      StyleSchema\n    >,\n    private readonly pmView: EditorView,\n    emitUpdate: (state: FormattingToolbarState) => void\n  ) {\n    this.emitUpdate = () => {\n      if (!this.state) {\n        throw new Error(\n          \"Attempting to update uninitialized formatting toolbar\"\n        );\n      }\n\n      emitUpdate(this.state);\n    };\n\n    pmView.dom.addEventListener(\"mousedown\", this.viewMousedownHandler);\n    pmView.dom.addEventListener(\"mouseup\", this.viewMouseupHandler);\n    pmView.dom.addEventListener(\"dragstart\", this.dragHandler);\n    pmView.dom.addEventListener(\"dragover\", this.dragHandler);\n\n    // Setting capture=true ensures that any parent container of the editor that\n    // gets scrolled will trigger the scroll event. Scroll events do not bubble\n    // and so won't propagate to the document by default.\n    pmView.root.addEventListener(\"scroll\", this.scrollHandler, true);\n  }\n\n  viewMousedownHandler = () => {\n    this.preventShow = true;\n  };\n\n  viewMouseupHandler = () => {\n    this.preventShow = false;\n    setTimeout(() => this.update(this.pmView));\n  };\n\n  // For dragging the whole editor.\n  dragHandler = () => {\n    if (this.state?.show) {\n      this.state.show = false;\n      this.emitUpdate();\n    }\n  };\n\n  scrollHandler = () => {\n    if (this.state?.show) {\n      this.state.referencePos = this.getSelectionBoundingBox();\n      this.emitUpdate();\n    }\n  };\n\n  update(view: EditorView, oldState?: EditorState) {\n    const { state, composing } = view;\n    const { doc, selection } = state;\n    const isSame =\n      oldState && oldState.doc.eq(doc) && oldState.selection.eq(selection);\n\n    if (composing || isSame) {\n      return;\n    }\n\n    // support for CellSelections\n    const { ranges } = selection;\n    const from = Math.min(...ranges.map((range) => range.$from.pos));\n    const to = Math.max(...ranges.map((range) => range.$to.pos));\n\n    const shouldShow = this.shouldShow?.({\n      view,\n      state,\n      from,\n      to,\n    });\n\n    // Checks if menu should be shown/updated.\n    if (!this.preventShow && (shouldShow || this.preventHide)) {\n      // Unlike other UI elements, we don't prevent the formatting toolbar from\n      // showing when the editor is not editable. This is because some buttons,\n      // e.g. the download file button, should still be accessible. Therefore,\n      // logic for hiding when the editor is non-editable is handled\n      // individually in each button.\n      this.state = {\n        show: true,\n        referencePos: this.getSelectionBoundingBox(),\n      };\n\n      this.emitUpdate();\n\n      return;\n    }\n\n    // Checks if menu should be hidden.\n    if (\n      this.state?.show &&\n      !this.preventHide &&\n      (!shouldShow || this.preventShow || !this.editor.isEditable)\n    ) {\n      this.state.show = false;\n      this.emitUpdate();\n\n      return;\n    }\n  }\n\n  destroy() {\n    this.pmView.dom.removeEventListener(\"mousedown\", this.viewMousedownHandler);\n    this.pmView.dom.removeEventListener(\"mouseup\", this.viewMouseupHandler);\n    this.pmView.dom.removeEventListener(\"dragstart\", this.dragHandler);\n    this.pmView.dom.removeEventListener(\"dragover\", this.dragHandler);\n\n    this.pmView.root.removeEventListener(\"scroll\", this.scrollHandler, true);\n  }\n\n  closeMenu = () => {\n    if (this.state?.show) {\n      this.state.show = false;\n      this.emitUpdate();\n    }\n  };\n\n  getSelectionBoundingBox() {\n    const { state } = this.pmView;\n    const { selection } = state;\n\n    // support for CellSelections\n    const { ranges } = selection;\n    const from = Math.min(...ranges.map((range) => range.$from.pos));\n    const to = Math.max(...ranges.map((range) => range.$to.pos));\n\n    if (isNodeSelection(selection)) {\n      const node = this.pmView.nodeDOM(from) as HTMLElement;\n\n      if (node) {\n        return node.getBoundingClientRect();\n      }\n    }\n\n    return posToDOMRect(this.pmView, from, to);\n  }\n}\n\nexport const formattingToolbarPluginKey = new PluginKey(\n  \"FormattingToolbarPlugin\"\n);\n\nexport class FormattingToolbarProsemirrorPlugin extends EventEmitter<any> {\n  private view: FormattingToolbarView | undefined;\n  public readonly plugin: Plugin;\n\n  constructor(editor: BlockNoteEditor<any, any, any>) {\n    super();\n    this.plugin = new Plugin({\n      key: formattingToolbarPluginKey,\n      view: (editorView) => {\n        this.view = new FormattingToolbarView(editor, editorView, (state) => {\n          this.emit(\"update\", state);\n        });\n        return this.view;\n      },\n      props: {\n        handleKeyDown: (_view, event: KeyboardEvent) => {\n          if (event.key === \"Escape\" && this.shown) {\n            this.view!.closeMenu();\n            return true;\n          }\n          return false;\n        },\n      },\n    });\n  }\n\n  public get shown() {\n    return this.view?.state?.show || false;\n  }\n\n  public onUpdate(callback: (state: FormattingToolbarState) => void) {\n    return this.on(\"update\", callback);\n  }\n\n  public closeMenu = () => this.view!.closeMenu();\n}\n","import { getMarkRange, posToDOMRect, Range } from \"@tiptap/core\";\nimport { EditorView } from \"@tiptap/pm/view\";\nimport { Mark } from \"prosemirror-model\";\nimport { Plugin, PluginKey, PluginView } from \"prosemirror-state\";\n\nimport type { BlockNoteEditor } from \"../../editor/BlockNoteEditor\";\nimport { UiElementPosition } from \"../../extensions-shared/UiElementPosition\";\nimport { BlockSchema, InlineContentSchema, StyleSchema } from \"../../schema\";\nimport { EventEmitter } from \"../../util/EventEmitter\";\n\nexport type LinkToolbarState = UiElementPosition & {\n  // The hovered link's URL, and the text it's displayed with in the\n  // editor.\n  url: string;\n  text: string;\n};\n\nclass LinkToolbarView implements PluginView {\n  public state?: LinkToolbarState;\n  public emitUpdate: () => void;\n\n  menuUpdateTimer: ReturnType<typeof setTimeout> | undefined;\n  startMenuUpdateTimer: () => void;\n  stopMenuUpdateTimer: () => void;\n\n  mouseHoveredLinkMark: Mark | undefined;\n  mouseHoveredLinkMarkRange: Range | undefined;\n\n  keyboardHoveredLinkMark: Mark | undefined;\n  keyboardHoveredLinkMarkRange: Range | undefined;\n\n  linkMark: Mark | undefined;\n  linkMarkRange: Range | undefined;\n\n  constructor(\n    private readonly editor: BlockNoteEditor<any, any, any>,\n    private readonly pmView: EditorView,\n    emitUpdate: (state: LinkToolbarState) => void\n  ) {\n    this.emitUpdate = () => {\n      if (!this.state) {\n        throw new Error(\"Attempting to update uninitialized link toolbar\");\n      }\n\n      emitUpdate(this.state);\n    };\n\n    this.startMenuUpdateTimer = () => {\n      this.menuUpdateTimer = setTimeout(() => {\n        this.update();\n      }, 250);\n    };\n\n    this.stopMenuUpdateTimer = () => {\n      if (this.menuUpdateTimer) {\n        clearTimeout(this.menuUpdateTimer);\n        this.menuUpdateTimer = undefined;\n      }\n\n      return false;\n    };\n\n    this.pmView.dom.addEventListener(\"mouseover\", this.mouseOverHandler);\n    this.pmView.root.addEventListener(\n      \"click\",\n      this.clickHandler as EventListener,\n      true\n    );\n\n    // Setting capture=true ensures that any parent container of the editor that\n    // gets scrolled will trigger the scroll event. Scroll events do not bubble\n    // and so won't propagate to the document by default.\n    this.pmView.root.addEventListener(\"scroll\", this.scrollHandler, true);\n  }\n\n  mouseOverHandler = (event: MouseEvent) => {\n    // Resets the link mark currently hovered by the mouse cursor.\n    this.mouseHoveredLinkMark = undefined;\n    this.mouseHoveredLinkMarkRange = undefined;\n\n    this.stopMenuUpdateTimer();\n\n    if (\n      event.target instanceof HTMLAnchorElement &&\n      event.target.nodeName === \"A\"\n    ) {\n      // Finds link mark at the hovered element's position to update mouseHoveredLinkMark and\n      // mouseHoveredLinkMarkRange.\n      const hoveredLinkElement = event.target;\n      const posInHoveredLinkMark =\n        this.pmView.posAtDOM(hoveredLinkElement, 0) + 1;\n      const resolvedPosInHoveredLinkMark =\n        this.pmView.state.doc.resolve(posInHoveredLinkMark);\n      const marksAtPos = resolvedPosInHoveredLinkMark.marks();\n\n      for (const mark of marksAtPos) {\n        if (\n          mark.type.name === this.pmView.state.schema.mark(\"link\").type.name\n        ) {\n          this.mouseHoveredLinkMark = mark;\n          this.mouseHoveredLinkMarkRange =\n            getMarkRange(resolvedPosInHoveredLinkMark, mark.type, mark.attrs) ||\n            undefined;\n\n          break;\n        }\n      }\n    }\n\n    this.startMenuUpdateTimer();\n\n    return false;\n  };\n\n  clickHandler = (event: MouseEvent) => {\n    const editorWrapper = this.pmView.dom.parentElement!;\n\n    if (\n      // Toolbar is open.\n      this.linkMark &&\n      // An element is clicked.\n      event &&\n      event.target &&\n      // The clicked element is not the editor.\n      !(\n        editorWrapper === (event.target as Node) ||\n        editorWrapper.contains(event.target as Node)\n      )\n    ) {\n      if (this.state?.show) {\n        this.state.show = false;\n        this.emitUpdate();\n      }\n    }\n  };\n\n  scrollHandler = () => {\n    if (this.linkMark !== undefined) {\n      if (this.state?.show) {\n        this.state.referencePos = posToDOMRect(\n          this.pmView,\n          this.linkMarkRange!.from,\n          this.linkMarkRange!.to\n        );\n        this.emitUpdate();\n      }\n    }\n  };\n\n  editLink(url: string, text: string) {\n    const tr = this.pmView.state.tr.insertText(\n      text,\n      this.linkMarkRange!.from,\n      this.linkMarkRange!.to\n    );\n    tr.addMark(\n      this.linkMarkRange!.from,\n      this.linkMarkRange!.from + text.length,\n      this.pmView.state.schema.mark(\"link\", { href: url })\n    );\n    this.pmView.dispatch(tr);\n    this.pmView.focus();\n\n    if (this.state?.show) {\n      this.state.show = false;\n      this.emitUpdate();\n    }\n  }\n\n  deleteLink() {\n    this.pmView.dispatch(\n      this.pmView.state.tr\n        .removeMark(\n          this.linkMarkRange!.from,\n          this.linkMarkRange!.to,\n          this.linkMark!.type\n        )\n        .setMeta(\"preventAutolink\", true)\n    );\n    this.pmView.focus();\n\n    if (this.state?.show) {\n      this.state.show = false;\n      this.emitUpdate();\n    }\n  }\n\n  update() {\n    if (!this.pmView.hasFocus()) {\n      return;\n    }\n\n    // Saves the currently hovered link mark before it's updated.\n    const prevLinkMark = this.linkMark;\n\n    // Resets the currently hovered link mark.\n    this.linkMark = undefined;\n    this.linkMarkRange = undefined;\n\n    // Resets the link mark currently hovered by the keyboard cursor.\n    this.keyboardHoveredLinkMark = undefined;\n    this.keyboardHoveredLinkMarkRange = undefined;\n\n    // Finds link mark at the editor selection's position to update keyboardHoveredLinkMark and\n    // keyboardHoveredLinkMarkRange.\n    if (this.pmView.state.selection.empty) {\n      const marksAtPos = this.pmView.state.selection.$from.marks();\n\n      for (const mark of marksAtPos) {\n        if (\n          mark.type.name === this.pmView.state.schema.mark(\"link\").type.name\n        ) {\n          this.keyboardHoveredLinkMark = mark;\n          this.keyboardHoveredLinkMarkRange =\n            getMarkRange(\n              this.pmView.state.selection.$from,\n              mark.type,\n              mark.attrs\n            ) || undefined;\n\n          break;\n        }\n      }\n    }\n\n    if (this.mouseHoveredLinkMark) {\n      this.linkMark = this.mouseHoveredLinkMark;\n      this.linkMarkRange = this.mouseHoveredLinkMarkRange;\n    }\n\n    // Keyboard cursor position takes precedence over mouse hovered link.\n    if (this.keyboardHoveredLinkMark) {\n      this.linkMark = this.keyboardHoveredLinkMark;\n      this.linkMarkRange = this.keyboardHoveredLinkMarkRange;\n    }\n\n    if (this.linkMark && this.editor.isEditable) {\n      this.state = {\n        show: true,\n        referencePos: posToDOMRect(\n          this.pmView,\n          this.linkMarkRange!.from,\n          this.linkMarkRange!.to\n        ),\n        url: this.linkMark!.attrs.href,\n        text: this.pmView.state.doc.textBetween(\n          this.linkMarkRange!.from,\n          this.linkMarkRange!.to\n        ),\n      };\n      this.emitUpdate();\n\n      return;\n    }\n\n    // Hides menu.\n    if (\n      this.state?.show &&\n      prevLinkMark &&\n      (!this.linkMark || !this.editor.isEditable)\n    ) {\n      this.state.show = false;\n      this.emitUpdate();\n\n      return;\n    }\n  }\n\n  closeMenu = () => {\n    if (this.state?.show) {\n      this.state.show = false;\n      this.emitUpdate();\n    }\n  };\n\n  destroy() {\n    this.pmView.dom.removeEventListener(\"mouseover\", this.mouseOverHandler);\n    this.pmView.root.removeEventListener(\"scroll\", this.scrollHandler, true);\n    this.pmView.root.removeEventListener(\n      \"click\",\n      this.clickHandler as EventListener,\n      true\n    );\n  }\n}\n\nexport const linkToolbarPluginKey = new PluginKey(\"LinkToolbarPlugin\");\n\nexport class LinkToolbarProsemirrorPlugin<\n  BSchema extends BlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n> extends EventEmitter<any> {\n  private view: LinkToolbarView | undefined;\n  public readonly plugin: Plugin;\n\n  constructor(editor: BlockNoteEditor<BSchema, I, S>) {\n    super();\n    this.plugin = new Plugin({\n      key: linkToolbarPluginKey,\n      view: (editorView) => {\n        this.view = new LinkToolbarView(editor, editorView, (state) => {\n          this.emit(\"update\", state);\n        });\n        return this.view;\n      },\n      props: {\n        handleKeyDown: (_view, event: KeyboardEvent) => {\n          if (event.key === \"Escape\" && this.shown) {\n            this.view!.closeMenu();\n            return true;\n          }\n          return false;\n        },\n      },\n    });\n  }\n\n  public onUpdate(callback: (state: LinkToolbarState) => void) {\n    return this.on(\"update\", callback);\n  }\n\n  /**\n   * Edit the currently hovered link.\n   */\n  public editLink = (url: string, text: string) => {\n    this.view!.editLink(url, text);\n  };\n\n  /**\n   * Delete the currently hovered link.\n   */\n  public deleteLink = () => {\n    this.view!.deleteLink();\n  };\n\n  /**\n   * When hovering on/off links using the mouse cursor, the link toolbar will\n   * open & close with a delay.\n   *\n   * This function starts the delay timer, and should be used for when the mouse\n   * cursor enters the link toolbar.\n   */\n  public startHideTimer = () => {\n    this.view!.startMenuUpdateTimer();\n  };\n\n  /**\n   * When hovering on/off links using the mouse cursor, the link toolbar will\n   * open & close with a delay.\n   *\n   * This function stops the delay timer, and should be used for when the mouse\n   * cursor exits the link toolbar.\n   */\n  public stopHideTimer = () => {\n    this.view!.stopMenuUpdateTimer();\n  };\n\n  public get shown() {\n    return this.view?.state?.show || false;\n  }\n\n  public closeMenu = () => this.view!.closeMenu();\n}\n","import { findParentNode } from \"@tiptap/core\";\nimport { EditorState, Plugin, PluginKey } from \"prosemirror-state\";\nimport { Decoration, DecorationSet, EditorView } from \"prosemirror-view\";\n\nimport type { BlockNoteEditor } from \"../../editor/BlockNoteEditor\";\nimport { UiElementPosition } from \"../../extensions-shared/UiElementPosition\";\nimport { BlockSchema, InlineContentSchema, StyleSchema } from \"../../schema\";\nimport { EventEmitter } from \"../../util/EventEmitter\";\n\nconst findBlock = findParentNode((node) => node.type.name === \"blockContainer\");\n\nexport type SuggestionMenuState = UiElementPosition & {\n  query: string;\n};\n\nclass SuggestionMenuView<\n  BSchema extends BlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n> {\n  public state?: SuggestionMenuState;\n  public emitUpdate: (triggerCharacter: string) => void;\n  private rootEl?: Document | ShadowRoot;\n  pluginState: SuggestionPluginState;\n\n  constructor(\n    private readonly editor: BlockNoteEditor<BSchema, I, S>,\n    emitUpdate: (menuName: string, state: SuggestionMenuState) => void\n  ) {\n    this.pluginState = undefined;\n\n    this.emitUpdate = (menuName: string) => {\n      if (!this.state) {\n        throw new Error(\"Attempting to update uninitialized suggestions menu\");\n      }\n\n      emitUpdate(menuName, this.state);\n    };\n\n    this.rootEl = this.editor._tiptapEditor.view.root;\n\n    // Setting capture=true ensures that any parent container of the editor that\n    // gets scrolled will trigger the scroll event. Scroll events do not bubble\n    // and so won't propagate to the document by default.\n    this.rootEl.addEventListener(\"scroll\", this.handleScroll, true);\n  }\n\n  handleScroll = () => {\n    if (this.state?.show) {\n      const decorationNode = this.rootEl?.querySelector(\n        `[data-decoration-id=\"${this.pluginState!.decorationId}\"]`\n      );\n      this.state.referencePos = decorationNode!.getBoundingClientRect();\n      this.emitUpdate(this.pluginState!.triggerCharacter!);\n    }\n  };\n\n  update(view: EditorView, prevState: EditorState) {\n    const prev: SuggestionPluginState =\n      suggestionMenuPluginKey.getState(prevState);\n    const next: SuggestionPluginState = suggestionMenuPluginKey.getState(\n      view.state\n    );\n\n    // See how the state changed\n    const started = prev === undefined && next !== undefined;\n    const stopped = prev !== undefined && next === undefined;\n    const changed = prev !== undefined && next !== undefined;\n\n    // Cancel when suggestion isn't active\n    if (!started && !changed && !stopped) {\n      return;\n    }\n\n    this.pluginState = stopped ? prev : next;\n\n    if (stopped || !this.editor.isEditable) {\n      this.state!.show = false;\n      this.emitUpdate(this.pluginState!.triggerCharacter);\n\n      return;\n    }\n\n    const decorationNode = this.rootEl?.querySelector(\n      `[data-decoration-id=\"${this.pluginState!.decorationId}\"]`\n    );\n\n    if (this.editor.isEditable) {\n      this.state = {\n        show: true,\n        referencePos: decorationNode!.getBoundingClientRect(),\n        query: this.pluginState!.query,\n      };\n\n      this.emitUpdate(this.pluginState!.triggerCharacter!);\n    }\n  }\n\n  destroy() {\n    this.rootEl?.removeEventListener(\"scroll\", this.handleScroll, true);\n  }\n\n  closeMenu = () => {\n    this.editor._tiptapEditor.view.dispatch(\n      this.editor._tiptapEditor.view.state.tr.setMeta(\n        suggestionMenuPluginKey,\n        null\n      )\n    );\n  };\n\n  clearQuery = () => {\n    if (this.pluginState === undefined) {\n      return;\n    }\n\n    this.editor._tiptapEditor\n      .chain()\n      .focus()\n      .deleteRange({\n        from:\n          this.pluginState.queryStartPos! -\n          (this.pluginState.fromUserInput\n            ? this.pluginState.triggerCharacter!.length\n            : 0),\n        to: this.editor._tiptapEditor.state.selection.from,\n      })\n      .run();\n  };\n}\n\ntype SuggestionPluginState =\n  | {\n      triggerCharacter: string;\n      fromUserInput: boolean;\n      queryStartPos: number;\n      query: string;\n      decorationId: string;\n    }\n  | undefined;\n\nexport const suggestionMenuPluginKey = new PluginKey(\"SuggestionMenuPlugin\");\n\n/**\n * A ProseMirror plugin for suggestions, designed to make '/'-commands possible as well as mentions.\n *\n * This is basically a simplified version of TipTap's [Suggestions](https://github.com/ueberdosis/tiptap/tree/db92a9b313c5993b723c85cd30256f1d4a0b65e1/packages/suggestion) plugin.\n *\n * This version is adapted from the aforementioned version in the following ways:\n * - This version supports generic items instead of only strings (to allow for more advanced filtering for example)\n * - This version hides some unnecessary complexity from the user of the plugin.\n * - This version handles key events differently\n */\nexport class SuggestionMenuProseMirrorPlugin<\n  BSchema extends BlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n> extends EventEmitter<any> {\n  private view: SuggestionMenuView<BSchema, I, S> | undefined;\n  public readonly plugin: Plugin;\n\n  private triggerCharacters: string[] = [];\n\n  constructor(editor: BlockNoteEditor<BSchema, I, S>) {\n    super();\n    const triggerCharacters = this.triggerCharacters;\n    this.plugin = new Plugin({\n      key: suggestionMenuPluginKey,\n\n      view: () => {\n        this.view = new SuggestionMenuView<BSchema, I, S>(\n          editor,\n          (triggerCharacter, state) => {\n            this.emit(`update ${triggerCharacter}`, state);\n          }\n        );\n        return this.view;\n      },\n\n      state: {\n        // Initialize the plugin's internal state.\n        init(): SuggestionPluginState {\n          return undefined;\n        },\n\n        // Apply changes to the plugin state from an editor transaction.\n        apply(transaction, prev, _oldState, newState): SuggestionPluginState {\n          // TODO: More clearly define which transactions should be ignored.\n          if (transaction.getMeta(\"orderedListIndexing\") !== undefined) {\n            return prev;\n          }\n\n          // Either contains the trigger character if the menu should be shown,\n          // or null if it should be hidden.\n          const suggestionPluginTransactionMeta: {\n            triggerCharacter: string;\n            fromUserInput?: boolean;\n          } | null = transaction.getMeta(suggestionMenuPluginKey);\n\n          // Only opens a menu of no menu is already open\n          if (\n            typeof suggestionPluginTransactionMeta === \"object\" &&\n            suggestionPluginTransactionMeta !== null &&\n            prev === undefined\n          ) {\n            return {\n              triggerCharacter:\n                suggestionPluginTransactionMeta.triggerCharacter,\n              fromUserInput:\n                suggestionPluginTransactionMeta.fromUserInput !== false,\n              queryStartPos: newState.selection.from,\n              query: \"\",\n              decorationId: `id_${Math.floor(Math.random() * 0xffffffff)}`,\n            };\n          }\n\n          // Checks if the menu is hidden, in which case it doesn't need to be hidden or updated.\n          if (prev === undefined) {\n            return prev;\n          }\n\n          // Checks if the menu should be hidden.\n          if (\n            // Highlighting text should hide the menu.\n            newState.selection.from !== newState.selection.to ||\n            // Transactions with plugin metadata should hide the menu.\n            suggestionPluginTransactionMeta === null ||\n            // Certain mouse events should hide the menu.\n            // TODO: Change to global mousedown listener.\n            transaction.getMeta(\"focus\") ||\n            transaction.getMeta(\"blur\") ||\n            transaction.getMeta(\"pointer\") ||\n            // Moving the caret before the character which triggered the menu should hide it.\n            (prev.triggerCharacter !== undefined &&\n              newState.selection.from < prev.queryStartPos!)\n          ) {\n            return undefined;\n          }\n\n          const next = { ...prev };\n\n          // Updates the current query.\n          next.query = newState.doc.textBetween(\n            prev.queryStartPos!,\n            newState.selection.from\n          );\n\n          return next;\n        },\n      },\n\n      props: {\n        handleTextInput(view, _from, _to, text) {\n          const suggestionPluginState: SuggestionPluginState = (\n            this as Plugin\n          ).getState(view.state);\n\n          if (\n            triggerCharacters.includes(text) &&\n            suggestionPluginState === undefined\n          ) {\n            view.dispatch(\n              view.state.tr\n                .insertText(text)\n                .scrollIntoView()\n                .setMeta(suggestionMenuPluginKey, {\n                  triggerCharacter: text,\n                })\n            );\n\n            return true;\n          }\n          return false;\n        },\n\n        // Setup decorator on the currently active suggestion.\n        decorations(state) {\n          const suggestionPluginState: SuggestionPluginState = (\n            this as Plugin\n          ).getState(state);\n\n          if (suggestionPluginState === undefined) {\n            return null;\n          }\n\n          // If the menu was opened programmatically by another extension, it may not use a trigger character. In this\n          // case, the decoration is set on the whole block instead, as the decoration range would otherwise be empty.\n          if (!suggestionPluginState.fromUserInput) {\n            const blockNode = findBlock(state.selection);\n            if (blockNode) {\n              return DecorationSet.create(state.doc, [\n                Decoration.node(\n                  blockNode.pos,\n                  blockNode.pos + blockNode.node.nodeSize,\n                  {\n                    nodeName: \"span\",\n                    class: \"bn-suggestion-decorator\",\n                    \"data-decoration-id\": suggestionPluginState.decorationId,\n                  }\n                ),\n              ]);\n            }\n          }\n          // Creates an inline decoration around the trigger character.\n          return DecorationSet.create(state.doc, [\n            Decoration.inline(\n              suggestionPluginState.queryStartPos! -\n                suggestionPluginState.triggerCharacter!.length,\n              suggestionPluginState.queryStartPos!,\n              {\n                nodeName: \"span\",\n                class: \"bn-suggestion-decorator\",\n                \"data-decoration-id\": suggestionPluginState.decorationId,\n              }\n            ),\n          ]);\n        },\n      },\n    });\n  }\n\n  public onUpdate(\n    triggerCharacter: string,\n    callback: (state: SuggestionMenuState) => void\n  ) {\n    if (!this.triggerCharacters.includes(triggerCharacter)) {\n      this.addTriggerCharacter(triggerCharacter);\n    }\n    // TODO: be able to remove the triggerCharacter\n    return this.on(`update ${triggerCharacter}`, callback);\n  }\n\n  addTriggerCharacter = (triggerCharacter: string) => {\n    this.triggerCharacters.push(triggerCharacter);\n  };\n\n  // TODO: Should this be called automatically when listeners are removed?\n  removeTriggerCharacter = (triggerCharacter: string) => {\n    this.triggerCharacters = this.triggerCharacters.filter(\n      (c) => c !== triggerCharacter\n    );\n  };\n\n  closeMenu = () => this.view!.closeMenu();\n\n  clearQuery = () => this.view!.clearQuery();\n\n  public get shown() {\n    return this.view?.state?.show || false;\n  }\n}\n\nexport function createSuggestionMenu<\n  BSchema extends BlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(editor: BlockNoteEditor<BSchema, I, S>, triggerCharacter: string) {\n  editor.suggestionMenus.addTriggerCharacter(triggerCharacter);\n}\n","import { Fragment, Node, ResolvedPos, Slice } from \"prosemirror-model\";\nimport { Selection } from \"prosemirror-state\";\nimport { Mappable } from \"prosemirror-transform\";\n\n/**\n * This class represents an editor selection which spans multiple nodes/blocks. It's currently only used to allow users\n * to drag multiple blocks at the same time. Expects the selection anchor and head to be between nodes, i.e. just before\n * the first target node and just after the last, and that anchor and head are at the same nesting level.\n *\n * Partially based on ProseMirror's NodeSelection implementation:\n * (https://github.com/ProseMirror/prosemirror-state/blob/master/src/selection.ts)\n * MultipleNodeSelection differs from NodeSelection in the following ways:\n * 1. Stores which nodes are included in the selection instead of just a single node.\n * 2. Already expects the selection to start just before the first target node and ends just after the last, while a\n * NodeSelection automatically sets both anchor and head to just before the single target node.\n */\nexport class MultipleNodeSelection extends Selection {\n  nodes: Array<Node>;\n\n  constructor($anchor: ResolvedPos, $head: ResolvedPos) {\n    super($anchor, $head);\n\n    // Parent is at the same nesting level as anchor/head since they are just before/ just after target nodes.\n    const parentNode = $anchor.node();\n\n    this.nodes = [];\n    $anchor.doc.nodesBetween($anchor.pos, $head.pos, (node, _pos, parent) => {\n      if (parent !== null && parent.eq(parentNode)) {\n        this.nodes.push(node);\n        return false;\n      }\n      return;\n    });\n  }\n\n  static create(doc: Node, from: number, to = from): MultipleNodeSelection {\n    return new MultipleNodeSelection(doc.resolve(from), doc.resolve(to));\n  }\n\n  content(): Slice {\n    return new Slice(Fragment.from(this.nodes), 0, 0);\n  }\n\n  eq(selection: Selection): boolean {\n    if (!(selection instanceof MultipleNodeSelection)) {\n      return false;\n    }\n\n    if (this.nodes.length !== selection.nodes.length) {\n      return false;\n    }\n\n    if (this.from !== selection.from || this.to !== selection.to) {\n      return false;\n    }\n\n    for (let i = 0; i < this.nodes.length; i++) {\n      if (!this.nodes[i].eq(selection.nodes[i])) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  map(doc: Node, mapping: Mappable): Selection {\n    const fromResult = mapping.mapResult(this.from);\n    const toResult = mapping.mapResult(this.to);\n\n    if (toResult.deleted) {\n      return Selection.near(doc.resolve(fromResult.pos));\n    }\n\n    if (fromResult.deleted) {\n      return Selection.near(doc.resolve(toResult.pos));\n    }\n\n    return new MultipleNodeSelection(\n      doc.resolve(fromResult.pos),\n      doc.resolve(toResult.pos)\n    );\n  }\n\n  toJSON(): any {\n    return { type: \"node\", anchor: this.anchor, head: this.head };\n  }\n}\n","import { PluginView } from \"@tiptap/pm/state\";\nimport { Node } from \"prosemirror-model\";\nimport { NodeSelection, Plugin, PluginKey, Selection } from \"prosemirror-state\";\nimport { EditorView } from \"prosemirror-view\";\n\nimport { createExternalHTMLExporter } from \"../../api/exporters/html/externalHTMLExporter\";\nimport { createInternalHTMLSerializer } from \"../../api/exporters/html/internalHTMLSerializer\";\nimport { cleanHTMLToMarkdown } from \"../../api/exporters/markdown/markdownExporter\";\nimport { getBlockInfoFromPos } from \"../../api/getBlockInfoFromPos\";\nimport { Block } from \"../../blocks/defaultBlocks\";\nimport type { BlockNoteEditor } from \"../../editor/BlockNoteEditor\";\nimport { UiElementPosition } from \"../../extensions-shared/UiElementPosition\";\nimport { BlockSchema, InlineContentSchema, StyleSchema } from \"../../schema\";\nimport { EventEmitter } from \"../../util/EventEmitter\";\nimport { suggestionMenuPluginKey } from \"../SuggestionMenu/SuggestionPlugin\";\nimport { MultipleNodeSelection } from \"./MultipleNodeSelection\";\n\nlet dragImageElement: Element | undefined;\n\nexport type SideMenuState<\n  BSchema extends BlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n> = UiElementPosition & {\n  // The block that the side menu is attached to.\n  block: Block<BSchema, I, S>;\n};\n\nexport function getDraggableBlockFromElement(\n  element: Element,\n  view: EditorView\n) {\n  while (\n    element &&\n    element.parentElement &&\n    element.parentElement !== view.dom &&\n    !element.hasAttribute?.(\"data-id\")\n  ) {\n    element = element.parentElement;\n  }\n  if (!element.hasAttribute(\"data-id\")) {\n    return undefined;\n  }\n  return { node: element as HTMLElement, id: element.getAttribute(\"data-id\")! };\n}\n\nfunction blockPositionFromElement(element: Element, view: EditorView) {\n  const block = getDraggableBlockFromElement(element, view);\n\n  if (block && block.node.nodeType === 1) {\n    // TODO: this uses undocumented PM APIs? do we need this / let's add docs?\n    const docView = (view as any).docView;\n    const desc = docView.nearestDesc(block.node, true);\n    if (!desc || desc === docView) {\n      return null;\n    }\n    return desc.posBefore;\n  }\n  return null;\n}\n\nfunction blockPositionsFromSelection(selection: Selection, doc: Node) {\n  // Absolute positions just before the first block spanned by the selection, and just after the last block. Having the\n  // selection start and end just before and just after the target blocks ensures no whitespace/line breaks are left\n  // behind after dragging & dropping them.\n  let beforeFirstBlockPos: number;\n  let afterLastBlockPos: number;\n\n  // Even the user starts dragging blocks but drops them in the same place, the selection will still be moved just\n  // before & just after the blocks spanned by the selection, and therefore doesn't need to change if they try to drag\n  // the same blocks again. If this happens, the anchor & head move out of the block content node they were originally\n  // in. If the anchor should update but the head shouldn't and vice versa, it means the user selection is outside a\n  // block content node, which should never happen.\n  const selectionStartInBlockContent =\n    doc.resolve(selection.from).node().type.spec.group === \"blockContent\";\n  const selectionEndInBlockContent =\n    doc.resolve(selection.to).node().type.spec.group === \"blockContent\";\n\n  // Ensures that entire outermost nodes are selected if the selection spans multiple nesting levels.\n  const minDepth = Math.min(selection.$anchor.depth, selection.$head.depth);\n\n  if (selectionStartInBlockContent && selectionEndInBlockContent) {\n    // Absolute positions at the start of the first block in the selection and at the end of the last block. User\n    // selections will always start and end in block content nodes, but we want the start and end positions of their\n    // parent block nodes, which is why minDepth - 1 is used.\n    const startFirstBlockPos = selection.$from.start(minDepth - 1);\n    const endLastBlockPos = selection.$to.end(minDepth - 1);\n\n    // Shifting start and end positions by one moves them just outside the first and last selected blocks.\n    beforeFirstBlockPos = doc.resolve(startFirstBlockPos - 1).pos;\n    afterLastBlockPos = doc.resolve(endLastBlockPos + 1).pos;\n  } else {\n    beforeFirstBlockPos = selection.from;\n    afterLastBlockPos = selection.to;\n  }\n\n  return { from: beforeFirstBlockPos, to: afterLastBlockPos };\n}\n\nfunction setDragImage(view: EditorView, from: number, to = from) {\n  if (from === to) {\n    // Moves to position to be just after the first (and only) selected block.\n    to += view.state.doc.resolve(from + 1).node().nodeSize;\n  }\n\n  // Parent element is cloned to remove all unselected children without affecting the editor content.\n  const parentClone = view.domAtPos(from).node.cloneNode(true) as Element;\n  const parent = view.domAtPos(from).node as Element;\n\n  const getElementIndex = (parentElement: Element, targetElement: Element) =>\n    Array.prototype.indexOf.call(parentElement.children, targetElement);\n\n  const firstSelectedBlockIndex = getElementIndex(\n    parent,\n    // Expects from position to be just before the first selected block.\n    view.domAtPos(from + 1).node.parentElement!\n  );\n  const lastSelectedBlockIndex = getElementIndex(\n    parent,\n    // Expects to position to be just after the last selected block.\n    view.domAtPos(to - 1).node.parentElement!\n  );\n\n  for (let i = parent.childElementCount - 1; i >= 0; i--) {\n    if (i > lastSelectedBlockIndex || i < firstSelectedBlockIndex) {\n      parentClone.removeChild(parentClone.children[i]);\n    }\n  }\n\n  // dataTransfer.setDragImage(element) only works if element is attached to the DOM.\n  unsetDragImage(view.root);\n  dragImageElement = parentClone;\n\n  // TODO: This is hacky, need a better way of assigning classes to the editor so that they can also be applied to the\n  //  drag preview.\n  const classes = view.dom.className.split(\" \");\n  const inheritedClasses = classes\n    .filter(\n      (className) =>\n        className !== \"ProseMirror\" &&\n        className !== \"bn-root\" &&\n        className !== \"bn-editor\"\n    )\n    .join(\" \");\n\n  dragImageElement.className =\n    dragImageElement.className + \" bn-drag-preview \" + inheritedClasses;\n\n  if (view.root instanceof ShadowRoot) {\n    view.root.appendChild(dragImageElement);\n  } else {\n    view.root.body.appendChild(dragImageElement);\n  }\n}\n\nfunction unsetDragImage(rootEl: Document | ShadowRoot) {\n  if (dragImageElement !== undefined) {\n    if (rootEl instanceof ShadowRoot) {\n      rootEl.removeChild(dragImageElement);\n    } else {\n      rootEl.body.appendChild(dragImageElement);\n    }\n\n    dragImageElement = undefined;\n  }\n}\n\nfunction dragStart<\n  BSchema extends BlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(\n  e: { dataTransfer: DataTransfer | null; clientY: number },\n  editor: BlockNoteEditor<BSchema, I, S>\n) {\n  if (!e.dataTransfer) {\n    return;\n  }\n\n  const view = editor.prosemirrorView;\n\n  const editorBoundingBox = view.dom.getBoundingClientRect();\n\n  const coords = {\n    left: editorBoundingBox.left + editorBoundingBox.width / 2, // take middle of editor\n    top: e.clientY,\n  };\n\n  const elements = view.root.elementsFromPoint(coords.left, coords.top);\n  let blockEl = undefined;\n\n  for (const element of elements) {\n    if (view.dom.contains(element)) {\n      blockEl = getDraggableBlockFromElement(element, view);\n      break;\n    }\n  }\n\n  if (!blockEl) {\n    return;\n  }\n\n  const pos = blockPositionFromElement(blockEl.node, view);\n  if (pos != null) {\n    const selection = view.state.selection;\n    const doc = view.state.doc;\n\n    const { from, to } = blockPositionsFromSelection(selection, doc);\n\n    const draggedBlockInSelection = from <= pos && pos < to;\n    const multipleBlocksSelected =\n      selection.$anchor.node() !== selection.$head.node() ||\n      selection instanceof MultipleNodeSelection;\n\n    if (draggedBlockInSelection && multipleBlocksSelected) {\n      view.dispatch(\n        view.state.tr.setSelection(MultipleNodeSelection.create(doc, from, to))\n      );\n      setDragImage(view, from, to);\n    } else {\n      view.dispatch(\n        view.state.tr.setSelection(NodeSelection.create(view.state.doc, pos))\n      );\n      setDragImage(view, pos);\n    }\n\n    const selectedSlice = view.state.selection.content();\n    const schema = editor._tiptapEditor.schema;\n\n    const internalHTMLSerializer = createInternalHTMLSerializer(schema, editor);\n    const internalHTML = internalHTMLSerializer.serializeProseMirrorFragment(\n      selectedSlice.content\n    );\n\n    const externalHTMLExporter = createExternalHTMLExporter(schema, editor);\n    const externalHTML = externalHTMLExporter.exportProseMirrorFragment(\n      selectedSlice.content\n    );\n\n    const plainText = cleanHTMLToMarkdown(externalHTML);\n\n    e.dataTransfer.clearData();\n    e.dataTransfer.setData(\"blocknote/html\", internalHTML);\n    e.dataTransfer.setData(\"text/html\", externalHTML);\n    e.dataTransfer.setData(\"text/plain\", plainText);\n    e.dataTransfer.effectAllowed = \"move\";\n    e.dataTransfer.setDragImage(dragImageElement!, 0, 0);\n    view.dragging = { slice: selectedSlice, move: true };\n  }\n}\n\nexport class SideMenuView<\n  BSchema extends BlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n> implements PluginView\n{\n  public state?: SideMenuState<BSchema, I, S>;\n  public readonly emitUpdate: (state: SideMenuState<BSchema, I, S>) => void;\n\n  private needUpdate = false;\n  private mousePos: { x: number; y: number } | undefined;\n\n  // When true, the drag handle with be anchored at the same level as root elements\n  // When false, the drag handle with be just to the left of the element\n  // TODO: Is there any case where we want this to be false?\n  private horizontalPosAnchoredAtRoot: boolean;\n  private horizontalPosAnchor: number;\n\n  private hoveredBlock: HTMLElement | undefined;\n\n  // Used to check if currently dragged content comes from this editor instance.\n  public isDragging = false;\n\n  public menuFrozen = false;\n\n  constructor(\n    private readonly editor: BlockNoteEditor<BSchema, I, S>,\n    private readonly pmView: EditorView,\n    emitUpdate: (state: SideMenuState<BSchema, I, S>) => void\n  ) {\n    this.emitUpdate = () => {\n      if (!this.state) {\n        throw new Error(\"Attempting to update uninitialized side menu\");\n      }\n\n      emitUpdate(this.state);\n    };\n\n    this.horizontalPosAnchoredAtRoot = true;\n    this.horizontalPosAnchor = (\n      this.pmView.dom.firstChild! as HTMLElement\n    ).getBoundingClientRect().x;\n\n    this.pmView.root.addEventListener(\n      \"drop\",\n      this.onDrop as EventListener,\n      true\n    );\n    this.pmView.root.addEventListener(\n      \"dragover\",\n      this.onDragOver as EventListener\n    );\n    this.pmView.dom.addEventListener(\"dragstart\", this.onDragStart);\n\n    // Shows or updates menu position whenever the cursor moves, if the menu isn't frozen.\n    this.pmView.root.addEventListener(\n      \"mousemove\",\n      this.onMouseMove as EventListener,\n      true\n    );\n\n    // Unfreezes the menu whenever the user clicks.\n    this.pmView.dom.addEventListener(\"mousedown\", this.onMouseDown);\n    // Hides and unfreezes the menu whenever the user presses a key.\n    this.pmView.root.addEventListener(\n      \"keydown\",\n      this.onKeyDown as EventListener,\n      true\n    );\n\n    // Setting capture=true ensures that any parent container of the editor that\n    // gets scrolled will trigger the scroll event. Scroll events do not bubble\n    // and so won't propagate to the document by default.\n    this.pmView.root.addEventListener(\"scroll\", this.onScroll, true);\n  }\n\n  updateState = () => {\n    if (this.menuFrozen || !this.mousePos) {\n      return;\n    }\n\n    // Editor itself may have padding or other styling which affects\n    // size/position, so we get the boundingRect of the first child (i.e. the\n    // blockGroup that wraps all blocks in the editor) for more accurate side\n    // menu placement.\n    const editorBoundingBox = (\n      this.pmView.dom.firstChild! as HTMLElement\n    ).getBoundingClientRect();\n\n    this.horizontalPosAnchor = editorBoundingBox.x;\n\n    // Gets block at mouse cursor's vertical position.\n    const coords = {\n      left: editorBoundingBox.left + editorBoundingBox.width / 2, // take middle of editor\n      top: this.mousePos.y,\n    };\n\n    const elements = this.pmView.root.elementsFromPoint(\n      coords.left,\n      coords.top\n    );\n    let block = undefined;\n\n    for (const element of elements) {\n      if (this.pmView.dom.contains(element)) {\n        block = getDraggableBlockFromElement(element, this.pmView);\n        break;\n      }\n    }\n\n    // Closes the menu if the mouse cursor is beyond the editor vertically.\n    if (!block || !this.editor.isEditable) {\n      if (this.state?.show) {\n        this.state.show = false;\n        this.needUpdate = true;\n      }\n\n      return;\n    }\n\n    // Doesn't update if the menu is already open and the mouse cursor is still hovering the same block.\n    if (\n      this.state?.show &&\n      this.hoveredBlock?.hasAttribute(\"data-id\") &&\n      this.hoveredBlock?.getAttribute(\"data-id\") === block.id\n    ) {\n      return;\n    }\n\n    this.hoveredBlock = block.node;\n\n    // Gets the block's content node, which lets to ignore child blocks when determining the block menu's position.\n    const blockContent = block.node.firstChild as HTMLElement;\n\n    if (!blockContent) {\n      return;\n    }\n\n    // Shows or updates elements.\n    if (this.editor.isEditable) {\n      const blockContentBoundingBox = blockContent.getBoundingClientRect();\n\n      this.state = {\n        show: true,\n        referencePos: new DOMRect(\n          this.horizontalPosAnchoredAtRoot\n            ? this.horizontalPosAnchor\n            : blockContentBoundingBox.x,\n          blockContentBoundingBox.y,\n          blockContentBoundingBox.width,\n          blockContentBoundingBox.height\n        ),\n        block: this.editor.getBlock(\n          this.hoveredBlock!.getAttribute(\"data-id\")!\n        )!,\n      };\n      this.needUpdate = true;\n    }\n  };\n\n  /**\n   * Sets isDragging when dragging text.\n   */\n  onDragStart = () => {\n    this.isDragging = true;\n  };\n\n  /**\n   * If the event is outside the editor contents,\n   * we dispatch a fake event, so that we can still drop the content\n   * when dragging / dropping to the side of the editor\n   */\n  onDrop = (event: DragEvent) => {\n    this.editor._tiptapEditor.commands.blur();\n\n    if ((event as any).synthetic || !this.isDragging) {\n      return;\n    }\n\n    const pos = this.pmView.posAtCoords({\n      left: event.clientX,\n      top: event.clientY,\n    });\n\n    this.isDragging = false;\n\n    if (!pos || pos.inside === -1) {\n      const evt = new Event(\"drop\", event) as any;\n      const editorBoundingBox = (\n        this.pmView.dom.firstChild! as HTMLElement\n      ).getBoundingClientRect();\n      evt.clientX = editorBoundingBox.left + editorBoundingBox.width / 2;\n      evt.clientY = event.clientY;\n      evt.dataTransfer = event.dataTransfer;\n      evt.preventDefault = () => event.preventDefault();\n      evt.synthetic = true; // prevent recursion\n      // console.log(\"dispatch fake drop\");\n      this.pmView.dom.dispatchEvent(evt);\n    }\n  };\n\n  /**\n   * If the event is outside the editor contents,\n   * we dispatch a fake event, so that we can still drop the content\n   * when dragging / dropping to the side of the editor\n   */\n  onDragOver = (event: DragEvent) => {\n    if ((event as any).synthetic || !this.isDragging) {\n      return;\n    }\n    const pos = this.pmView.posAtCoords({\n      left: event.clientX,\n      top: event.clientY,\n    });\n\n    if (!pos || pos.inside === -1) {\n      const evt = new Event(\"dragover\", event) as any;\n      const editorBoundingBox = (\n        this.pmView.dom.firstChild! as HTMLElement\n      ).getBoundingClientRect();\n      evt.clientX = editorBoundingBox.left + editorBoundingBox.width / 2;\n      evt.clientY = event.clientY;\n      evt.dataTransfer = event.dataTransfer;\n      evt.preventDefault = () => event.preventDefault();\n      evt.synthetic = true; // prevent recursion\n      // console.log(\"dispatch fake dragover\");\n      this.pmView.dom.dispatchEvent(evt);\n    }\n  };\n\n  onKeyDown = (_event: KeyboardEvent) => {\n    if (this.state?.show && this.editor.isFocused()) {\n      // Typing in editor should hide side menu\n      this.state.show = false;\n      this.emitUpdate(this.state);\n      this.menuFrozen = false;\n    }\n  };\n\n  onMouseDown = () => {\n    if (this.state && this.state.show && this.menuFrozen) {\n      this.menuFrozen = false;\n      this.state.show = false;\n      this.emitUpdate(this.state);\n    }\n  };\n\n  onMouseMove = (event: MouseEvent) => {\n    this.mousePos = { x: event.clientX, y: event.clientY };\n\n    // We want the full area of the editor to check if the cursor is hovering\n    // above it though.\n    const editorOuterBoundingBox = this.pmView.dom.getBoundingClientRect();\n    const cursorWithinEditor =\n      this.mousePos.x > editorOuterBoundingBox.left &&\n      this.mousePos.x < editorOuterBoundingBox.right &&\n      this.mousePos.y > editorOuterBoundingBox.top &&\n      this.mousePos.y < editorOuterBoundingBox.bottom;\n\n    const editorWrapper = this.pmView.dom.parentElement!;\n\n    // Doesn't update if the mouse hovers an element that's over the editor but\n    // isn't a part of it or the side menu.\n    if (\n      // Cursor is within the editor area\n      cursorWithinEditor &&\n      // An element is hovered\n      event &&\n      event.target &&\n      // Element is outside the editor\n      !(\n        editorWrapper === event.target ||\n        editorWrapper.contains(event.target as HTMLElement)\n      )\n    ) {\n      if (this.state?.show) {\n        this.state.show = false;\n        this.emitUpdate(this.state);\n      }\n\n      return;\n    }\n\n    this.updateState();\n\n    if (this.needUpdate) {\n      this.emitUpdate(this.state!);\n      this.needUpdate = false;\n    }\n  };\n\n  onScroll = () => {\n    if (this.state?.show) {\n      const blockContent = this.hoveredBlock!.firstChild as HTMLElement;\n      const blockContentBoundingBox = blockContent.getBoundingClientRect();\n\n      this.state.referencePos = new DOMRect(\n        this.horizontalPosAnchoredAtRoot\n          ? this.horizontalPosAnchor\n          : blockContentBoundingBox.x,\n        blockContentBoundingBox.y,\n        blockContentBoundingBox.width,\n        blockContentBoundingBox.height\n      );\n      this.emitUpdate(this.state);\n    }\n  };\n\n  // Needed in cases where the editor state updates without the mouse cursor\n  // moving, as some state updates can require a side menu update. For example,\n  // adding a button to the side menu which removes the block can cause the\n  // block below to jump up into the place of the removed block when clicked,\n  // allowing the user to click the button again without moving the cursor. This\n  // would otherwise not update the side menu, and so clicking the button again\n  // would attempt to remove the same block again, causing an error.\n  update() {\n    const prevBlockId = this.state?.block.id;\n\n    this.updateState();\n\n    if (this.needUpdate && this.state && prevBlockId !== this.state.block.id) {\n      this.emitUpdate(this.state);\n      this.needUpdate = false;\n    }\n  }\n\n  destroy() {\n    if (this.state?.show) {\n      this.state.show = false;\n      this.emitUpdate(this.state);\n    }\n    this.pmView.root.removeEventListener(\n      \"mousemove\",\n      this.onMouseMove as EventListener,\n      true\n    );\n    this.pmView.root.removeEventListener(\n      \"dragover\",\n      this.onDragOver as EventListener\n    );\n    this.pmView.dom.removeEventListener(\"dragstart\", this.onDragStart);\n    this.pmView.root.removeEventListener(\n      \"drop\",\n      this.onDrop as EventListener,\n      true\n    );\n    this.pmView.root.removeEventListener(\"scroll\", this.onScroll, true);\n    this.pmView.dom.removeEventListener(\"mousedown\", this.onMouseDown);\n    this.pmView.root.removeEventListener(\n      \"keydown\",\n      this.onKeyDown as EventListener,\n      true\n    );\n  }\n\n  addBlock() {\n    if (this.state?.show) {\n      this.state.show = false;\n      this.emitUpdate(this.state);\n    }\n\n    const blockContent = this.hoveredBlock!.firstChild! as HTMLElement;\n    const blockContentBoundingBox = blockContent.getBoundingClientRect();\n\n    const pos = this.pmView.posAtCoords({\n      left: blockContentBoundingBox.left + blockContentBoundingBox.width / 2,\n      top: blockContentBoundingBox.top + blockContentBoundingBox.height / 2,\n    });\n    if (!pos) {\n      return;\n    }\n\n    const blockInfo = getBlockInfoFromPos(\n      this.editor._tiptapEditor.state.doc,\n      pos.pos\n    );\n    if (blockInfo === undefined) {\n      return;\n    }\n\n    const { contentNode, startPos, endPos } = blockInfo;\n\n    // Creates a new block if current one is not empty for the suggestion menu to open in.\n    if (\n      contentNode.type.spec.content !== \"inline*\" ||\n      contentNode.textContent.length !== 0\n    ) {\n      const newBlockInsertionPos = endPos + 1;\n      const newBlockContentPos = newBlockInsertionPos + 2;\n\n      this.editor._tiptapEditor\n        .chain()\n        .BNCreateBlock(newBlockInsertionPos)\n        // .BNUpdateBlock(newBlockContentPos, { type: \"paragraph\", props: {} })\n        .setTextSelection(newBlockContentPos)\n        .run();\n    } else {\n      this.editor._tiptapEditor.commands.setTextSelection(startPos + 1);\n    }\n\n    // Focuses and activates the suggestion menu.\n    this.pmView.focus();\n    this.pmView.dispatch(\n      this.pmView.state.tr.scrollIntoView().setMeta(suggestionMenuPluginKey, {\n        triggerCharacter: \"/\",\n        fromUserInput: false,\n      })\n    );\n  }\n}\n\nexport const sideMenuPluginKey = new PluginKey(\"SideMenuPlugin\");\n\nexport class SideMenuProsemirrorPlugin<\n  BSchema extends BlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n> extends EventEmitter<any> {\n  public view: SideMenuView<BSchema, I, S> | undefined;\n  public readonly plugin: Plugin;\n\n  constructor(private readonly editor: BlockNoteEditor<BSchema, I, S>) {\n    super();\n    this.plugin = new Plugin({\n      key: sideMenuPluginKey,\n      view: (editorView) => {\n        this.view = new SideMenuView(editor, editorView, (state) => {\n          this.emit(\"update\", state);\n        });\n        return this.view;\n      },\n    });\n  }\n\n  public onUpdate(callback: (state: SideMenuState<BSchema, I, S>) => void) {\n    return this.on(\"update\", callback);\n  }\n\n  /**\n   * If the block is empty, opens the slash menu. If the block has content,\n   * creates a new block below and opens the slash menu in it.\n   */\n  addBlock = () => this.view!.addBlock();\n\n  /**\n   * Handles drag & drop events for blocks.\n   */\n  blockDragStart = (event: {\n    dataTransfer: DataTransfer | null;\n    clientY: number;\n  }) => {\n    this.view!.isDragging = true;\n    dragStart(event, this.editor);\n  };\n\n  /**\n   * Handles drag & drop events for blocks.\n   */\n  blockDragEnd = () => unsetDragImage(this.editor.prosemirrorView.root);\n  /**\n   * Freezes the side menu. When frozen, the side menu will stay\n   * attached to the same block regardless of which block is hovered by the\n   * mouse cursor.\n   */\n  freezeMenu = () => (this.view!.menuFrozen = true);\n  /**\n   * Unfreezes the side menu. When frozen, the side menu will stay\n   * attached to the same block regardless of which block is hovered by the\n   * mouse cursor.\n   */\n  unfreezeMenu = () => {\n    this.view!.menuFrozen = false;\n    this.view!.state!.show = false;\n    this.view!.emitUpdate(this.view!.state!);\n  };\n}\n","import { Plugin, PluginKey, PluginView } from \"prosemirror-state\";\nimport { Decoration, DecorationSet, EditorView } from \"prosemirror-view\";\nimport { nodeToBlock } from \"../../api/nodeConversions/nodeConversions\";\nimport { Block, DefaultBlockSchema } from \"../../blocks/defaultBlocks\";\nimport type { BlockNoteEditor } from \"../../editor/BlockNoteEditor\";\nimport {\n  BlockFromConfigNoChildren,\n  BlockSchemaWithBlock,\n  InlineContentSchema,\n  StyleSchema,\n} from \"../../schema\";\nimport { checkBlockIsDefaultType } from \"../../blocks/defaultBlockTypeGuards\";\nimport { EventEmitter } from \"../../util/EventEmitter\";\nimport { getDraggableBlockFromElement } from \"../SideMenu/SideMenuPlugin\";\n\nlet dragImageElement: HTMLElement | undefined;\n\nexport type TableHandlesState<\n  I extends InlineContentSchema,\n  S extends StyleSchema\n> = {\n  show: boolean;\n  referencePosCell: DOMRect;\n  referencePosTable: DOMRect;\n\n  block: BlockFromConfigNoChildren<DefaultBlockSchema[\"table\"], I, S>;\n  colIndex: number;\n  rowIndex: number;\n\n  draggingState:\n    | {\n        draggedCellOrientation: \"row\" | \"col\";\n        originalIndex: number;\n        mousePos: number;\n      }\n    | undefined;\n};\n\nfunction setHiddenDragImage(rootEl: Document | ShadowRoot) {\n  if (dragImageElement) {\n    return;\n  }\n\n  dragImageElement = document.createElement(\"div\");\n  dragImageElement.innerHTML = \"_\";\n  dragImageElement.style.opacity = \"0\";\n  dragImageElement.style.height = \"1px\";\n  dragImageElement.style.width = \"1px\";\n  if (rootEl instanceof Document) {\n    rootEl.body.appendChild(dragImageElement);\n  } else {\n    rootEl.appendChild(dragImageElement);\n  }\n}\n\nfunction unsetHiddenDragImage(rootEl: Document | ShadowRoot) {\n  if (dragImageElement) {\n    if (rootEl instanceof Document) {\n      rootEl.body.removeChild(dragImageElement);\n    } else {\n      rootEl.removeChild(dragImageElement);\n    }\n    dragImageElement = undefined;\n  }\n}\n\nfunction getChildIndex(node: Element) {\n  return Array.prototype.indexOf.call(node.parentElement!.childNodes, node);\n}\n\n// Finds the DOM element corresponding to the table cell that the target element\n// is currently in. If the target element is not in a table cell, returns null.\nfunction domCellAround(target: Element | null): Element | null {\n  while (target && target.nodeName !== \"TD\" && target.nodeName !== \"TH\") {\n    target =\n      target.classList && target.classList.contains(\"ProseMirror\")\n        ? null\n        : (target.parentNode as Element);\n  }\n  return target;\n}\n\n// Hides elements in the DOMwith the provided class names.\nfunction hideElementsWithClassNames(\n  classNames: string[],\n  rootEl: Document | ShadowRoot\n) {\n  classNames.forEach((className) => {\n    const elementsToHide = rootEl.querySelectorAll(className);\n\n    for (let i = 0; i < elementsToHide.length; i++) {\n      (elementsToHide[i] as HTMLElement).style.visibility = \"hidden\";\n    }\n  });\n}\n\nexport class TableHandlesView<\n  I extends InlineContentSchema,\n  S extends StyleSchema\n> implements PluginView\n{\n  public state?: TableHandlesState<I, S>;\n  public emitUpdate: () => void;\n\n  public tableId: string | undefined;\n  public tablePos: number | undefined;\n\n  public menuFrozen = false;\n\n  public prevWasEditable: boolean | null = null;\n\n  constructor(\n    private readonly editor: BlockNoteEditor<\n      BlockSchemaWithBlock<\"table\", DefaultBlockSchema[\"table\"]>,\n      I,\n      S\n    >,\n    private readonly pmView: EditorView,\n    emitUpdate: (state: TableHandlesState<I, S>) => void\n  ) {\n    this.emitUpdate = () => {\n      if (!this.state) {\n        throw new Error(\"Attempting to update uninitialized image toolbar\");\n      }\n\n      emitUpdate(this.state);\n    };\n\n    pmView.dom.addEventListener(\"mousemove\", this.mouseMoveHandler);\n\n    pmView.root.addEventListener(\n      \"dragover\",\n      this.dragOverHandler as EventListener\n    );\n    pmView.root.addEventListener(\"drop\", this.dropHandler as EventListener);\n\n    // Setting capture=true ensures that any parent container of the editor that\n    // gets scrolled will trigger the scroll event. Scroll events do not bubble\n    // and so won't propagate to the document by default.\n    pmView.root.addEventListener(\"scroll\", this.scrollHandler, true);\n  }\n\n  mouseMoveHandler = (event: MouseEvent) => {\n    if (this.menuFrozen) {\n      return;\n    }\n\n    const target = domCellAround(event.target as HTMLElement);\n\n    if (!target || !this.editor.isEditable) {\n      if (this.state?.show) {\n        this.state.show = false;\n        this.emitUpdate();\n      }\n      return;\n    }\n\n    const colIndex = getChildIndex(target);\n    const rowIndex = getChildIndex(target.parentElement!);\n    const cellRect = target.getBoundingClientRect();\n    const tableRect =\n      target.parentElement!.parentElement!.getBoundingClientRect();\n\n    const blockEl = getDraggableBlockFromElement(target, this.pmView);\n    if (!blockEl) {\n      return;\n    }\n\n    let tableBlock: Block<any, any, any> | undefined = undefined;\n\n    // Copied from `getBlock`. We don't use `getBlock` since we also need the PM\n    // node for the table, so we would effectively be doing the same work twice.\n    this.editor._tiptapEditor.state.doc.descendants((node, pos) => {\n      if (typeof tableBlock !== \"undefined\") {\n        return false;\n      }\n\n      if (node.type.name !== \"blockContainer\" || node.attrs.id !== blockEl.id) {\n        return true;\n      }\n\n      const block = nodeToBlock(\n        node,\n        this.editor.schema.blockSchema,\n        this.editor.schema.inlineContentSchema,\n        this.editor.schema.styleSchema,\n        this.editor.blockCache\n      );\n\n      if (checkBlockIsDefaultType(\"table\", block, this.editor)) {\n        this.tablePos = pos + 1;\n        tableBlock = block;\n      }\n\n      return false;\n    });\n\n    if (!tableBlock) {\n      return;\n    }\n\n    this.tableId = blockEl.id;\n\n    if (\n      this.state !== undefined &&\n      this.state.show &&\n      this.tableId === blockEl.id &&\n      this.state.rowIndex === rowIndex &&\n      this.state.colIndex === colIndex\n    ) {\n      return;\n    }\n\n    this.state = {\n      show: true,\n      referencePosCell: cellRect,\n      referencePosTable: tableRect,\n\n      block: tableBlock,\n      colIndex: colIndex,\n      rowIndex: rowIndex,\n\n      draggingState: undefined,\n    };\n    this.emitUpdate();\n\n    return false;\n  };\n\n  dragOverHandler = (event: DragEvent) => {\n    if (this.state?.draggingState === undefined) {\n      return;\n    }\n\n    event.preventDefault();\n    event.dataTransfer!.dropEffect = \"move\";\n\n    hideElementsWithClassNames(\n      [\n        \"column-resize-handle\",\n        \"prosemirror-dropcursor-block\",\n        \"prosemirror-dropcursor-inline\",\n      ],\n      this.pmView.root\n    );\n\n    // The mouse cursor coordinates, bounded to the table's bounding box. The\n    // bounding box is shrunk by 1px on each side to ensure that the bounded\n    // coordinates are always inside a table cell.\n    const boundedMouseCoords = {\n      left: Math.min(\n        Math.max(event.clientX, this.state.referencePosTable.left + 1),\n        this.state.referencePosTable.right - 1\n      ),\n      top: Math.min(\n        Math.max(event.clientY, this.state.referencePosTable.top + 1),\n        this.state.referencePosTable.bottom - 1\n      ),\n    };\n\n    // Gets the table cell element that the bounded mouse cursor coordinates lie\n    // in.\n    const tableCellElements = this.pmView.root\n      .elementsFromPoint(boundedMouseCoords.left, boundedMouseCoords.top)\n      .filter(\n        (element) => element.tagName === \"TD\" || element.tagName === \"TH\"\n      );\n    if (tableCellElements.length === 0) {\n      throw new Error(\n        \"Could not find table cell element that the mouse cursor is hovering over.\"\n      );\n    }\n    const tableCellElement = tableCellElements[0];\n\n    let emitStateUpdate = false;\n\n    // Gets current row and column index.\n    const rowIndex = getChildIndex(tableCellElement.parentElement!);\n    const colIndex = getChildIndex(tableCellElement);\n\n    // Checks if the drop cursor needs to be updated. This affects decorations\n    // only so it doesn't trigger a state update.\n    const oldIndex =\n      this.state.draggingState.draggedCellOrientation === \"row\"\n        ? this.state.rowIndex\n        : this.state.colIndex;\n    const newIndex =\n      this.state.draggingState.draggedCellOrientation === \"row\"\n        ? rowIndex\n        : colIndex;\n    const dispatchDecorationsTransaction = newIndex !== oldIndex;\n\n    // Checks if either the hovered cell has changed and updates the row and\n    // column index. Also updates the reference DOMRect.\n    if (this.state.rowIndex !== rowIndex || this.state.colIndex !== colIndex) {\n      this.state.rowIndex = rowIndex;\n      this.state.colIndex = colIndex;\n\n      this.state.referencePosCell = tableCellElement.getBoundingClientRect();\n\n      emitStateUpdate = true;\n    }\n\n    // Checks if the mouse cursor position along the axis that the user is\n    // dragging on has changed and updates it.\n    const mousePos =\n      this.state.draggingState.draggedCellOrientation === \"row\"\n        ? boundedMouseCoords.top\n        : boundedMouseCoords.left;\n    if (this.state.draggingState.mousePos !== mousePos) {\n      this.state.draggingState.mousePos = mousePos;\n\n      emitStateUpdate = true;\n    }\n\n    // Emits a state update if any of the fields have changed.\n    if (emitStateUpdate) {\n      this.emitUpdate();\n    }\n\n    // Dispatches a dummy transaction to force a decorations update if\n    // necessary.\n    if (dispatchDecorationsTransaction) {\n      this.pmView.dispatch(\n        this.pmView.state.tr.setMeta(tableHandlesPluginKey, true)\n      );\n    }\n  };\n\n  dropHandler = (event: DragEvent) => {\n    if (this.state === undefined || this.state.draggingState === undefined) {\n      return;\n    }\n\n    event.preventDefault();\n\n    const rows = this.state.block.content.rows;\n\n    if (this.state.draggingState.draggedCellOrientation === \"row\") {\n      const rowToMove = rows[this.state.draggingState.originalIndex];\n      rows.splice(this.state.draggingState.originalIndex, 1);\n      rows.splice(this.state.rowIndex, 0, rowToMove);\n    } else {\n      const cellsToMove = rows.map(\n        (row) => row.cells[this.state!.draggingState!.originalIndex]\n      );\n      rows.forEach((row, rowIndex) => {\n        row.cells.splice(this.state!.draggingState!.originalIndex, 1);\n        row.cells.splice(this.state!.colIndex, 0, cellsToMove[rowIndex]);\n      });\n    }\n\n    this.editor.updateBlock(this.state.block, {\n      type: \"table\",\n      content: {\n        type: \"tableContent\",\n        rows: rows,\n      },\n    });\n  };\n\n  scrollHandler = () => {\n    if (this.state?.show) {\n      const tableElement = this.pmView.root.querySelector(\n        `[data-node-type=\"blockContainer\"][data-id=\"${this.tableId}\"] table`\n      )!;\n      const cellElement = tableElement.querySelector(\n        `tr:nth-child(${this.state.rowIndex + 1}) > td:nth-child(${\n          this.state.colIndex + 1\n        })`\n      )!;\n\n      this.state.referencePosTable = tableElement.getBoundingClientRect();\n      this.state.referencePosCell = cellElement.getBoundingClientRect();\n      this.emitUpdate();\n    }\n  };\n\n  destroy() {\n    this.pmView.dom.removeEventListener(\"mousemove\", this.mouseMoveHandler);\n    this.pmView.root.removeEventListener(\n      \"dragover\",\n      this.dragOverHandler as EventListener\n    );\n    this.pmView.root.removeEventListener(\n      \"drop\",\n      this.dropHandler as EventListener\n    );\n    this.pmView.root.removeEventListener(\"scroll\", this.scrollHandler, true);\n  }\n}\n\nexport const tableHandlesPluginKey = new PluginKey(\"TableHandlesPlugin\");\n\nexport class TableHandlesProsemirrorPlugin<\n  I extends InlineContentSchema,\n  S extends StyleSchema\n> extends EventEmitter<any> {\n  private view: TableHandlesView<I, S> | undefined;\n  public readonly plugin: Plugin;\n\n  constructor(\n    private readonly editor: BlockNoteEditor<\n      BlockSchemaWithBlock<\"table\", DefaultBlockSchema[\"table\"]>,\n      I,\n      S\n    >\n  ) {\n    super();\n    this.plugin = new Plugin({\n      key: tableHandlesPluginKey,\n      view: (editorView) => {\n        this.view = new TableHandlesView(editor, editorView, (state) => {\n          this.emit(\"update\", state);\n        });\n        return this.view;\n      },\n      // We use decorations to render the drop cursor when dragging a table row\n      // or column. The decorations are updated in the `dragOverHandler` method.\n      props: {\n        decorations: (state) => {\n          if (\n            this.view === undefined ||\n            this.view.state === undefined ||\n            this.view.state.draggingState === undefined ||\n            this.view.tablePos === undefined\n          ) {\n            return;\n          }\n\n          const newIndex =\n            this.view.state.draggingState.draggedCellOrientation === \"row\"\n              ? this.view.state.rowIndex\n              : this.view.state.colIndex;\n\n          const decorations: Decoration[] = [];\n\n          if (newIndex === this.view.state.draggingState.originalIndex) {\n            return DecorationSet.create(state.doc, decorations);\n          }\n\n          // Gets the table to show the drop cursor in.\n          const tableResolvedPos = state.doc.resolve(this.view.tablePos + 1);\n          const tableNode = tableResolvedPos.node();\n\n          if (this.view.state.draggingState.draggedCellOrientation === \"row\") {\n            // Gets the row at the new index.\n            const rowResolvedPos = state.doc.resolve(\n              tableResolvedPos.posAtIndex(newIndex) + 1\n            );\n            const rowNode = rowResolvedPos.node();\n\n            // Iterates over all cells in the row.\n            for (let i = 0; i < rowNode.childCount; i++) {\n              // Gets each cell in the row.\n              const cellResolvedPos = state.doc.resolve(\n                rowResolvedPos.posAtIndex(i) + 1\n              );\n              const cellNode = cellResolvedPos.node();\n\n              // Creates a decoration at the start or end of each cell,\n              // depending on whether the new index is before or after the\n              // original index.\n              const decorationPos =\n                cellResolvedPos.pos +\n                (newIndex > this.view.state.draggingState.originalIndex\n                  ? cellNode.nodeSize - 2\n                  : 0);\n              decorations.push(\n                // The widget is a small bar which spans the width of the cell.\n                Decoration.widget(decorationPos, () => {\n                  const widget = document.createElement(\"div\");\n                  widget.className = \"bn-table-drop-cursor\";\n                  widget.style.left = \"0\";\n                  widget.style.right = \"0\";\n                  // This is only necessary because the drop indicator's height\n                  // is an even number of pixels, whereas the border between\n                  // table cells is an odd number of pixels. So this makes the\n                  // positioning slightly more consistent regardless of where\n                  // the row is being dropped.\n                  if (\n                    newIndex > this.view!.state!.draggingState!.originalIndex\n                  ) {\n                    widget.style.bottom = \"-2px\";\n                  } else {\n                    widget.style.top = \"-3px\";\n                  }\n                  widget.style.height = \"4px\";\n\n                  return widget;\n                })\n              );\n            }\n          } else {\n            // Iterates over all rows in the table.\n            for (let i = 0; i < tableNode.childCount; i++) {\n              // Gets each row in the table.\n              const rowResolvedPos = state.doc.resolve(\n                tableResolvedPos.posAtIndex(i) + 1\n              );\n\n              // Gets the cell at the new index in the row.\n              const cellResolvedPos = state.doc.resolve(\n                rowResolvedPos.posAtIndex(newIndex) + 1\n              );\n              const cellNode = cellResolvedPos.node();\n\n              // Creates a decoration at the start or end of each cell,\n              // depending on whether the new index is before or after the\n              // original index.\n              const decorationPos =\n                cellResolvedPos.pos +\n                (newIndex > this.view.state.draggingState.originalIndex\n                  ? cellNode.nodeSize - 2\n                  : 0);\n              decorations.push(\n                // The widget is a small bar which spans the height of the cell.\n                Decoration.widget(decorationPos, () => {\n                  const widget = document.createElement(\"div\");\n                  widget.className = \"bn-table-drop-cursor\";\n                  widget.style.top = \"0\";\n                  widget.style.bottom = \"0\";\n                  // This is only necessary because the drop indicator's width\n                  // is an even number of pixels, whereas the border between\n                  // table cells is an odd number of pixels. So this makes the\n                  // positioning slightly more consistent regardless of where\n                  // the column is being dropped.\n                  if (\n                    newIndex > this.view!.state!.draggingState!.originalIndex\n                  ) {\n                    widget.style.right = \"-2px\";\n                  } else {\n                    widget.style.left = \"-3px\";\n                  }\n                  widget.style.width = \"4px\";\n\n                  return widget;\n                })\n              );\n            }\n          }\n\n          return DecorationSet.create(state.doc, decorations);\n        },\n      },\n    });\n  }\n\n  public onUpdate(callback: (state: TableHandlesState<I, S>) => void) {\n    return this.on(\"update\", callback);\n  }\n\n  /**\n   * Callback that should be set on the `dragStart` event for whichever element\n   * is used as the column drag handle.\n   */\n  colDragStart = (event: {\n    dataTransfer: DataTransfer | null;\n    clientX: number;\n  }) => {\n    if (this.view!.state === undefined) {\n      throw new Error(\n        \"Attempted to drag table column, but no table block was hovered prior.\"\n      );\n    }\n\n    this.view!.state.draggingState = {\n      draggedCellOrientation: \"col\",\n      originalIndex: this.view!.state.colIndex,\n      mousePos: event.clientX,\n    };\n    this.view!.emitUpdate();\n\n    this.editor._tiptapEditor.view.dispatch(\n      this.editor._tiptapEditor.state.tr.setMeta(tableHandlesPluginKey, {\n        draggedCellOrientation:\n          this.view!.state.draggingState.draggedCellOrientation,\n        originalIndex: this.view!.state.colIndex,\n        newIndex: this.view!.state.colIndex,\n        tablePos: this.view!.tablePos,\n      })\n    );\n\n    setHiddenDragImage(this.editor._tiptapEditor.view.root);\n    event.dataTransfer!.setDragImage(dragImageElement!, 0, 0);\n    event.dataTransfer!.effectAllowed = \"move\";\n  };\n\n  /**\n   * Callback that should be set on the `dragStart` event for whichever element\n   * is used as the row drag handle.\n   */\n  rowDragStart = (event: {\n    dataTransfer: DataTransfer | null;\n    clientY: number;\n  }) => {\n    if (this.view!.state === undefined) {\n      throw new Error(\n        \"Attempted to drag table row, but no table block was hovered prior.\"\n      );\n    }\n\n    this.view!.state.draggingState = {\n      draggedCellOrientation: \"row\",\n      originalIndex: this.view!.state.rowIndex,\n      mousePos: event.clientY,\n    };\n    this.view!.emitUpdate();\n\n    this.editor._tiptapEditor.view.dispatch(\n      this.editor._tiptapEditor.state.tr.setMeta(tableHandlesPluginKey, {\n        draggedCellOrientation:\n          this.view!.state.draggingState.draggedCellOrientation,\n        originalIndex: this.view!.state.rowIndex,\n        newIndex: this.view!.state.rowIndex,\n        tablePos: this.view!.tablePos,\n      })\n    );\n\n    setHiddenDragImage(this.editor._tiptapEditor.view.root);\n    event.dataTransfer!.setDragImage(dragImageElement!, 0, 0);\n    event.dataTransfer!.effectAllowed = \"copyMove\";\n  };\n\n  /**\n   * Callback that should be set on the `dragEnd` event for both the element\n   * used as the row drag handle, and the one used as the column drag handle.\n   */\n  dragEnd = () => {\n    if (this.view!.state === undefined) {\n      throw new Error(\n        \"Attempted to drag table row, but no table block was hovered prior.\"\n      );\n    }\n\n    this.view!.state.draggingState = undefined;\n    this.view!.emitUpdate();\n\n    this.editor._tiptapEditor.view.dispatch(\n      this.editor._tiptapEditor.state.tr.setMeta(tableHandlesPluginKey, null)\n    );\n\n    unsetHiddenDragImage(this.editor._tiptapEditor.view.root);\n  };\n\n  /**\n   * Freezes the drag handles. When frozen, they will stay attached to the same\n   * cell regardless of which cell is hovered by the mouse cursor.\n   */\n  freezeHandles = () => {\n    this.view!.menuFrozen = true;\n  };\n\n  /**\n   * Unfreezes the drag handles. When frozen, they will stay attached to the\n   * same cell regardless of which cell is hovered by the mouse cursor.\n   */\n  unfreezeHandles = () => {\n    this.view!.menuFrozen = false;\n  };\n}\n","import { Extension } from \"@tiptap/core\";\nimport { NodeSelection, Plugin } from \"prosemirror-state\";\nimport { Node } from \"prosemirror-model\";\n\nimport type { BlockNoteEditor } from \"../../editor/BlockNoteEditor\";\nimport { BlockSchema, InlineContentSchema, StyleSchema } from \"../../schema\";\nimport { createExternalHTMLExporter } from \"./html/externalHTMLExporter\";\nimport { createInternalHTMLSerializer } from \"./html/internalHTMLSerializer\";\nimport { cleanHTMLToMarkdown } from \"./markdown/markdownExporter\";\nimport { EditorView } from \"prosemirror-view\";\n\nfunction selectedFragmentToHTML<\n  BSchema extends BlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(\n  view: EditorView,\n  editor: BlockNoteEditor<BSchema, I, S>\n): {\n  internalHTML: string;\n  externalHTML: string;\n  plainText: string;\n} {\n  const selectedFragment = view.state.selection.content().content;\n\n  const internalHTMLSerializer = createInternalHTMLSerializer(\n    view.state.schema,\n    editor\n  );\n  const internalHTML =\n    internalHTMLSerializer.serializeProseMirrorFragment(selectedFragment);\n\n  const externalHTMLExporter = createExternalHTMLExporter(\n    view.state.schema,\n    editor\n  );\n  const externalHTML =\n    externalHTMLExporter.exportProseMirrorFragment(selectedFragment);\n\n  const plainText = cleanHTMLToMarkdown(externalHTML);\n\n  return { internalHTML, externalHTML, plainText };\n}\n\nexport const createCopyToClipboardExtension = <\n  BSchema extends BlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(\n  editor: BlockNoteEditor<BSchema, I, S>\n) =>\n  Extension.create<{ editor: BlockNoteEditor<BSchema, I, S> }, undefined>({\n    name: \"copyToClipboard\",\n    addProseMirrorPlugins() {\n      return [\n        new Plugin({\n          props: {\n            handleDOMEvents: {\n              copy(view, event) {\n                // Stops the default browser copy behaviour.\n                event.preventDefault();\n                event.clipboardData!.clearData();\n\n                // Checks if a `blockContent` node is being copied and expands\n                // the selection to the parent `blockContainer` node. This is\n                // for the use-case in which only a block without content is\n                // selected, e.g. an image block.\n                if (\n                  \"node\" in view.state.selection &&\n                  (view.state.selection.node as Node).type.spec.group ===\n                    \"blockContent\"\n                ) {\n                  view.dispatch(\n                    view.state.tr.setSelection(\n                      new NodeSelection(\n                        view.state.doc.resolve(view.state.selection.from - 1)\n                      )\n                    )\n                  );\n                }\n\n                const { internalHTML, externalHTML, plainText } =\n                  selectedFragmentToHTML(view, editor);\n\n                // TODO: Writing to other MIME types not working in Safari for\n                //  some reason.\n                event.clipboardData!.setData(\"blocknote/html\", internalHTML);\n                event.clipboardData!.setData(\"text/html\", externalHTML);\n                event.clipboardData!.setData(\"text/plain\", plainText);\n\n                // Prevent default PM handler to be called\n                return true;\n              },\n              // This is for the use-case in which only a block without content\n              // is selected, e.g. an image block, and dragged (not using the\n              // drag handle).\n              dragstart(view, event) {\n                // Checks if a `NodeSelection` is active.\n                if (!(\"node\" in view.state.selection)) {\n                  return;\n                }\n\n                // Checks if a `blockContent` node is being dragged.\n                if (\n                  (view.state.selection.node as Node).type.spec.group !==\n                  \"blockContent\"\n                ) {\n                  return;\n                }\n\n                // Expands the selection to the parent `blockContainer` node.\n                view.dispatch(\n                  view.state.tr.setSelection(\n                    new NodeSelection(\n                      view.state.doc.resolve(view.state.selection.from - 1)\n                    )\n                  )\n                );\n\n                // Stops the default browser drag start behaviour.\n                event.preventDefault();\n                event.dataTransfer!.clearData();\n\n                const { internalHTML, externalHTML, plainText } =\n                  selectedFragmentToHTML(view, editor);\n\n                // TODO: Writing to other MIME types not working in Safari for\n                //  some reason.\n                event.dataTransfer!.setData(\"blocknote/html\", internalHTML);\n                event.dataTransfer!.setData(\"text/html\", externalHTML);\n                event.dataTransfer!.setData(\"text/plain\", plainText);\n\n                // Prevent default PM handler to be called\n                return true;\n              },\n            },\n          },\n        }),\n      ];\n    },\n  });\n","import type { BlockNoteEditor } from \"../../editor/BlockNoteEditor\";\nimport { Block, PartialBlock } from \"../../blocks/defaultBlocks\";\nimport { checkDefaultBlockTypeInSchema } from \"../../blocks/defaultBlockTypeGuards\";\nimport {\n  BlockSchema,\n  InlineContentSchema,\n  isStyledTextInlineContent,\n  StyleSchema,\n} from \"../../schema\";\nimport { formatKeyboardShortcut } from \"../../util/browser\";\nimport { DefaultSuggestionItem } from \"./DefaultSuggestionItem\";\n\n// Sets the editor's text cursor position to the next content editable block,\n// so either a block with inline content or a table. The last block is always a\n// paragraph, so this function won't try to set the cursor position past the\n// last block.\nfunction setSelectionToNextContentEditableBlock<\n  BSchema extends BlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(editor: BlockNoteEditor<BSchema, I, S>) {\n  let block = editor.getTextCursorPosition().block;\n  let contentType = editor.schema.blockSchema[block.type].content;\n\n  while (contentType === \"none\") {\n    block = editor.getTextCursorPosition().nextBlock!;\n    contentType = editor.schema.blockSchema[block.type].content as\n      | \"inline\"\n      | \"table\"\n      | \"none\";\n    editor.setTextCursorPosition(block, \"end\");\n  }\n}\n\n// Checks if the current block is empty or only contains a slash, and if so,\n// updates the current block instead of inserting a new one below. If the new\n// block doesn't contain editable content, the cursor is moved to the next block\n// that does.\nexport function insertOrUpdateBlock<\n  BSchema extends BlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(\n  editor: BlockNoteEditor<BSchema, I, S>,\n  block: PartialBlock<BSchema, I, S>\n): Block<BSchema, I, S> {\n  const currentBlock = editor.getTextCursorPosition().block;\n\n  if (currentBlock.content === undefined) {\n    throw new Error(\"Slash Menu open in a block that doesn't contain content.\");\n  }\n\n  if (\n    Array.isArray(currentBlock.content) &&\n    ((currentBlock.content.length === 1 &&\n      isStyledTextInlineContent(currentBlock.content[0]) &&\n      currentBlock.content[0].type === \"text\" &&\n      currentBlock.content[0].text === \"/\") ||\n      currentBlock.content.length === 0)\n  ) {\n    editor.updateBlock(currentBlock, block);\n  } else {\n    editor.insertBlocks([block], currentBlock, \"after\");\n    editor.setTextCursorPosition(\n      editor.getTextCursorPosition().nextBlock!,\n      \"end\"\n    );\n  }\n\n  const insertedBlock = editor.getTextCursorPosition().block;\n  setSelectionToNextContentEditableBlock(editor);\n\n  return insertedBlock;\n}\n\nexport function getDefaultSlashMenuItems<\n  BSchema extends BlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(editor: BlockNoteEditor<BSchema, I, S>) {\n  const items: DefaultSuggestionItem[] = [];\n\n  if (checkDefaultBlockTypeInSchema(\"heading\", editor)) {\n    items.push(\n      {\n        onItemClick: () => {\n          insertOrUpdateBlock(editor, {\n            type: \"heading\",\n            props: { level: 1 },\n          });\n        },\n        badge: formatKeyboardShortcut(\"Mod-Alt-1\"),\n        key: \"heading\",\n        ...editor.dictionary.slash_menu.heading,\n      },\n      {\n        onItemClick: () => {\n          insertOrUpdateBlock(editor, {\n            type: \"heading\",\n            props: { level: 2 },\n          });\n        },\n        badge: formatKeyboardShortcut(\"Mod-Alt-2\"),\n        key: \"heading_2\",\n        ...editor.dictionary.slash_menu.heading_2,\n      },\n      {\n        onItemClick: () => {\n          insertOrUpdateBlock(editor, {\n            type: \"heading\",\n            props: { level: 3 },\n          });\n        },\n        badge: formatKeyboardShortcut(\"Mod-Alt-3\"),\n        key: \"heading_3\",\n        ...editor.dictionary.slash_menu.heading_3,\n      }\n    );\n  }\n\n  if (checkDefaultBlockTypeInSchema(\"numberedListItem\", editor)) {\n    items.push({\n      onItemClick: () => {\n        insertOrUpdateBlock(editor, {\n          type: \"numberedListItem\",\n        });\n      },\n      badge: formatKeyboardShortcut(\"Mod-Shift-7\"),\n      key: \"numbered_list\",\n      ...editor.dictionary.slash_menu.numbered_list,\n    });\n  }\n\n  if (checkDefaultBlockTypeInSchema(\"bulletListItem\", editor)) {\n    items.push({\n      onItemClick: () => {\n        insertOrUpdateBlock(editor, {\n          type: \"bulletListItem\",\n        });\n      },\n      badge: formatKeyboardShortcut(\"Mod-Shift-8\"),\n      key: \"bullet_list\",\n      ...editor.dictionary.slash_menu.bullet_list,\n    });\n  }\n\n  if (checkDefaultBlockTypeInSchema(\"checkListItem\", editor)) {\n    items.push({\n      onItemClick: () => {\n        insertOrUpdateBlock(editor, {\n          type: \"checkListItem\",\n        });\n      },\n      badge: formatKeyboardShortcut(\"Mod-Shift-9\"),\n      key: \"check_list\",\n      ...editor.dictionary.slash_menu.check_list,\n    });\n  }\n\n  if (checkDefaultBlockTypeInSchema(\"paragraph\", editor)) {\n    items.push({\n      onItemClick: () => {\n        insertOrUpdateBlock(editor, {\n          type: \"paragraph\",\n        });\n      },\n      badge: formatKeyboardShortcut(\"Mod-Alt-0\"),\n      key: \"paragraph\",\n      ...editor.dictionary.slash_menu.paragraph,\n    });\n  }\n\n  if (checkDefaultBlockTypeInSchema(\"table\", editor)) {\n    items.push({\n      onItemClick: () => {\n        insertOrUpdateBlock(editor, {\n          type: \"table\",\n          content: {\n            type: \"tableContent\",\n            rows: [\n              {\n                cells: [\"\", \"\", \"\"],\n              },\n              {\n                cells: [\"\", \"\", \"\"],\n              },\n            ],\n          },\n        });\n      },\n      badge: undefined,\n      key: \"table\",\n      ...editor.dictionary.slash_menu.table,\n    });\n  }\n\n  if (checkDefaultBlockTypeInSchema(\"image\", editor)) {\n    items.push({\n      onItemClick: () => {\n        const insertedBlock = insertOrUpdateBlock(editor, {\n          type: \"image\",\n        });\n\n        // Immediately open the file toolbar\n        editor.prosemirrorView.dispatch(\n          editor._tiptapEditor.state.tr.setMeta(editor.filePanel!.plugin, {\n            block: insertedBlock,\n          })\n        );\n      },\n      key: \"image\",\n      ...editor.dictionary.slash_menu.image,\n    });\n  }\n\n  if (checkDefaultBlockTypeInSchema(\"video\", editor)) {\n    items.push({\n      onItemClick: () => {\n        const insertedBlock = insertOrUpdateBlock(editor, {\n          type: \"video\",\n        });\n\n        // Immediately open the file toolbar\n        editor.prosemirrorView.dispatch(\n          editor._tiptapEditor.state.tr.setMeta(editor.filePanel!.plugin, {\n            block: insertedBlock,\n          })\n        );\n      },\n      key: \"video\",\n      ...editor.dictionary.slash_menu.video,\n    });\n  }\n\n  if (checkDefaultBlockTypeInSchema(\"audio\", editor)) {\n    items.push({\n      onItemClick: () => {\n        const insertedBlock = insertOrUpdateBlock(editor, {\n          type: \"audio\",\n        });\n\n        // Immediately open the file toolbar\n        editor.prosemirrorView.dispatch(\n          editor._tiptapEditor.state.tr.setMeta(editor.filePanel!.plugin, {\n            block: insertedBlock,\n          })\n        );\n      },\n      key: \"audio\",\n      ...editor.dictionary.slash_menu.audio,\n    });\n  }\n\n  if (checkDefaultBlockTypeInSchema(\"file\", editor)) {\n    items.push({\n      onItemClick: () => {\n        const insertedBlock = insertOrUpdateBlock(editor, {\n          type: \"file\",\n        });\n\n        // Immediately open the file toolbar\n        editor.prosemirrorView.dispatch(\n          editor._tiptapEditor.state.tr.setMeta(editor.filePanel!.plugin, {\n            block: insertedBlock,\n          })\n        );\n      },\n      key: \"image\",\n      ...editor.dictionary.slash_menu.file,\n    });\n  }\n\n  return items;\n}\n\nexport function filterSuggestionItems<\n  T extends { title: string; aliases?: readonly string[] }\n>(items: T[], query: string) {\n  return items.filter(\n    ({ title, aliases }) =>\n      title.toLowerCase().includes(query.toLowerCase()) ||\n      (aliases &&\n        aliases.filter((alias) =>\n          alias.toLowerCase().includes(query.toLowerCase())\n        ).length !== 0)\n  );\n}\n","export const acceptedMIMETypes = [\n  \"blocknote/html\",\n  \"Files\",\n  \"text/html\",\n  \"text/plain\",\n] as const;\n","import type { BlockNoteEditor } from \"../../editor/BlockNoteEditor\";\nimport { PartialBlock } from \"../../blocks/defaultBlocks\";\nimport { insertOrUpdateBlock } from \"../../extensions/SuggestionMenu/getDefaultSlashMenuItems\";\nimport {\n  BlockSchema,\n  FileBlockConfig,\n  InlineContentSchema,\n  StyleSchema,\n} from \"../../schema\";\nimport { acceptedMIMETypes } from \"./acceptedMIMETypes\";\n\nfunction checkMIMETypesMatch(mimeType1: string, mimeType2: string) {\n  const types1 = mimeType1.split(\"/\");\n  const types2 = mimeType2.split(\"/\");\n\n  if (types1.length !== 2) {\n    throw new Error(`The string ${mimeType1} is not a valid MIME type.`);\n  }\n  if (types2.length !== 2) {\n    throw new Error(`The string ${mimeType2} is not a valid MIME type.`);\n  }\n\n  if (types1[1] === \"*\" || types2[1] === \"*\") {\n    return types1[0] === types2[0];\n  }\n  if (types1[0] === \"*\" || types2[0] === \"*\") {\n    return types1[1] === types2[1];\n  }\n\n  return types1[0] === types2[0] && types1[1] === types2[1];\n}\n\nexport async function handleFileInsertion<\n  BSchema extends BlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(event: DragEvent | ClipboardEvent, editor: BlockNoteEditor<BSchema, I, S>) {\n  if (!editor.uploadFile) {\n    return;\n  }\n\n  const dataTransfer =\n    \"dataTransfer\" in event ? event.dataTransfer : event.clipboardData;\n  if (dataTransfer === null) {\n    return;\n  }\n\n  let format: (typeof acceptedMIMETypes)[number] | null = null;\n  for (const mimeType of acceptedMIMETypes) {\n    if (dataTransfer.types.includes(mimeType)) {\n      format = mimeType;\n      break;\n    }\n  }\n  if (format !== \"Files\") {\n    return;\n  }\n\n  const items = dataTransfer.items;\n  if (!items) {\n    return;\n  }\n\n  event.preventDefault();\n\n  const fileBlockConfigs = Object.values(editor.schema.blockSchema).filter(\n    (blockConfig) => blockConfig.isFileBlock\n  ) as FileBlockConfig[];\n\n  for (let i = 0; i < items.length; i++) {\n    // Gets file block corresponding to MIME type.\n    let fileBlockType = \"file\";\n    for (const fileBlockConfig of fileBlockConfigs) {\n      for (const mimeType of fileBlockConfig.fileBlockAcceptMimeTypes || []) {\n        if (checkMIMETypesMatch(items[i].type, mimeType)) {\n          fileBlockType = fileBlockConfig.type;\n          break;\n        }\n      }\n    }\n\n    const file = items[i].getAsFile();\n    if (file) {\n      const updateData = await editor.uploadFile(file);\n\n      if (typeof updateData === \"string\") {\n        const fileBlock = {\n          type: fileBlockType,\n          props: {\n            name: file.name,\n            url: updateData,\n          },\n        } as PartialBlock<BSchema, I, S>;\n\n        insertOrUpdateBlock(editor, fileBlock);\n      }\n    }\n  }\n}\n","import { Extension } from \"@tiptap/core\";\nimport { Plugin } from \"prosemirror-state\";\n\nimport type { BlockNoteEditor } from \"../../editor/BlockNoteEditor\";\nimport { BlockSchema, InlineContentSchema, StyleSchema } from \"../../schema\";\nimport { handleFileInsertion } from \"./handleFileInsertion\";\nimport { nestedListsToBlockNoteStructure } from \"./html/util/nestedLists\";\nimport { acceptedMIMETypes } from \"./acceptedMIMETypes\";\n\nexport const createPasteFromClipboardExtension = <\n  BSchema extends BlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(\n  editor: BlockNoteEditor<BSchema, I, S>\n) =>\n  Extension.create<{ editor: BlockNoteEditor<BSchema, I, S> }, undefined>({\n    name: \"pasteFromClipboard\",\n    addProseMirrorPlugins() {\n      return [\n        new Plugin({\n          props: {\n            handleDOMEvents: {\n              paste(_view, event) {\n                event.preventDefault();\n\n                if (!editor.isEditable) {\n                  return;\n                }\n\n                let format: (typeof acceptedMIMETypes)[number] | null = null;\n                for (const mimeType of acceptedMIMETypes) {\n                  if (event.clipboardData!.types.includes(mimeType)) {\n                    format = mimeType;\n                    break;\n                  }\n                }\n                if (format === null) {\n                  return true;\n                }\n\n                if (format === \"Files\") {\n                  handleFileInsertion(event, editor);\n                  return true;\n                }\n\n                let data = event.clipboardData!.getData(format);\n\n                if (format === \"text/html\") {\n                  const htmlNode = nestedListsToBlockNoteStructure(data.trim());\n                  data = htmlNode.innerHTML;\n                }\n\n                editor._tiptapEditor.view.pasteHTML(data);\n\n                return true;\n              },\n            },\n          },\n        }),\n      ];\n    },\n  });\n","import { Extension } from \"@tiptap/core\";\nimport { Plugin } from \"prosemirror-state\";\n\nimport type { BlockNoteEditor } from \"../../editor/BlockNoteEditor\";\nimport { BlockSchema, InlineContentSchema, StyleSchema } from \"../../schema\";\nimport { handleFileInsertion } from \"./handleFileInsertion\";\nimport { acceptedMIMETypes } from \"./acceptedMIMETypes\";\n\nexport const createDropFileExtension = <\n  BSchema extends BlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(\n  editor: BlockNoteEditor<BSchema, I, S>\n) =>\n  Extension.create<{ editor: BlockNoteEditor<BSchema, I, S> }, undefined>({\n    name: \"dropFile\",\n    addProseMirrorPlugins() {\n      return [\n        new Plugin({\n          props: {\n            handleDOMEvents: {\n              drop(_view, event) {\n                if (!editor.isEditable) {\n                  return;\n                }\n\n                let format: (typeof acceptedMIMETypes)[number] | null = null;\n                for (const mimeType of acceptedMIMETypes) {\n                  if (event.dataTransfer!.types.includes(mimeType)) {\n                    format = mimeType;\n                    break;\n                  }\n                }\n                if (format === null) {\n                  return true;\n                }\n\n                if (format === \"Files\") {\n                  handleFileInsertion(event, editor);\n                  return true;\n                }\n\n                return false;\n              },\n            },\n          },\n        }),\n      ];\n    },\n  });\n","import { Extension } from \"@tiptap/core\";\nimport { defaultProps } from \"../../blocks/defaultProps\";\n\nexport const BackgroundColorExtension = Extension.create({\n  name: \"blockBackgroundColor\",\n\n  addGlobalAttributes() {\n    return [\n      {\n        types: [\"blockContainer\"],\n        attributes: {\n          backgroundColor: {\n            default: defaultProps.backgroundColor.default,\n            parseHTML: (element) =>\n              element.hasAttribute(\"data-background-color\")\n                ? element.getAttribute(\"data-background-color\")\n                : defaultProps.backgroundColor.default,\n            renderHTML: (attributes) =>\n              attributes.backgroundColor !==\n                defaultProps.backgroundColor.default && {\n                \"data-background-color\": attributes.backgroundColor,\n              },\n          },\n        },\n      },\n    ];\n  },\n});\n","import { Extension } from \"@tiptap/core\";\n\nexport const TextAlignmentExtension = Extension.create({\n  name: \"textAlignment\",\n\n  addGlobalAttributes() {\n    return [\n      {\n        // Attribute is applied to block content instead of container so that child blocks don't inherit the text\n        // alignment styling.\n        types: [\n          \"paragraph\",\n          \"heading\",\n          \"bulletListItem\",\n          \"numberedListItem\",\n          \"checkListItem\",\n        ],\n        attributes: {\n          textAlignment: {\n            default: \"left\",\n            parseHTML: (element) => {\n              return element.getAttribute(\"data-text-alignment\");\n            },\n            renderHTML: (attributes) =>\n              attributes.textAlignment !== \"left\" && {\n                \"data-text-alignment\": attributes.textAlignment,\n              },\n          },\n        },\n      },\n    ];\n  },\n});\n","import { Extension } from \"@tiptap/core\";\nimport { defaultProps } from \"../../blocks/defaultProps\";\n\nexport const TextColorExtension = Extension.create({\n  name: \"blockTextColor\",\n\n  addGlobalAttributes() {\n    return [\n      {\n        types: [\"blockContainer\"],\n        attributes: {\n          textColor: {\n            default: defaultProps.textColor.default,\n            parseHTML: (element) =>\n              element.hasAttribute(\"data-text-color\")\n                ? element.getAttribute(\"data-text-color\")\n                : defaultProps.textColor.default,\n            renderHTML: (attributes) =>\n              attributes.textColor !== defaultProps.textColor.default && {\n                \"data-text-color\": attributes.textColor,\n              },\n          },\n        },\n      },\n    ];\n  },\n});\n","import { Extension } from \"@tiptap/core\";\nimport { Plugin, PluginKey } from \"prosemirror-state\";\n\n// based on https://github.com/ueberdosis/tiptap/blob/40a9404c94c7fef7900610c195536384781ae101/demos/src/Experiments/TrailingNode/Vue/trailing-node.ts\n\n/**\n * Extension based on:\n * - https://github.com/ueberdosis/tiptap/blob/v1/packages/tiptap-extensions/src/extensions/TrailingNode.js\n * - https://github.com/remirror/remirror/blob/e0f1bec4a1e8073ce8f5500d62193e52321155b9/packages/prosemirror-trailing-node/src/trailing-node-plugin.ts\n */\n\nexport interface TrailingNodeOptions {\n  node: string;\n}\n\n/**\n * Add a trailing node to the document so the user can always click at the bottom of the document and start typing\n */\nexport const TrailingNode = Extension.create<TrailingNodeOptions>({\n  name: \"trailingNode\",\n\n  addProseMirrorPlugins() {\n    const plugin = new PluginKey(this.name);\n    // const disabledNodes = Object.entries(this.editor.schema.nodes)\n    //   .map(([, value]) => value)\n    //   .filter((node) => this.options.notAfter.includes(node.name));\n\n    return [\n      new Plugin({\n        key: plugin,\n        appendTransaction: (_, __, state) => {\n          const { doc, tr, schema } = state;\n          const shouldInsertNodeAtEnd = plugin.getState(state);\n          const endPosition = doc.content.size - 2;\n          const type = schema.nodes[\"blockContainer\"];\n          const contentType = schema.nodes[\"paragraph\"];\n          if (!shouldInsertNodeAtEnd) {\n            return;\n          }\n\n          return tr.insert(\n            endPosition,\n            type.create(undefined, contentType.create())\n          );\n        },\n        state: {\n          init: (_, _state) => {\n            // (maybe fix): use same logic as apply() here\n            // so it works when initializing\n          },\n          apply: (tr, value) => {\n            if (!tr.docChanged) {\n              return value;\n            }\n\n            let lastNode = tr.doc.lastChild;\n\n            if (!lastNode || lastNode.type.name !== \"blockGroup\") {\n              throw new Error(\"Expected blockGroup\");\n            }\n\n            lastNode = lastNode.lastChild;\n\n            if (!lastNode || lastNode.type.name !== \"blockContainer\") {\n              throw new Error(\"Expected blockContainer\");\n            }\n\n            const lastContentNode = lastNode.firstChild;\n\n            if (!lastContentNode) {\n              throw new Error(\"Expected blockContent\");\n            }\n\n            // If last node is not empty (size > 4) or it doesn't contain\n            // inline content, we need to add a trailing node.\n            return (\n              lastNode.nodeSize > 4 ||\n              lastContentNode.type.spec.content !== \"inline*\"\n            );\n          },\n        },\n      }),\n    ];\n  },\n});\n","import { Plugin, PluginKey, TextSelection } from \"prosemirror-state\";\n\nconst PLUGIN_KEY = new PluginKey(\"non-editable-block\");\n// By default, typing with a node selection active will cause ProseMirror to\n// replace the node with one that contains editable content. This plugin blocks\n// this behaviour without also blocking things like keyboard shortcuts:\n//\n// - Lets through key presses that do not include alphanumeric characters. This\n// includes things like backspace/delete/home/end/etc.\n// - Lets through any key presses that include ctrl/meta keys. These will be\n// shortcuts of some kind like ctrl+C/mod+C.\n// - Special case for Enter key which creates a new paragraph block below and\n// sets the selection to it. This is just to bring the UX closer to Notion\n//\n// While a more elegant solution would probably process transactions instead of\n// keystrokes, this brings us most of the way to Notion's UX without much added\n// complexity.\nexport const NonEditableBlockPlugin = () => {\n  return new Plugin({\n    key: PLUGIN_KEY,\n    props: {\n      handleKeyDown: (view, event) => {\n        // Checks for node selection\n        if (\"node\" in view.state.selection) {\n          // Checks if key press uses ctrl/meta modifier\n          if (event.ctrlKey || event.metaKey) {\n            return false;\n          }\n          // Checks if key press is alphanumeric\n          if (event.key.length === 1) {\n            event.preventDefault();\n\n            return true;\n          }\n          // Checks if key press is Enter\n          if (event.key === \"Enter\") {\n            const tr = view.state.tr;\n            view.dispatch(\n              tr\n                .insert(\n                  view.state.tr.selection.$to.after(),\n                  view.state.schema.nodes[\"paragraph\"].create()\n                )\n                .setSelection(\n                  new TextSelection(\n                    tr.doc.resolve(view.state.tr.selection.$to.after() + 1)\n                  )\n                )\n            );\n\n            return true;\n          }\n        }\n\n        return false;\n      },\n    },\n  });\n};\n","import { findChildren } from \"@tiptap/core\";\nimport { Plugin, PluginKey } from \"prosemirror-state\";\nimport { Decoration, DecorationSet } from \"prosemirror-view\";\n\nconst PLUGIN_KEY = new PluginKey(`previous-blocks`);\n\nconst nodeAttributes: Record<string, string> = {\n  // Numbered List Items\n  index: \"index\",\n  // Headings\n  level: \"level\",\n  // All Blocks\n  type: \"type\",\n  depth: \"depth\",\n  \"depth-change\": \"depth-change\",\n};\n\n/**\n * This plugin tracks transformation of Block node attributes, so we can support CSS transitions.\n *\n * Problem it solves: ProseMirror recreates the DOM when transactions happen. So when a transaction changes a Node attribute,\n * it results in a completely new DOM element. This means CSS transitions don't work.\n *\n * Solution: When attributes change on a node, this plugin sets a data-* attribute with the \"previous\" value. This way we can still use CSS transitions. (See block.module.css)\n */\nexport const PreviousBlockTypePlugin = () => {\n  let timeout: any;\n  return new Plugin({\n    key: PLUGIN_KEY,\n    view(_editorView) {\n      return {\n        update: async (view, _prevState) => {\n          if (this.key?.getState(view.state).updatedBlocks.size > 0) {\n            // use setTimeout 0 to clear the decorations so that at least\n            // for one DOM-render the decorations have been applied\n            timeout = setTimeout(() => {\n              view.dispatch(\n                view.state.tr.setMeta(PLUGIN_KEY, { clearUpdate: true })\n              );\n            }, 0);\n          }\n        },\n        destroy: () => {\n          if (timeout) {\n            clearTimeout(timeout);\n          }\n        },\n      };\n    },\n    state: {\n      init() {\n        return {\n          // Block attributes, by block ID, from just before the previous transaction.\n          prevTransactionOldBlockAttrs: {} as any,\n          // Block attributes, by block ID, from just before the current transaction.\n          currentTransactionOldBlockAttrs: {} as any,\n          // Set of IDs of blocks whose attributes changed from the current transaction.\n          updatedBlocks: new Set<string>(),\n        };\n      },\n\n      apply(transaction, prev, oldState, newState) {\n        prev.currentTransactionOldBlockAttrs = {};\n        prev.updatedBlocks.clear();\n\n        if (!transaction.docChanged || oldState.doc.eq(newState.doc)) {\n          return prev;\n        }\n\n        // TODO: Instead of iterating through the entire document, only check nodes affected by the transactions. Will\n        //  also probably require checking nodes affected by the previous transaction too.\n        // We didn't get this to work yet:\n        // const transform = combineTransactionSteps(oldState.doc, [transaction]);\n        // // const { mapping } = transform;\n        // const changes = getChangedRanges(transform);\n        //\n        // changes.forEach(({ oldRange, newRange }) => {\n        // const oldNodes = findChildrenInRange(\n        //   oldState.doc,\n        //   oldRange,\n        //   (node) => node.attrs.id\n        // );\n        //\n        // const newNodes = findChildrenInRange(\n        //   newState.doc,\n        //   newRange,\n        //   (node) => node.attrs.id\n        // );\n\n        const currentTransactionOriginalOldBlockAttrs = {} as any;\n\n        const oldNodes = findChildren(oldState.doc, (node) => node.attrs.id);\n        const oldNodesById = new Map(\n          oldNodes.map((node) => [node.node.attrs.id, node])\n        );\n        const newNodes = findChildren(newState.doc, (node) => node.attrs.id);\n\n        // Traverses all block containers in the new editor state.\n        for (const node of newNodes) {\n          const oldNode = oldNodesById.get(node.node.attrs.id);\n\n          const oldContentNode = oldNode?.node.firstChild;\n          const newContentNode = node.node.firstChild;\n\n          if (oldNode && oldContentNode && newContentNode) {\n            const newAttrs = {\n              index: newContentNode.attrs.index,\n              level: newContentNode.attrs.level,\n              type: newContentNode.type.name,\n              depth: newState.doc.resolve(node.pos).depth,\n            };\n\n            let oldAttrs = {\n              index: oldContentNode.attrs.index,\n              level: oldContentNode.attrs.level,\n              type: oldContentNode.type.name,\n              depth: oldState.doc.resolve(oldNode.pos).depth,\n            };\n\n            currentTransactionOriginalOldBlockAttrs[node.node.attrs.id] =\n              oldAttrs;\n\n            // Whenever a transaction is appended by the OrderedListItemIndexPlugin, it's given the metadata:\n            // { \"orderedListIndexing\": true }\n            // These appended transactions happen immediately after any transaction which causes ordered list item\n            // indices to require updating, including those which trigger animations. Therefore, these animations are\n            // immediately overridden when the PreviousBlockTypePlugin processes the appended transaction, despite only\n            // the listItemIndex attribute changing. To solve this, oldAttrs must be edited for transactions with the\n            // \"orderedListIndexing\" metadata, so the correct animation can be re-triggered.\n            if (transaction.getMeta(\"numberedListIndexing\")) {\n              // If the block existed before the transaction, gets the attributes from before the previous transaction\n              // (i.e. the transaction that caused list item indices to need updating).\n              if (node.node.attrs.id in prev.prevTransactionOldBlockAttrs) {\n                oldAttrs =\n                  prev.prevTransactionOldBlockAttrs[node.node.attrs.id];\n              }\n\n              // Stops list item indices themselves being animated (looks smoother), unless the block's content type is\n              // changing from a numbered list item to something else.\n              if (newAttrs.type === \"numberedListItem\") {\n                oldAttrs.index = newAttrs.index;\n              }\n            }\n\n            prev.currentTransactionOldBlockAttrs[node.node.attrs.id] = oldAttrs;\n\n            // TODO: faster deep equal?\n            if (JSON.stringify(oldAttrs) !== JSON.stringify(newAttrs)) {\n              (oldAttrs as any)[\"depth-change\"] =\n                oldAttrs.depth - newAttrs.depth;\n\n              // for debugging:\n              // console.log(\n              //   \"id:\",\n              //   node.node.attrs.id,\n              //   \"previousBlockTypePlugin changes detected, oldAttrs\",\n              //   oldAttrs,\n              //   \"new\",\n              //   newAttrs\n              // );\n\n              prev.updatedBlocks.add(node.node.attrs.id);\n            }\n          }\n        }\n\n        prev.prevTransactionOldBlockAttrs =\n          currentTransactionOriginalOldBlockAttrs;\n\n        return prev;\n      },\n    },\n    props: {\n      decorations(state) {\n        const pluginState = (this as Plugin).getState(state);\n        if (pluginState.updatedBlocks.size === 0) {\n          return undefined;\n        }\n\n        const decorations: Decoration[] = [];\n\n        state.doc.descendants((node, pos) => {\n          if (!node.attrs.id) {\n            return;\n          }\n\n          if (!pluginState.updatedBlocks.has(node.attrs.id)) {\n            return;\n          }\n\n          const prevAttrs =\n            pluginState.currentTransactionOldBlockAttrs[node.attrs.id];\n          const decorationAttrs: any = {};\n\n          for (const [nodeAttr, val] of Object.entries(prevAttrs)) {\n            decorationAttrs[\"data-prev-\" + nodeAttributes[nodeAttr]] =\n              val || \"none\";\n          }\n\n          // for debugging:\n          // console.log(\n          //   \"previousBlockTypePlugin committing decorations\",\n          //   decorationAttrs\n          // );\n\n          const decoration = Decoration.node(pos, pos + node.nodeSize, {\n            ...decorationAttrs,\n          });\n\n          decorations.push(decoration);\n        });\n\n        return DecorationSet.create(state.doc, decorations);\n      },\n    },\n  });\n};\n","import { Node } from \"@tiptap/core\";\nimport { Fragment, Node as PMNode, Slice } from \"prosemirror-model\";\nimport { NodeSelection, TextSelection } from \"prosemirror-state\";\n\nimport { getBlockInfoFromPos } from \"../api/getBlockInfoFromPos\";\nimport {\n  blockToNode,\n  inlineContentToNodes,\n  tableContentToNodes,\n} from \"../api/nodeConversions/nodeConversions\";\nimport { PartialBlock } from \"../blocks/defaultBlocks\";\nimport type { BlockNoteEditor } from \"../editor/BlockNoteEditor\";\nimport { NonEditableBlockPlugin } from \"../extensions/NonEditableBlocks/NonEditableBlockPlugin\";\nimport { PreviousBlockTypePlugin } from \"../extensions/PreviousBlockType/PreviousBlockTypePlugin\";\nimport {\n  BlockNoteDOMAttributes,\n  BlockSchema,\n  InlineContentSchema,\n  StyleSchema,\n} from \"../schema\";\nimport { mergeCSSClasses } from \"../util/browser\";\nimport { UnreachableCaseError } from \"../util/typescript\";\n\n// Object containing all possible block attributes.\nconst BlockAttributes: Record<string, string> = {\n  blockColor: \"data-block-color\",\n  blockStyle: \"data-block-style\",\n  id: \"data-id\",\n  depth: \"data-depth\",\n  depthChange: \"data-depth-change\",\n};\n\ndeclare module \"@tiptap/core\" {\n  interface Commands<ReturnType> {\n    block: {\n      BNCreateBlock: (pos: number) => ReturnType;\n      BNDeleteBlock: (posInBlock: number) => ReturnType;\n      BNMergeBlocks: (posBetweenBlocks: number) => ReturnType;\n      BNSplitBlock: (\n        posInBlock: number,\n        keepType?: boolean,\n        keepProps?: boolean\n      ) => ReturnType;\n      BNUpdateBlock: <\n        BSchema extends BlockSchema,\n        I extends InlineContentSchema,\n        S extends StyleSchema\n      >(\n        posInBlock: number,\n        block: PartialBlock<BSchema, I, S>\n      ) => ReturnType;\n      BNCreateOrUpdateBlock: <\n        BSchema extends BlockSchema,\n        I extends InlineContentSchema,\n        S extends StyleSchema\n      >(\n        posInBlock: number,\n        block: PartialBlock<BSchema, I, S>\n      ) => ReturnType;\n    };\n  }\n}\n\n/**\n * The main \"Block node\" documents consist of\n */\nexport const BlockContainer = Node.create<{\n  domAttributes?: BlockNoteDOMAttributes;\n  editor: BlockNoteEditor<any, any, any>;\n}>({\n  name: \"blockContainer\",\n  group: \"blockContainer\",\n  // A block always contains content, and optionally a blockGroup which contains nested blocks\n  content: \"blockContent blockGroup?\",\n  // Ensures content-specific keyboard handlers trigger first.\n  priority: 50,\n  defining: true,\n\n  parseHTML() {\n    return [\n      {\n        tag: \"div\",\n        getAttrs: (element) => {\n          if (typeof element === \"string\") {\n            return false;\n          }\n\n          const attrs: Record<string, string> = {};\n          for (const [nodeAttr, HTMLAttr] of Object.entries(BlockAttributes)) {\n            if (element.getAttribute(HTMLAttr)) {\n              attrs[nodeAttr] = element.getAttribute(HTMLAttr)!;\n            }\n          }\n\n          if (element.getAttribute(\"data-node-type\") === \"blockContainer\") {\n            return attrs;\n          }\n\n          return false;\n        },\n      },\n    ];\n  },\n\n  renderHTML({ HTMLAttributes }) {\n    const blockOuter = document.createElement(\"div\");\n    blockOuter.className = \"bn-block-outer\";\n    blockOuter.setAttribute(\"data-node-type\", \"blockOuter\");\n    for (const [attribute, value] of Object.entries(HTMLAttributes)) {\n      if (attribute !== \"class\") {\n        blockOuter.setAttribute(attribute, value);\n      }\n    }\n\n    const blockHTMLAttributes = {\n      ...(this.options.domAttributes?.block || {}),\n      ...HTMLAttributes,\n    };\n    const block = document.createElement(\"div\");\n    block.className = mergeCSSClasses(\"bn-block\", blockHTMLAttributes.class);\n    block.setAttribute(\"data-node-type\", this.name);\n    for (const [attribute, value] of Object.entries(blockHTMLAttributes)) {\n      if (attribute !== \"class\") {\n        block.setAttribute(attribute, value);\n      }\n    }\n\n    blockOuter.appendChild(block);\n\n    return {\n      dom: blockOuter,\n      contentDOM: block,\n    };\n  },\n\n  addCommands() {\n    return {\n      // Creates a new text block at a given position.\n      BNCreateBlock:\n        (pos) =>\n        ({ state, dispatch }) => {\n          const newBlock =\n            state.schema.nodes[\"blockContainer\"].createAndFill()!;\n\n          if (dispatch) {\n            state.tr.insert(pos, newBlock).scrollIntoView();\n          }\n\n          return true;\n        },\n      // Deletes a block at a given position.\n      BNDeleteBlock:\n        (posInBlock) =>\n        ({ state, dispatch }) => {\n          const blockInfo = getBlockInfoFromPos(state.doc, posInBlock);\n          if (blockInfo === undefined) {\n            return false;\n          }\n\n          const { startPos, endPos } = blockInfo;\n\n          if (dispatch) {\n            state.tr.deleteRange(startPos, endPos);\n          }\n\n          return true;\n        },\n      // Updates a block at a given position.\n      BNUpdateBlock:\n        (posInBlock, block) =>\n        ({ state, dispatch }) => {\n          const blockInfo = getBlockInfoFromPos(state.doc, posInBlock);\n          if (blockInfo === undefined) {\n            return false;\n          }\n\n          const { startPos, endPos, node, contentNode } = blockInfo;\n\n          if (dispatch) {\n            // Adds blockGroup node with child blocks if necessary.\n            if (block.children !== undefined) {\n              const childNodes = [];\n\n              // Creates ProseMirror nodes for each child block, including their descendants.\n              for (const child of block.children) {\n                childNodes.push(\n                  blockToNode(\n                    child,\n                    state.schema,\n                    this.options.editor.schema.styleSchema\n                  )\n                );\n              }\n\n              // Checks if a blockGroup node already exists.\n              if (node.childCount === 2) {\n                // Replaces all child nodes in the existing blockGroup with the ones created earlier.\n                state.tr.replace(\n                  startPos + contentNode.nodeSize + 1,\n                  endPos - 1,\n                  new Slice(Fragment.from(childNodes), 0, 0)\n                );\n              } else {\n                // Inserts a new blockGroup containing the child nodes created earlier.\n                state.tr.insert(\n                  startPos + contentNode.nodeSize,\n                  state.schema.nodes[\"blockGroup\"].create({}, childNodes)\n                );\n              }\n            }\n\n            const oldType = contentNode.type.name;\n            const newType = block.type || oldType;\n\n            // The code below determines the new content of the block.\n            // or \"keep\" to keep as-is\n            let content: PMNode[] | \"keep\" = \"keep\";\n\n            // Has there been any custom content provided?\n            if (block.content) {\n              if (typeof block.content === \"string\") {\n                // Adds a single text node with no marks to the content.\n                content = inlineContentToNodes(\n                  [block.content],\n                  state.schema,\n                  this.options.editor.schema.styleSchema\n                );\n              } else if (Array.isArray(block.content)) {\n                // Adds a text node with the provided styles converted into marks to the content,\n                // for each InlineContent object.\n                content = inlineContentToNodes(\n                  block.content,\n                  state.schema,\n                  this.options.editor.schema.styleSchema\n                );\n              } else if (block.content.type === \"tableContent\") {\n                content = tableContentToNodes(\n                  block.content,\n                  state.schema,\n                  this.options.editor.schema.styleSchema\n                );\n              } else {\n                throw new UnreachableCaseError(block.content.type);\n              }\n            } else {\n              // no custom content has been provided, use existing content IF possible\n\n              // Since some block types contain inline content and others don't,\n              // we either need to call setNodeMarkup to just update type &\n              // attributes, or replaceWith to replace the whole blockContent.\n              const oldContentType = state.schema.nodes[oldType].spec.content;\n              const newContentType = state.schema.nodes[newType].spec.content;\n\n              if (oldContentType === \"\") {\n                // keep old content, because it's empty anyway and should be compatible with\n                // any newContentType\n              } else if (newContentType !== oldContentType) {\n                // the content type changed, replace the previous content\n                content = [];\n              } else {\n                // keep old content, because the content type is the same and should be compatible\n              }\n            }\n\n            // Now, changes the blockContent node type and adds the provided props\n            // as attributes. Also preserves all existing attributes that are\n            // compatible with the new type.\n            //\n            // Use either setNodeMarkup or replaceWith depending on whether the\n            // content is being replaced or not.\n            if (content === \"keep\") {\n              // use setNodeMarkup to only update the type and attributes\n              state.tr.setNodeMarkup(\n                startPos,\n                block.type === undefined\n                  ? undefined\n                  : state.schema.nodes[block.type],\n                {\n                  ...contentNode.attrs,\n                  ...block.props,\n                }\n              );\n            } else {\n              // use replaceWith to replace the content and the block itself\n              // also  reset the selection since replacing the block content\n              // sets it to the next block.\n              state.tr\n                .replaceWith(\n                  startPos,\n                  endPos,\n                  state.schema.nodes[newType].create(\n                    {\n                      ...contentNode.attrs,\n                      ...block.props,\n                    },\n                    content\n                  )\n                )\n                // If the node doesn't contain editable content, we want to\n                // select the whole node. But if it does have editable content,\n                // we want to set the selection to the start of it.\n                .setSelection(\n                  state.schema.nodes[newType].spec.content === \"\"\n                    ? new NodeSelection(state.tr.doc.resolve(startPos))\n                    : state.schema.nodes[newType].spec.content === \"inline*\"\n                    ? new TextSelection(state.tr.doc.resolve(startPos))\n                    : // Need to offset the position as we have to get through the\n                      // `tableRow` and `tableCell` nodes to get to the\n                      // `tableParagraph` node we want to set the selection in.\n                      new TextSelection(state.tr.doc.resolve(startPos + 4))\n                );\n            }\n\n            // Adds all provided props as attributes to the parent blockContainer node too, and also preserves existing\n            // attributes.\n            state.tr.setNodeMarkup(startPos - 1, undefined, {\n              ...node.attrs,\n              ...block.props,\n            });\n          }\n\n          return true;\n        },\n      // Appends the text contents of a block to the nearest previous block, given a position between them. Children of\n      // the merged block are moved out of it first, rather than also being merged.\n      //\n      // In the example below, the position passed into the function is between Block1 and Block2.\n      //\n      // Block1\n      //    Block2\n      // Block3\n      //    Block4\n      //        Block5\n      //\n      // Becomes:\n      //\n      // Block1\n      //    Block2Block3\n      // Block4\n      //     Block5\n      BNMergeBlocks:\n        (posBetweenBlocks) =>\n        ({ state, dispatch }) => {\n          const nextNodeIsBlock =\n            state.doc.resolve(posBetweenBlocks + 1).node().type.name ===\n            \"blockContainer\";\n          const prevNodeIsBlock =\n            state.doc.resolve(posBetweenBlocks - 1).node().type.name ===\n            \"blockContainer\";\n\n          if (!nextNodeIsBlock || !prevNodeIsBlock) {\n            return false;\n          }\n\n          const nextBlockInfo = getBlockInfoFromPos(\n            state.doc,\n            posBetweenBlocks + 1\n          );\n\n          const { node, contentNode, startPos, endPos, depth } = nextBlockInfo!;\n\n          // Removes a level of nesting all children of the next block by 1 level, if it contains both content and block\n          // group nodes.\n          if (node.childCount === 2) {\n            const childBlocksStart = state.doc.resolve(\n              startPos + contentNode.nodeSize + 1\n            );\n            const childBlocksEnd = state.doc.resolve(endPos - 1);\n            const childBlocksRange =\n              childBlocksStart.blockRange(childBlocksEnd);\n\n            // Moves the block group node inside the block into the block group node that the current block is in.\n            if (dispatch) {\n              state.tr.lift(childBlocksRange!, depth - 1);\n            }\n          }\n\n          let prevBlockEndPos = posBetweenBlocks - 1;\n          let prevBlockInfo = getBlockInfoFromPos(state.doc, prevBlockEndPos);\n\n          // Finds the nearest previous block, regardless of nesting level.\n          while (prevBlockInfo!.numChildBlocks > 0) {\n            prevBlockEndPos--;\n            prevBlockInfo = getBlockInfoFromPos(state.doc, prevBlockEndPos);\n            if (prevBlockInfo === undefined) {\n              return false;\n            }\n          }\n\n          // Deletes next block and adds its text content to the nearest previous block.\n\n          if (dispatch) {\n            dispatch(\n              state.tr\n                .deleteRange(startPos, startPos + contentNode.nodeSize)\n                .replace(\n                  prevBlockEndPos - 1,\n                  startPos,\n                  new Slice(contentNode.content, 0, 0)\n                )\n                .scrollIntoView()\n            );\n\n            state.tr.setSelection(\n              new TextSelection(state.doc.resolve(prevBlockEndPos - 1))\n            );\n          }\n\n          return true;\n        },\n      // Splits a block at a given position. Content after the position is moved to a new block below, at the same\n      // nesting level.\n      // - `keepType` is usually false, unless the selection is at the start of\n      // a block.\n      // - `keepProps` is usually true when `keepType` is true, except for when\n      // creating new list item blocks with Enter.\n      BNSplitBlock:\n        (posInBlock, keepType, keepProps) =>\n        ({ state, dispatch }) => {\n          const blockInfo = getBlockInfoFromPos(state.doc, posInBlock);\n          if (blockInfo === undefined) {\n            return false;\n          }\n\n          const { contentNode, contentType, startPos, endPos, depth } =\n            blockInfo;\n\n          const originalBlockContent = state.doc.cut(startPos + 1, posInBlock);\n          const newBlockContent = state.doc.cut(posInBlock, endPos - 1);\n\n          const newBlock =\n            state.schema.nodes[\"blockContainer\"].createAndFill()!;\n\n          const newBlockInsertionPos = endPos + 1;\n          const newBlockContentPos = newBlockInsertionPos + 2;\n\n          if (dispatch) {\n            // Creates a new block. Since the schema requires it to have a content node, a paragraph node is created\n            // automatically, spanning newBlockContentPos to newBlockContentPos + 1.\n            state.tr.insert(newBlockInsertionPos, newBlock);\n\n            // Replaces the content of the newly created block's content node. Doesn't replace the whole content node so\n            // its type doesn't change.\n            state.tr.replace(\n              newBlockContentPos,\n              newBlockContentPos + 1,\n              newBlockContent.content.size > 0\n                ? new Slice(\n                    Fragment.from(newBlockContent),\n                    depth + 2,\n                    depth + 2\n                  )\n                : undefined\n            );\n\n            // Changes the type of the content node. The range doesn't matter as long as both from and to positions are\n            // within the content node.\n            if (keepType) {\n              state.tr.setBlockType(\n                newBlockContentPos,\n                newBlockContentPos,\n                state.schema.node(contentType).type,\n                keepProps ? contentNode.attrs : undefined\n              );\n            }\n\n            // Sets the selection to the start of the new block's content node.\n            state.tr.setSelection(\n              new TextSelection(state.doc.resolve(newBlockContentPos))\n            );\n\n            // Replaces the content of the original block's content node. Doesn't replace the whole content node so its\n            // type doesn't change.\n            state.tr.replace(\n              startPos + 1,\n              endPos - 1,\n              originalBlockContent.content.size > 0\n                ? new Slice(\n                    Fragment.from(originalBlockContent),\n                    depth + 2,\n                    depth + 2\n                  )\n                : undefined\n            );\n\n            state.tr.scrollIntoView();\n          }\n\n          return true;\n        },\n    };\n  },\n\n  addProseMirrorPlugins() {\n    return [PreviousBlockTypePlugin(), NonEditableBlockPlugin()];\n  },\n\n  addKeyboardShortcuts() {\n    // handleBackspace is partially adapted from https://github.com/ueberdosis/tiptap/blob/ed56337470efb4fd277128ab7ef792b37cfae992/packages/core/src/extensions/keymap.ts\n    const handleBackspace = () =>\n      this.editor.commands.first(({ commands }) => [\n        // Deletes the selection if it's not empty.\n        () => commands.deleteSelection(),\n        // Undoes an input rule if one was triggered in the last editor state change.\n        () => commands.undoInputRule(),\n        // Reverts block content type to a paragraph if the selection is at the start of the block.\n        () =>\n          commands.command(({ state }) => {\n            const { contentType, startPos } = getBlockInfoFromPos(\n              state.doc,\n              state.selection.from\n            )!;\n\n            const selectionAtBlockStart = state.selection.from === startPos + 1;\n            const isParagraph = contentType.name === \"paragraph\";\n\n            if (selectionAtBlockStart && !isParagraph) {\n              return commands.BNUpdateBlock(state.selection.from, {\n                type: \"paragraph\",\n                props: {},\n              });\n            }\n\n            return false;\n          }),\n        // Removes a level of nesting if the block is indented if the selection is at the start of the block.\n        () =>\n          commands.command(({ state }) => {\n            const { startPos } = getBlockInfoFromPos(\n              state.doc,\n              state.selection.from\n            )!;\n\n            const selectionAtBlockStart = state.selection.from === startPos + 1;\n\n            if (selectionAtBlockStart) {\n              return commands.liftListItem(\"blockContainer\");\n            }\n\n            return false;\n          }),\n        // Merges block with the previous one if it isn't indented, isn't the first block in the doc, and the selection\n        // is at the start of the block.\n        () =>\n          commands.command(({ state }) => {\n            const { depth, startPos } = getBlockInfoFromPos(\n              state.doc,\n              state.selection.from\n            )!;\n\n            const selectionAtBlockStart = state.selection.from === startPos + 1;\n            const selectionEmpty = state.selection.empty;\n            const blockAtDocStart = startPos === 2;\n\n            const posBetweenBlocks = startPos - 1;\n\n            if (\n              !blockAtDocStart &&\n              selectionAtBlockStart &&\n              selectionEmpty &&\n              depth === 2\n            ) {\n              return commands.BNMergeBlocks(posBetweenBlocks);\n            }\n\n            return false;\n          }),\n      ]);\n\n    const handleDelete = () =>\n      this.editor.commands.first(({ commands }) => [\n        // Deletes the selection if it's not empty.\n        () => commands.deleteSelection(),\n        // Merges block with the next one (at the same nesting level or lower),\n        // if one exists, the block has no children, and the selection is at the\n        // end of the block.\n        () =>\n          commands.command(({ state }) => {\n            const { node, depth, endPos } = getBlockInfoFromPos(\n              state.doc,\n              state.selection.from\n            )!;\n\n            const blockAtDocEnd = endPos === state.doc.nodeSize - 4;\n            const selectionAtBlockEnd = state.selection.from === endPos - 1;\n            const selectionEmpty = state.selection.empty;\n            const hasChildBlocks = node.childCount === 2;\n\n            if (\n              !blockAtDocEnd &&\n              selectionAtBlockEnd &&\n              selectionEmpty &&\n              !hasChildBlocks\n            ) {\n              let oldDepth = depth;\n              let newPos = endPos + 2;\n              let newDepth = state.doc.resolve(newPos).depth;\n\n              while (newDepth < oldDepth) {\n                oldDepth = newDepth;\n                newPos += 2;\n                newDepth = state.doc.resolve(newPos).depth;\n              }\n\n              return commands.BNMergeBlocks(newPos - 1);\n            }\n\n            return false;\n          }),\n      ]);\n\n    const handleEnter = () =>\n      this.editor.commands.first(({ commands }) => [\n        // Removes a level of nesting if the block is empty & indented, while the selection is also empty & at the start\n        // of the block.\n        () =>\n          commands.command(({ state }) => {\n            const { contentNode, depth } = getBlockInfoFromPos(\n              state.doc,\n              state.selection.from\n            )!;\n\n            const selectionAtBlockStart =\n              state.selection.$anchor.parentOffset === 0;\n            const selectionEmpty =\n              state.selection.anchor === state.selection.head;\n            const blockEmpty = contentNode.childCount === 0;\n            const blockIndented = depth > 2;\n\n            if (\n              selectionAtBlockStart &&\n              selectionEmpty &&\n              blockEmpty &&\n              blockIndented\n            ) {\n              return commands.liftListItem(\"blockContainer\");\n            }\n\n            return false;\n          }),\n        // Creates a new block and moves the selection to it if the current one is empty, while the selection is also\n        // empty & at the start of the block.\n        () =>\n          commands.command(({ state, chain }) => {\n            const { contentNode, endPos } = getBlockInfoFromPos(\n              state.doc,\n              state.selection.from\n            )!;\n\n            const selectionAtBlockStart =\n              state.selection.$anchor.parentOffset === 0;\n            const selectionEmpty =\n              state.selection.anchor === state.selection.head;\n            const blockEmpty = contentNode.childCount === 0;\n\n            if (selectionAtBlockStart && selectionEmpty && blockEmpty) {\n              const newBlockInsertionPos = endPos + 1;\n              const newBlockContentPos = newBlockInsertionPos + 2;\n\n              chain()\n                .BNCreateBlock(newBlockInsertionPos)\n                .setTextSelection(newBlockContentPos)\n                .run();\n\n              return true;\n            }\n\n            return false;\n          }),\n        // Splits the current block, moving content inside that's after the cursor to a new text block below. Also\n        // deletes the selection beforehand, if it's not empty.\n        () =>\n          commands.command(({ state, chain }) => {\n            const { contentNode } = getBlockInfoFromPos(\n              state.doc,\n              state.selection.from\n            )!;\n\n            const selectionAtBlockStart =\n              state.selection.$anchor.parentOffset === 0;\n            const blockEmpty = contentNode.childCount === 0;\n\n            if (!blockEmpty) {\n              chain()\n                .deleteSelection()\n                .BNSplitBlock(\n                  state.selection.from,\n                  selectionAtBlockStart,\n                  selectionAtBlockStart\n                )\n                .run();\n\n              return true;\n            }\n\n            return false;\n          }),\n      ]);\n\n    return {\n      Backspace: handleBackspace,\n      Delete: handleDelete,\n      Enter: handleEnter,\n      // Always returning true for tab key presses ensures they're not captured by the browser. Otherwise, they blur the\n      // editor since the browser will try to use tab for keyboard navigation.\n      Tab: () => {\n        if (\n          this.options.editor.formattingToolbar?.shown ||\n          this.options.editor.linkToolbar?.shown ||\n          this.options.editor.filePanel?.shown\n        ) {\n          // don't handle tabs if a toolbar is shown, so we can tab into / out of it\n          return false;\n        }\n        this.editor.commands.sinkListItem(\"blockContainer\");\n        return true;\n      },\n      \"Shift-Tab\": () => {\n        if (\n          this.options.editor.formattingToolbar?.shown ||\n          this.options.editor.linkToolbar?.shown ||\n          this.options.editor.filePanel?.shown\n        ) {\n          // don't handle tabs if a toolbar is shown, so we can tab into / out of it\n          return false;\n        }\n        this.editor.commands.liftListItem(\"blockContainer\");\n        return true;\n      },\n    };\n  },\n});\n","import { Node } from \"@tiptap/core\";\nimport { BlockNoteDOMAttributes } from \"../schema\";\nimport { mergeCSSClasses } from \"../util/browser\";\n\nexport const BlockGroup = Node.create<{\n  domAttributes?: BlockNoteDOMAttributes;\n}>({\n  name: \"blockGroup\",\n  group: \"blockGroup\",\n  content: \"blockContainer+\",\n\n  parseHTML() {\n    return [\n      {\n        tag: \"div\",\n        getAttrs: (element) => {\n          if (typeof element === \"string\") {\n            return false;\n          }\n\n          if (element.getAttribute(\"data-node-type\") === \"blockGroup\") {\n            // Null means the element matches, but we don't want to add any attributes to the node.\n            return null;\n          }\n\n          return false;\n        },\n      },\n    ];\n  },\n\n  renderHTML({ HTMLAttributes }) {\n    const blockGroupHTMLAttributes = {\n      ...(this.options.domAttributes?.blockGroup || {}),\n      ...HTMLAttributes,\n    };\n    const blockGroup = document.createElement(\"div\");\n    blockGroup.className = mergeCSSClasses(\n      \"bn-block-group\",\n      blockGroupHTMLAttributes.class\n    );\n    blockGroup.setAttribute(\"data-node-type\", \"blockGroup\");\n    for (const [attribute, value] of Object.entries(blockGroupHTMLAttributes)) {\n      if (attribute !== \"class\") {\n        blockGroup.setAttribute(attribute, value);\n      }\n    }\n\n    return {\n      dom: blockGroup,\n      contentDOM: blockGroup,\n    };\n  },\n});\n","import {Node} from \"@tiptap/core\";\n\nexport const Doc = Node.create({\n    name: \"doc\",\n    topNode: true,\n    content: \"blockGroup\",\n});\n","import { Extension, Extensions, extensions } from \"@tiptap/core\";\n\nimport type { BlockNoteEditor } from \"./BlockNoteEditor\";\n\nimport Collaboration from \"@tiptap/extension-collaboration\";\nimport CollaborationCursor from \"@tiptap/extension-collaboration-cursor\";\nimport { Dropcursor } from \"@tiptap/extension-dropcursor\";\nimport { Gapcursor } from \"@tiptap/extension-gapcursor\";\nimport { HardBreak } from \"@tiptap/extension-hard-break\";\nimport { History } from \"@tiptap/extension-history\";\nimport { Link } from \"@tiptap/extension-link\";\nimport { Text } from \"@tiptap/extension-text\";\nimport * as Y from \"yjs\";\nimport { createCopyToClipboardExtension } from \"../api/exporters/copyExtension\";\nimport { createPasteFromClipboardExtension } from \"../api/parsers/pasteExtension\";\nimport { createDropFileExtension } from \"../api/parsers/fileDropExtension\";\nimport { BackgroundColorExtension } from \"../extensions/BackgroundColor/BackgroundColorExtension\";\nimport { TextAlignmentExtension } from \"../extensions/TextAlignment/TextAlignmentExtension\";\nimport { TextColorExtension } from \"../extensions/TextColor/TextColorExtension\";\nimport { TrailingNode } from \"../extensions/TrailingNode/TrailingNodeExtension\";\nimport UniqueID from \"../extensions/UniqueID/UniqueID\";\nimport { BlockContainer, BlockGroup, Doc } from \"../pm-nodes\";\nimport {\n  BlockNoteDOMAttributes,\n  BlockSchema,\n  BlockSpecs,\n  InlineContentSchema,\n  InlineContentSpecs,\n  StyleSchema,\n  StyleSpecs,\n} from \"../schema\";\n\n/**\n * Get all the Tiptap extensions BlockNote is configured with by default\n */\nexport const getBlockNoteExtensions = <\n  BSchema extends BlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(opts: {\n  editor: BlockNoteEditor<BSchema, I, S>;\n  domAttributes: Partial<BlockNoteDOMAttributes>;\n  blockSchema: BSchema;\n  blockSpecs: BlockSpecs;\n  inlineContentSpecs: InlineContentSpecs;\n  styleSpecs: StyleSpecs;\n  trailingBlock: boolean | undefined;\n  collaboration?: {\n    fragment: Y.XmlFragment;\n    user: {\n      name: string;\n      color: string;\n    };\n    provider: any;\n    renderCursor?: (user: any) => HTMLElement;\n  };\n  disableExtensions: string[] | undefined;\n}) => {\n  const ret: Extensions = [\n    extensions.ClipboardTextSerializer,\n    extensions.Commands,\n    extensions.Editable,\n    extensions.FocusEvents,\n    extensions.Tabindex,\n\n    // DevTools,\n    Gapcursor,\n\n    // DropCursor,\n    UniqueID.configure({\n      types: [\"blockContainer\"],\n    }),\n    HardBreak.extend({ priority: 10 }),\n    // Comments,\n\n    // basics:\n    Text,\n\n    // marks:\n    Link.extend({\n      addKeyboardShortcuts() {\n        return {\n          \"Mod-k\": () => {\n            this.editor.commands.toggleLink({ href: \"\" });\n            return true;\n          },\n        };\n      },\n    }),\n    ...Object.values(opts.styleSpecs).map((styleSpec) => {\n      return styleSpec.implementation.mark;\n    }),\n\n    TextColorExtension,\n\n    BackgroundColorExtension,\n    TextAlignmentExtension,\n\n    // make sure escape blurs editor, so that we can tab to other elements in the host page (accessibility)\n    Extension.create({\n      name: \"OverrideEscape\",\n      addKeyboardShortcuts() {\n        return {\n          Escape: () => {\n            if (opts.editor.suggestionMenus.shown) {\n              // escape is handled by suggestionmenu\n              return false;\n            }\n            return this.editor.commands.blur();\n          },\n        };\n      },\n    }),\n\n    // nodes\n    Doc,\n    BlockContainer.configure({\n      editor: opts.editor,\n      domAttributes: opts.domAttributes,\n    }),\n    BlockGroup.configure({\n      domAttributes: opts.domAttributes,\n    }),\n    ...Object.values(opts.inlineContentSpecs)\n      .filter((a) => a.config !== \"link\" && a.config !== \"text\")\n      .map((inlineContentSpec) => {\n        return inlineContentSpec.implementation!.node.configure({\n          editor: opts.editor as any,\n        });\n      }),\n\n    ...Object.values(opts.blockSpecs).flatMap((blockSpec) => {\n      return [\n        // dependent nodes (e.g.: tablecell / row)\n        ...(blockSpec.implementation.requiredExtensions || []).map((ext) =>\n          ext.configure({\n            editor: opts.editor,\n            domAttributes: opts.domAttributes,\n          })\n        ),\n        // the actual node itself\n        blockSpec.implementation.node.configure({\n          editor: opts.editor,\n          domAttributes: opts.domAttributes,\n        }),\n      ];\n    }),\n    createCopyToClipboardExtension(opts.editor),\n    createPasteFromClipboardExtension(opts.editor),\n    createDropFileExtension(opts.editor),\n\n    Dropcursor.configure({ width: 5, color: \"#ddeeff\" }),\n    // This needs to be at the bottom of this list, because Key events (such as enter, when selecting a /command),\n    // should be handled before Enter handlers in other components like splitListItem\n    ...(opts.trailingBlock === undefined || opts.trailingBlock\n      ? [TrailingNode]\n      : []),\n  ];\n\n  if (opts.collaboration) {\n    ret.push(\n      Collaboration.configure({\n        fragment: opts.collaboration.fragment,\n      })\n    );\n    if (opts.collaboration.provider?.awareness) {\n      const defaultRender = (user: { color: string; name: string }) => {\n        const cursor = document.createElement(\"span\");\n\n        cursor.classList.add(\"collaboration-cursor__caret\");\n        cursor.setAttribute(\"style\", `border-color: ${user.color}`);\n\n        const label = document.createElement(\"span\");\n\n        label.classList.add(\"collaboration-cursor__label\");\n        label.setAttribute(\"style\", `background-color: ${user.color}`);\n        label.insertBefore(document.createTextNode(user.name), null);\n\n        const nonbreakingSpace1 = document.createTextNode(\"\\u2060\");\n        const nonbreakingSpace2 = document.createTextNode(\"\\u2060\");\n        cursor.insertBefore(nonbreakingSpace1, null);\n        cursor.insertBefore(label, null);\n        cursor.insertBefore(nonbreakingSpace2, null);\n        return cursor;\n      };\n      ret.push(\n        CollaborationCursor.configure({\n          user: opts.collaboration.user,\n          render: opts.collaboration.renderCursor || defaultRender,\n          provider: opts.collaboration.provider,\n        })\n      );\n    }\n  } else {\n    // disable history extension when collaboration is enabled as Yjs takes care of undo / redo\n    ret.push(History);\n  }\n\n  const disableExtensions: string[] = opts.disableExtensions || [];\n  return ret.filter(ex => !disableExtensions.includes(ex.name));\n};\n","import { Fragment, Slice } from \"@tiptap/pm/model\";\nimport { EditorView } from \"@tiptap/pm/view\";\n\n// helper function to remove a child from a fragment\nfunction removeChild(node: Fragment, n: number) {\n  const children: any[] = [];\n  node.forEach((child, _, i) => {\n    if (i !== n) {\n      children.push(child);\n    }\n  });\n  return Fragment.from(children);\n}\n\n/**\n * fix for https://github.com/ProseMirror/prosemirror/issues/1430#issuecomment-1822570821\n *\n * Without this fix, pasting two paragraphs would cause the second one to be indented in the other\n * this fix wraps every element in the slice in it's own blockContainer, to prevent Prosemirror from nesting the\n * elements on paste.\n *\n * The exception is when we encounter blockGroups with listitems, because those actually should be nested\n */\nexport function transformPasted(slice: Slice, view: EditorView) {\n  let f = Fragment.from(slice.content);\n  for (let i = 0; i < f.childCount; i++) {\n    if (f.child(i).type.spec.group === \"blockContent\") {\n      const content = [f.child(i)];\n\n      // when there is a blockGroup with lists, it should be nested in the new blockcontainer\n      // (if we remove this if-block, the nesting bug will be fixed, but lists won't be nested correctly)\n      if (\n        i + 1 < f.childCount &&\n        f.child(i + 1).type.spec.group === \"blockGroup\"\n      ) {\n        const nestedChild = f\n          .child(i + 1)\n          .child(0)\n          .child(0);\n\n        if (\n          nestedChild.type.name === \"bulletListItem\" ||\n          nestedChild.type.name === \"numberedListItem\" ||\n          nestedChild.type.name === \"checkListItem\"\n        ) {\n          content.push(f.child(i + 1));\n          f = removeChild(f, i + 1);\n        }\n      }\n      const container = view.state.schema.nodes.blockContainer.create(\n        undefined,\n        content\n      );\n      f = f.replaceChild(i, container);\n    }\n  }\n\n  return new Slice(f, slice.openStart, slice.openEnd);\n}\n","import {\n  defaultBlockSpecs,\n  defaultInlineContentSpecs,\n  defaultStyleSpecs,\n} from \"../blocks/defaultBlocks\";\nimport {\n  BlockSchema,\n  BlockSchemaFromSpecs,\n  BlockSpecs,\n  InlineContentSchema,\n  InlineContentSchemaFromSpecs,\n  InlineContentSpecs,\n  StyleSchema,\n  StyleSchemaFromSpecs,\n  StyleSpecs,\n  getBlockSchemaFromSpecs,\n  getInlineContentSchemaFromSpecs,\n  getStyleSchemaFromSpecs,\n} from \"../schema\";\nimport type {\n  BlockNoDefaults,\n  PartialBlockNoDefaults,\n} from \"../schema/blocks/types\";\nimport type { BlockNoteEditor } from \"./BlockNoteEditor\";\n\nfunction removeUndefined<T extends Record<string, any> | undefined>(obj: T): T {\n  if (!obj) {\n    return obj;\n  }\n  return Object.fromEntries(\n    Object.entries(obj).filter(([, value]) => value !== undefined)\n  ) as T;\n}\n\nexport class BlockNoteSchema<\n  BSchema extends BlockSchema,\n  ISchema extends InlineContentSchema,\n  SSchema extends StyleSchema\n> {\n  public readonly blockSpecs: BlockSpecs;\n  public readonly inlineContentSpecs: InlineContentSpecs;\n  public readonly styleSpecs: StyleSpecs;\n\n  public readonly blockSchema: BSchema;\n  public readonly inlineContentSchema: ISchema;\n  public readonly styleSchema: SSchema;\n\n  // Helper so that you can use typeof schema.BlockNoteEditor\n  public readonly BlockNoteEditor: BlockNoteEditor<BSchema, ISchema, SSchema> =\n    \"only for types\" as any;\n\n  public readonly Block: BlockNoDefaults<BSchema, ISchema, SSchema> =\n    \"only for types\" as any;\n\n  public readonly PartialBlock: PartialBlockNoDefaults<\n    BSchema,\n    ISchema,\n    SSchema\n  > = \"only for types\" as any;\n\n  public static create<\n    BSpecs extends BlockSpecs = typeof defaultBlockSpecs,\n    ISpecs extends InlineContentSpecs = typeof defaultInlineContentSpecs,\n    SSpecs extends StyleSpecs = typeof defaultStyleSpecs\n  >(options?: {\n    /**\n     * A list of custom block types that should be available in the editor.\n     */\n    blockSpecs?: BSpecs;\n    /**\n     * A list of custom InlineContent types that should be available in the editor.\n     */\n    inlineContentSpecs?: ISpecs;\n    /**\n     * A list of custom Styles that should be available in the editor.\n     */\n    styleSpecs?: SSpecs;\n  }) {\n    return new BlockNoteSchema<\n      BlockSchemaFromSpecs<BSpecs>,\n      InlineContentSchemaFromSpecs<ISpecs>,\n      StyleSchemaFromSpecs<SSpecs>\n    >(options);\n    // as BlockNoteSchema<\n    // BlockSchemaFromSpecs<BSpecs>,\n    // InlineContentSchemaFromSpecs<ISpecs>,\n    // StyleSchemaFromSpecs<SSpecs>\n    // >;\n  }\n\n  constructor(opts?: {\n    blockSpecs?: BlockSpecs;\n    inlineContentSpecs?: InlineContentSpecs;\n    styleSpecs?: StyleSpecs;\n  }) {\n    this.blockSpecs = removeUndefined(opts?.blockSpecs) || defaultBlockSpecs;\n    this.inlineContentSpecs =\n      removeUndefined(opts?.inlineContentSpecs) || defaultInlineContentSpecs;\n    this.styleSpecs = removeUndefined(opts?.styleSpecs) || defaultStyleSpecs;\n\n    this.blockSchema = getBlockSchemaFromSpecs(this.blockSpecs) as any;\n    this.inlineContentSchema = getInlineContentSchemaFromSpecs(\n      this.inlineContentSpecs\n    ) as any;\n    this.styleSchema = getStyleSchemaFromSpecs(this.styleSpecs) as any;\n  }\n}\n","import { EditorOptions, createDocument } from \"@tiptap/core\";\n// import \"./blocknote.css\";\nimport { Editor as TiptapEditor } from \"@tiptap/core\";\nimport { Node } from \"@tiptap/pm/model\";\nimport { EditorView } from \"@tiptap/pm/view\";\nimport { EditorState } from \"prosemirror-state\";\n\nimport { blockToNode } from \"../api/nodeConversions/nodeConversions\";\nimport { PartialBlock } from \"../blocks/defaultBlocks\";\nimport { StyleSchema } from \"../schema\";\n\nexport type BlockNoteTipTapEditorOptions = Partial<\n  Omit<EditorOptions, \"content\">\n> & {\n  content: PartialBlock<any, any, any>[];\n};\n\n/**\n * Custom Editor class that extends TiptapEditor and separates\n * the creation of the view from the constructor.\n */\n// @ts-ignore\nexport class BlockNoteTipTapEditor extends TiptapEditor {\n  private _state: EditorState;\n\n  constructor(options: BlockNoteTipTapEditorOptions, styleSchema: StyleSchema) {\n    // possible fix for next.js server side rendering\n    // const d = globalThis.document;\n    // const w = globalThis.window;\n    // if (!globalThis.document) {\n    //   globalThis.document = {\n    //     createElement: () => {},\n    //   };\n    // }\n    // if (!globalThis.window) {\n    //   globalThis.window = {\n    //     setTimeout: () => {},\n    //   };\n    // }\n    // options.injectCSS = false\n    super({ ...options, content: undefined });\n\n    // try {\n    //   globalThis.window = w;\n    //   } catch(e) {}\n    //   try {\n    //     globalThis.document = d;\n    //     } catch(e) {}\n\n    // This is a hack to make \"initial content detection\" by y-prosemirror (and also tiptap isEmpty)\n    // properly detect whether or not the document has changed.\n    // We change the doc.createAndFill function to make sure the initial block id is set, instead of null\n    const schema = this.schema;\n    let cache: any;\n    const oldCreateAndFill = schema.nodes.doc.createAndFill;\n    (schema.nodes.doc as any).createAndFill = (...args: any) => {\n      if (cache) {\n        return cache;\n      }\n      const ret = oldCreateAndFill.apply(schema.nodes.doc, args);\n\n      // create a copy that we can mutate (otherwise, assigning attrs is not safe and corrupts the pm state)\n      const jsonNode = JSON.parse(JSON.stringify(ret!.toJSON()));\n      jsonNode.content[0].content[0].attrs.id = \"initialBlockId\";\n\n      cache = Node.fromJSON(schema, jsonNode);\n      return cache;\n    };\n\n    let doc: Node;\n\n    try {\n      const pmNodes = options?.content.map((b) =>\n        blockToNode(b, this.schema, styleSchema).toJSON()\n      );\n      doc = createDocument(\n        {\n          type: \"doc\",\n          content: [\n            {\n              type: \"blockGroup\",\n              content: pmNodes,\n            },\n          ],\n        },\n        this.schema,\n        this.options.parseOptions\n      );\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.error(\n        \"Error creating document from blocks passed as `initialContent`. Caused by exception: \",\n        e\n      );\n      throw new Error(\n        \"Error creating document from blocks passed as `initialContent`:\\n\" +\n          +JSON.stringify(options.content)\n      );\n    }\n\n    // Create state immediately, so that it's available independently from the View,\n    // the way Prosemirror \"intends it to be\". This also makes sure that we can access\n    // the state before the view is created / mounted.\n    this._state = EditorState.create({\n      doc,\n      schema: this.schema,\n      // selection: selection || undefined,\n    });\n  }\n\n  get state() {\n    if (this.view) {\n      this._state = this.view.state;\n    }\n    return this._state;\n  }\n\n  createView() {\n    // no-op\n    // Disable default call to `createView` in the Editor constructor.\n    // We should call `createView` manually only when a DOM element is available\n  }\n\n  /**\n   * Replace the default `createView` method with a custom one - which we call on mount\n   */\n  private createViewAlternative() {\n    // Without queueMicrotask, custom IC / styles will give a React FlushSync error\n    queueMicrotask(() => {\n      this.view = new EditorView(\n        { mount: this.options.element as any }, // use mount option so that we reuse the existing element instead of creating a new one\n        {\n          ...this.options.editorProps,\n          // @ts-ignore\n          dispatchTransaction: this.dispatchTransaction.bind(this),\n          state: this.state,\n        }\n      );\n\n      // `editor.view` is not yet available at this time.\n      // Therefore we will add all plugins and node views directly afterwards.\n      const newState = this.state.reconfigure({\n        plugins: this.extensionManager.plugins,\n      });\n\n      this.view.updateState(newState);\n\n      this.createNodeViews();\n    });\n  }\n\n  /**\n   * Mounts / unmounts the editor to a dom element\n   *\n   * @param element DOM element to mount to, ur null / undefined to destroy\n   */\n  public mount = (element?: HTMLElement | null) => {\n    if (!element) {\n      this.destroy();\n    } else {\n      this.options.element = element;\n      // @ts-ignore\n      this.createViewAlternative();\n    }\n  };\n}\n","import { Plugin, PluginKey } from \"prosemirror-state\";\nimport { Decoration, DecorationSet } from \"prosemirror-view\";\nimport type { BlockNoteEditor } from \"../../editor/BlockNoteEditor\";\n\nconst PLUGIN_KEY = new PluginKey(`blocknote-placeholder`);\n\nexport const PlaceholderPlugin = (\n  editor: BlockNoteEditor<any, any, any>,\n  placeholders: Record<string | \"default\", string>\n) => {\n  return new Plugin({\n    key: PLUGIN_KEY,\n    view: () => {\n      const styleEl = document.createElement(\"style\");\n      const nonce = editor._tiptapEditor.options.injectNonce;\n      if (nonce) {\n        styleEl.setAttribute(\"nonce\", nonce);\n      }\n      if (editor._tiptapEditor.view.root instanceof ShadowRoot) {\n        editor._tiptapEditor.view.root.append(styleEl);\n      } else {\n        editor._tiptapEditor.view.root.head.appendChild(styleEl);\n      }\n\n      const styleSheet = styleEl.sheet!;\n\n      const getBaseSelector = (additionalSelectors = \"\") =>\n        `.bn-block-content${additionalSelectors} .bn-inline-content:has(> .ProseMirror-trailingBreak:only-child):before`;\n\n      const getSelector = (\n        blockType: string | \"default\",\n        mustBeFocused = true\n      ) => {\n        const mustBeFocusedSelector = mustBeFocused\n          ? `[data-is-empty-and-focused]`\n          : ``;\n\n        if (blockType === \"default\") {\n          return getBaseSelector(mustBeFocusedSelector);\n        }\n\n        const blockTypeSelector = `[data-content-type=\"${blockType}\"]`;\n        return getBaseSelector(mustBeFocusedSelector + blockTypeSelector);\n      };\n\n      for (const [blockType, placeholder] of Object.entries(placeholders)) {\n        const mustBeFocused = blockType === \"default\";\n\n        styleSheet.insertRule(\n          `${getSelector(blockType, mustBeFocused)}{ content: ${JSON.stringify(\n            placeholder\n          )}; }`\n        );\n\n        // For some reason, the placeholders which show when the block is focused\n        // take priority over ones which show depending on block type, so we need\n        // to make sure the block specific ones are also used when the block is\n        // focused.\n        if (!mustBeFocused) {\n          styleSheet.insertRule(\n            `${getSelector(blockType, true)}{ content: ${JSON.stringify(\n              placeholder\n            )}; }`\n          );\n        }\n      }\n\n      return {\n        destroy: () => {\n          if (editor._tiptapEditor.view.root instanceof ShadowRoot) {\n            editor._tiptapEditor.view.root.removeChild(styleEl);\n          } else {\n            editor._tiptapEditor.view.root.head.removeChild(styleEl);\n          }\n        },\n      };\n    },\n    props: {\n      // TODO: maybe also add placeholder for empty document (\"e.g.: start writing..\")\n      decorations: (state) => {\n        const { doc, selection } = state;\n\n        if (!editor.isEditable) {\n          return;\n        }\n\n        if (!selection.empty) {\n          return;\n        }\n\n        const $pos = selection.$anchor;\n        const node = $pos.parent;\n\n        if (node.content.size > 0) {\n          return null;\n        }\n\n        const before = $pos.before();\n\n        const dec = Decoration.node(before, before + node.nodeSize, {\n          \"data-is-empty-and-focused\": \"true\",\n        });\n\n        return DecorationSet.create(doc, [dec]);\n      },\n    },\n  });\n};\n","import { EditorOptions, Extension } from \"@tiptap/core\";\nimport { Node } from \"prosemirror-model\";\n// import \"./blocknote.css\";\nimport * as Y from \"yjs\";\nimport {\n  insertBlocks,\n  insertContentAt,\n  removeBlocks,\n  replaceBlocks,\n  updateBlock,\n} from \"../api/blockManipulation/blockManipulation\";\nimport { createExternalHTMLExporter } from \"../api/exporters/html/externalHTMLExporter\";\nimport { blocksToMarkdown } from \"../api/exporters/markdown/markdownExporter\";\nimport { getBlockInfoFromPos } from \"../api/getBlockInfoFromPos\";\nimport {\n  inlineContentToNodes,\n  nodeToBlock,\n} from \"../api/nodeConversions/nodeConversions\";\nimport { getNodeById } from \"../api/nodeUtil\";\nimport { HTMLToBlocks } from \"../api/parsers/html/parseHTML\";\nimport { markdownToBlocks } from \"../api/parsers/markdown/parseMarkdown\";\nimport {\n  Block,\n  DefaultBlockSchema,\n  DefaultInlineContentSchema,\n  DefaultStyleSchema,\n  PartialBlock,\n} from \"../blocks/defaultBlocks\";\nimport { FilePanelProsemirrorPlugin } from \"../extensions/FilePanel/FilePanelPlugin\";\nimport { FormattingToolbarProsemirrorPlugin } from \"../extensions/FormattingToolbar/FormattingToolbarPlugin\";\nimport { LinkToolbarProsemirrorPlugin } from \"../extensions/LinkToolbar/LinkToolbarPlugin\";\nimport { SideMenuProsemirrorPlugin } from \"../extensions/SideMenu/SideMenuPlugin\";\nimport { SuggestionMenuProseMirrorPlugin } from \"../extensions/SuggestionMenu/SuggestionPlugin\";\nimport { TableHandlesProsemirrorPlugin } from \"../extensions/TableHandles/TableHandlesPlugin\";\nimport { UniqueID } from \"../extensions/UniqueID/UniqueID\";\nimport {\n  BlockIdentifier,\n  BlockNoteDOMAttributes,\n  BlockSchema,\n  BlockSpecs,\n  InlineContentSchema,\n  InlineContentSpecs,\n  PartialInlineContent,\n  StyleSchema,\n  StyleSpecs,\n  Styles,\n} from \"../schema\";\nimport { mergeCSSClasses } from \"../util/browser\";\nimport { NoInfer, UnreachableCaseError } from \"../util/typescript\";\n\nimport { getBlockNoteExtensions } from \"./BlockNoteExtensions\";\nimport { TextCursorPosition } from \"./cursorPositionTypes\";\n\nimport { Selection } from \"./selectionTypes\";\nimport { transformPasted } from \"./transformPasted\";\n\nimport { checkDefaultBlockTypeInSchema } from \"../blocks/defaultBlockTypeGuards\";\nimport { BlockNoteSchema } from \"./BlockNoteSchema\";\nimport {\n  BlockNoteTipTapEditor,\n  BlockNoteTipTapEditorOptions,\n} from \"./BlockNoteTipTapEditor\";\n\n// CSS\nimport { PlaceholderPlugin } from \"../extensions/Placeholder/PlaceholderPlugin\";\nimport { Dictionary } from \"../i18n/dictionary\";\nimport { en } from \"../i18n/locales\";\nimport \"./Block.css\";\nimport \"./editor.css\";\n\nexport type BlockNoteEditorOptions<\n  BSchema extends BlockSchema,\n  ISchema extends InlineContentSchema,\n  SSchema extends StyleSchema\n> = {\n  disableExtensions: string[];\n  /**\n   * A dictionary object containing translations for the editor.\n   */\n  dictionary?: Dictionary;\n\n  /**\n   * @deprecated, provide placeholders via dictionary instead\n   */\n  placeholders: Record<string | \"default\", string>;\n\n  /**\n   * An object containing attributes that should be added to HTML elements of the editor.\n   *\n   * @example { editor: { class: \"my-editor-class\" } }\n   */\n  domAttributes: Partial<BlockNoteDOMAttributes>;\n\n  /**\n   * The content that should be in the editor when it's created, represented as an array of partial block objects.\n   */\n  initialContent: PartialBlock<\n    NoInfer<BSchema>,\n    NoInfer<ISchema>,\n    NoInfer<SSchema>\n  >[];\n  /**\n   * Use default BlockNote font and reset the styles of <p> <li> <h1> elements etc., that are used in BlockNote.\n   *\n   * @default true\n   */\n  defaultStyles: boolean;\n\n  schema: BlockNoteSchema<BSchema, ISchema, SSchema>;\n\n  /**\n   * A custom function to handle file uploads.\n   * @param file The file that should be uploaded.\n   * @returns The URL of the uploaded file OR an object containing props that should be set on the file block (such as an id)\n   */\n  uploadFile: (file: File) => Promise<string | Record<string, any>>;\n\n  /**\n   * Resolve a URL of a file block to one that can be displayed or downloaded. This can be used for creating authenticated URL or\n   * implementing custom protocols / schemes\n   * @returns The URL that's\n   */\n  resolveFileUrl: (url: string) => Promise<string>;\n\n  /**\n   * When enabled, allows for collaboration between multiple users.\n   */\n  collaboration: {\n    /**\n     * The Yjs XML fragment that's used for collaboration.\n     */\n    fragment: Y.XmlFragment;\n    /**\n     * The user info for the current user that's shown to other collaborators.\n     */\n    user: {\n      name: string;\n      color: string;\n    };\n    /**\n     * A Yjs provider (used for awareness / cursor information)\n     */\n    provider: any;\n    /**\n     * Optional function to customize how cursors of users are rendered\n     */\n    renderCursor?: (user: any) => HTMLElement;\n  };\n\n  // tiptap options, undocumented\n  _tiptapOptions: Partial<EditorOptions> | ((editor: BlockNoteEditor<BSchema, ISchema, SSchema>) => Partial<EditorOptions>);\n\n  trailingBlock?: boolean;\n};\n\nconst blockNoteTipTapOptions = {\n  enableInputRules: true,\n  enablePasteRules: true,\n  enableCoreExtensions: false,\n};\n\nexport class BlockNoteEditor<\n  BSchema extends BlockSchema = DefaultBlockSchema,\n  ISchema extends InlineContentSchema = DefaultInlineContentSchema,\n  SSchema extends StyleSchema = DefaultStyleSchema\n> {\n  public readonly _tiptapEditor: BlockNoteTipTapEditor & {\n    contentComponent: any;\n  };\n  public blockCache = new WeakMap<Node, Block<any, any, any>>();\n  public readonly dictionary: Dictionary;\n\n  public readonly schema: BlockNoteSchema<BSchema, ISchema, SSchema>;\n\n  public readonly blockImplementations: BlockSpecs;\n  public readonly inlineContentImplementations: InlineContentSpecs;\n  public readonly styleImplementations: StyleSpecs;\n\n  public readonly formattingToolbar: FormattingToolbarProsemirrorPlugin;\n  public readonly linkToolbar: LinkToolbarProsemirrorPlugin<\n    BSchema,\n    ISchema,\n    SSchema\n  >;\n  public readonly sideMenu: SideMenuProsemirrorPlugin<\n    BSchema,\n    ISchema,\n    SSchema\n  >;\n  public readonly suggestionMenus: SuggestionMenuProseMirrorPlugin<\n    BSchema,\n    ISchema,\n    SSchema\n  >;\n  public readonly filePanel?: FilePanelProsemirrorPlugin<ISchema, SSchema>;\n  public readonly tableHandles?: TableHandlesProsemirrorPlugin<\n    ISchema,\n    SSchema\n  >;\n\n  public readonly uploadFile:\n    | ((file: File) => Promise<string | Record<string, any>>)\n    | undefined;\n\n  public readonly resolveFileUrl: (url: string) => Promise<string>;\n\n  public static create<\n    BSchema extends BlockSchema = DefaultBlockSchema,\n    ISchema extends InlineContentSchema = DefaultInlineContentSchema,\n    SSchema extends StyleSchema = DefaultStyleSchema\n  >(options: Partial<BlockNoteEditorOptions<BSchema, ISchema, SSchema>> = {}) {\n    return new BlockNoteEditor<BSchema, ISchema, SSchema>(options);\n  }\n\n  private constructor(\n    private readonly options: Partial<BlockNoteEditorOptions<any, any, any>>\n  ) {\n    const anyOpts = options as any;\n    if (anyOpts.onEditorContentChange) {\n      throw new Error(\n        \"onEditorContentChange initialization option is deprecated, use <BlockNoteView onChange={...} />, the useEditorChange(...) hook, or editor.onChange(...)\"\n      );\n    }\n\n    if (anyOpts.onTextCursorPositionChange) {\n      throw new Error(\n        \"onTextCursorPositionChange initialization option is deprecated, use <BlockNoteView onSelectionChange={...} />, the useEditorSelectionChange(...) hook, or editor.onSelectionChange(...)\"\n      );\n    }\n\n    if (anyOpts.onEditorReady) {\n      throw new Error(\n        \"onEditorReady is deprecated. Editor is immediately ready for use after creation.\"\n      );\n    }\n\n    if (anyOpts.editable) {\n      throw new Error(\n        \"editable initialization option is deprecated, use <BlockNoteView editable={true/false} />, or alternatively editor.isEditable = true/false\"\n      );\n    }\n\n    this.dictionary = options.dictionary || en;\n\n    // apply defaults\n    const newOptions = {\n      defaultStyles: true,\n      schema: options.schema || BlockNoteSchema.create(),\n      ...options,\n      placeholders: {\n        ...this.dictionary.placeholders,\n        ...options.placeholders,\n      },\n    };\n\n    // @ts-ignore\n    this.schema = newOptions.schema;\n    this.blockImplementations = newOptions.schema.blockSpecs;\n    this.inlineContentImplementations = newOptions.schema.inlineContentSpecs;\n    this.styleImplementations = newOptions.schema.styleSpecs;\n\n    this.formattingToolbar = new FormattingToolbarProsemirrorPlugin(this);\n    this.linkToolbar = new LinkToolbarProsemirrorPlugin(this);\n    this.sideMenu = new SideMenuProsemirrorPlugin(this);\n    this.suggestionMenus = new SuggestionMenuProseMirrorPlugin(this);\n    this.filePanel = new FilePanelProsemirrorPlugin(this as any);\n\n    if (checkDefaultBlockTypeInSchema(\"table\", this)) {\n      this.tableHandles = new TableHandlesProsemirrorPlugin(this as any);\n    }\n\n    const extensions = getBlockNoteExtensions({\n      editor: this,\n      domAttributes: newOptions.domAttributes || {},\n      blockSchema: this.schema.blockSchema,\n      blockSpecs: this.schema.blockSpecs,\n      styleSpecs: this.schema.styleSpecs,\n      inlineContentSpecs: this.schema.inlineContentSpecs,\n      collaboration: newOptions.collaboration,\n      trailingBlock: newOptions.trailingBlock,\n      disableExtensions: newOptions.disableExtensions,\n    });\n\n    const blockNoteUIExtension = Extension.create({\n      name: \"BlockNoteUIExtension\",\n\n      addProseMirrorPlugins: () => {\n        return [\n          this.formattingToolbar.plugin,\n          this.linkToolbar.plugin,\n          this.sideMenu.plugin,\n          this.suggestionMenus.plugin,\n          ...(this.filePanel ? [this.filePanel.plugin] : []),\n          ...(this.tableHandles ? [this.tableHandles.plugin] : []),\n          PlaceholderPlugin(this, newOptions.placeholders),\n        ];\n      },\n    });\n    extensions.push(blockNoteUIExtension);\n\n    this.uploadFile = newOptions.uploadFile;\n    this.resolveFileUrl = newOptions.resolveFileUrl || (async (url) => url);\n\n    if (newOptions.collaboration && newOptions.initialContent) {\n      // eslint-disable-next-line no-console\n      console.warn(\n        \"When using Collaboration, initialContent might cause conflicts, because changes should come from the collaboration provider\"\n      );\n    }\n\n    const initialContent =\n      newOptions.initialContent ||\n      (options.collaboration\n        ? [\n            {\n              type: \"paragraph\",\n              id: \"initialBlockId\",\n            },\n          ]\n        : [\n            {\n              type: \"paragraph\",\n              id: UniqueID.options.generateID(),\n            },\n          ]);\n\n    if (!Array.isArray(initialContent) || initialContent.length === 0) {\n      throw new Error(\n        \"initialContent must be a non-empty array of blocks, received: \" +\n          initialContent\n      );\n    }\n\n    const tiptapOptionParams = typeof newOptions._tiptapOptions === 'function' ? newOptions._tiptapOptions(this) : newOptions._tiptapOptions;\n\n\n    const tiptapOptions: BlockNoteTipTapEditorOptions = {\n      ...blockNoteTipTapOptions,\n      ...newOptions._tiptapOptions,\n      content: initialContent,\n      extensions: [\n        ...(tiptapOptionParams?.extensions || []),\n        ...extensions,\n      ],\n      editorProps: {\n        ...tiptapOptionParams?.editorProps,\n        attributes: {\n          ...tiptapOptionParams?.editorProps?.attributes,\n          ...newOptions.domAttributes?.editor,\n          class: mergeCSSClasses(\n            \"bn-editor\",\n            newOptions.defaultStyles ? \"bn-default-styles\" : \"\",\n            newOptions.domAttributes?.editor?.class || \"\"\n          ),\n        },\n        transformPasted,\n      },\n    };\n\n    this._tiptapEditor = new BlockNoteTipTapEditor(\n      tiptapOptions,\n      this.schema.styleSchema\n    ) as BlockNoteTipTapEditor & {\n      contentComponent: any;\n    };\n  }\n\n  /**\n   * Mount the editor to a parent DOM element. Call mount(undefined) to clean up\n   *\n   * @warning Not needed for React, use BlockNoteView to take care of this\n   */\n  public mount(parentElement?: HTMLElement | null) {\n    this._tiptapEditor.mount(parentElement);\n  }\n\n  public get prosemirrorView() {\n    return this._tiptapEditor.view;\n  }\n\n  public get domElement() {\n    return this._tiptapEditor.view.dom as HTMLDivElement;\n  }\n\n  public isFocused() {\n    return this._tiptapEditor.view.hasFocus();\n  }\n\n  public focus() {\n    this._tiptapEditor.view.focus();\n  }\n\n  /**\n   * @deprecated, use `editor.document` instead\n   */\n  public get topLevelBlocks(): Block<BSchema, ISchema, SSchema>[] {\n    return this.topLevelBlocks;\n  }\n\n  /**\n   * Gets a snapshot of all top-level (non-nested) blocks in the editor.\n   * @returns A snapshot of all top-level (non-nested) blocks in the editor.\n   */\n  public get document(): Block<BSchema, ISchema, SSchema>[] {\n    const blocks: Block<BSchema, ISchema, SSchema>[] = [];\n\n    this._tiptapEditor.state.doc.firstChild!.descendants((node) => {\n      blocks.push(\n        nodeToBlock(\n          node,\n          this.schema.blockSchema,\n          this.schema.inlineContentSchema,\n          this.schema.styleSchema,\n          this.blockCache\n        )\n      );\n\n      return false;\n    });\n\n    return blocks;\n  }\n\n  /**\n   * Gets a snapshot of an existing block from the editor.\n   * @param blockIdentifier The identifier of an existing block that should be retrieved.\n   * @returns The block that matches the identifier, or `undefined` if no matching block was found.\n   */\n  public getBlock(\n    blockIdentifier: BlockIdentifier\n  ): Block<BSchema, ISchema, SSchema> | undefined {\n    const id =\n      typeof blockIdentifier === \"string\"\n        ? blockIdentifier\n        : blockIdentifier.id;\n    let newBlock: Block<BSchema, ISchema, SSchema> | undefined = undefined;\n\n    this._tiptapEditor.state.doc.firstChild!.descendants((node) => {\n      if (typeof newBlock !== \"undefined\") {\n        return false;\n      }\n\n      if (node.type.name !== \"blockContainer\" || node.attrs.id !== id) {\n        return true;\n      }\n\n      newBlock = nodeToBlock(\n        node,\n        this.schema.blockSchema,\n        this.schema.inlineContentSchema,\n        this.schema.styleSchema,\n        this.blockCache\n      );\n\n      return false;\n    });\n\n    return newBlock;\n  }\n\n  /**\n   * Traverses all blocks in the editor depth-first, and executes a callback for each.\n   * @param callback The callback to execute for each block. Returning `false` stops the traversal.\n   * @param reverse Whether the blocks should be traversed in reverse order.\n   */\n  public forEachBlock(\n    callback: (block: Block<BSchema, ISchema, SSchema>) => boolean,\n    reverse = false\n  ): void {\n    const blocks = this.document.slice();\n\n    if (reverse) {\n      blocks.reverse();\n    }\n\n    function traverseBlockArray(\n      blockArray: Block<BSchema, ISchema, SSchema>[]\n    ): boolean {\n      for (const block of blockArray) {\n        if (!callback(block)) {\n          return false;\n        }\n\n        const children = reverse\n          ? block.children.slice().reverse()\n          : block.children;\n\n        if (!traverseBlockArray(children)) {\n          return false;\n        }\n      }\n\n      return true;\n    }\n\n    traverseBlockArray(blocks);\n  }\n\n  /**\n   * Executes a callback whenever the editor's contents change.\n   * @param callback The callback to execute.\n   */\n  public onEditorContentChange(callback: () => void) {\n    this._tiptapEditor.on(\"update\", callback);\n  }\n\n  /**\n   * Executes a callback whenever the editor's selection changes.\n   * @param callback The callback to execute.\n   */\n  public onEditorSelectionChange(callback: () => void) {\n    this._tiptapEditor.on(\"selectionUpdate\", callback);\n  }\n\n  /**\n   * Gets a snapshot of the current text cursor position.\n   * @returns A snapshot of the current text cursor position.\n   */\n  public getTextCursorPosition(): TextCursorPosition<\n    BSchema,\n    ISchema,\n    SSchema\n  > {\n    const { node, depth, startPos, endPos } = getBlockInfoFromPos(\n      this._tiptapEditor.state.doc,\n      this._tiptapEditor.state.selection.from\n    )!;\n\n    // Index of the current blockContainer node relative to its parent blockGroup.\n    const nodeIndex = this._tiptapEditor.state.doc\n      .resolve(endPos)\n      .index(depth - 1);\n    // Number of the parent blockGroup's child blockContainer nodes.\n    const numNodes = this._tiptapEditor.state.doc\n      .resolve(endPos + 1)\n      .node().childCount;\n\n    // Gets previous blockContainer node at the same nesting level, if the current node isn't the first child.\n    let prevNode: Node | undefined = undefined;\n    if (nodeIndex > 0) {\n      prevNode = this._tiptapEditor.state.doc.resolve(startPos - 2).node();\n    }\n\n    // Gets next blockContainer node at the same nesting level, if the current node isn't the last child.\n    let nextNode: Node | undefined = undefined;\n    if (nodeIndex < numNodes - 1) {\n      nextNode = this._tiptapEditor.state.doc.resolve(endPos + 2).node();\n    }\n\n    return {\n      block: nodeToBlock(\n        node,\n        this.schema.blockSchema,\n        this.schema.inlineContentSchema,\n        this.schema.styleSchema,\n        this.blockCache\n      ),\n      prevBlock:\n        prevNode === undefined\n          ? undefined\n          : nodeToBlock(\n              prevNode,\n              this.schema.blockSchema,\n              this.schema.inlineContentSchema,\n              this.schema.styleSchema,\n              this.blockCache\n            ),\n      nextBlock:\n        nextNode === undefined\n          ? undefined\n          : nodeToBlock(\n              nextNode,\n              this.schema.blockSchema,\n              this.schema.inlineContentSchema,\n              this.schema.styleSchema,\n              this.blockCache\n            ),\n    };\n  }\n\n  /**\n   * Sets the text cursor position to the start or end of an existing block. Throws an error if the target block could\n   * not be found.\n   * @param targetBlock The identifier of an existing block that the text cursor should be moved to.\n   * @param placement Whether the text cursor should be placed at the start or end of the block.\n   */\n  public setTextCursorPosition(\n    targetBlock: BlockIdentifier,\n    placement: \"start\" | \"end\" = \"start\"\n  ) {\n    const id = typeof targetBlock === \"string\" ? targetBlock : targetBlock.id;\n\n    const { posBeforeNode } = getNodeById(id, this._tiptapEditor.state.doc);\n    const { startPos, contentNode } = getBlockInfoFromPos(\n      this._tiptapEditor.state.doc,\n      posBeforeNode + 2\n    )!;\n\n    const contentType: \"none\" | \"inline\" | \"table\" =\n      this.schema.blockSchema[contentNode.type.name]!.content;\n\n    if (contentType === \"none\") {\n      this._tiptapEditor.commands.setNodeSelection(startPos);\n      return;\n    }\n\n    if (contentType === \"inline\") {\n      if (placement === \"start\") {\n        this._tiptapEditor.commands.setTextSelection(startPos + 1);\n      } else {\n        this._tiptapEditor.commands.setTextSelection(\n          startPos + contentNode.nodeSize - 1\n        );\n      }\n    } else if (contentType === \"table\") {\n      if (placement === \"start\") {\n        // Need to offset the position as we have to get through the `tableRow`\n        // and `tableCell` nodes to get to the `tableParagraph` node we want to\n        // set the selection in.\n        this._tiptapEditor.commands.setTextSelection(startPos + 4);\n      } else {\n        this._tiptapEditor.commands.setTextSelection(\n          startPos + contentNode.nodeSize - 4\n        );\n      }\n    } else {\n      throw new UnreachableCaseError(contentType);\n    }\n  }\n\n  /**\n   * Gets a snapshot of the current selection.\n   */\n  public getSelection(): Selection<BSchema, ISchema, SSchema> | undefined {\n    // Either the TipTap selection is empty, or it's a node selection. In either\n    // case, it only spans one block, so we return undefined.\n    if (\n      this._tiptapEditor.state.selection.from ===\n        this._tiptapEditor.state.selection.to ||\n      \"node\" in this._tiptapEditor.state.selection\n    ) {\n      return undefined;\n    }\n\n    const blocks: Block<BSchema, ISchema, SSchema>[] = [];\n\n    // TODO: This adds all child blocks to the same array. Needs to find min\n    //  depth and only add blocks at that depth.\n    this._tiptapEditor.state.doc.descendants((node, pos) => {\n      if (node.type.spec.group !== \"blockContent\") {\n        return true;\n      }\n\n      if (\n        pos + node.nodeSize < this._tiptapEditor.state.selection.from ||\n        pos > this._tiptapEditor.state.selection.to\n      ) {\n        return true;\n      }\n\n      blocks.push(\n        nodeToBlock(\n          this._tiptapEditor.state.doc.resolve(pos).node(),\n          this.schema.blockSchema,\n          this.schema.inlineContentSchema,\n          this.schema.styleSchema,\n          this.blockCache\n        )\n      );\n\n      return false;\n    });\n\n    return { blocks: blocks };\n  }\n\n  /**\n   * Checks if the editor is currently editable, or if it's locked.\n   * @returns True if the editor is editable, false otherwise.\n   */\n  public get isEditable(): boolean {\n    return this._tiptapEditor.isEditable;\n  }\n\n  /**\n   * Makes the editor editable or locks it, depending on the argument passed.\n   * @param editable True to make the editor editable, or false to lock it.\n   */\n  public set isEditable(editable: boolean) {\n    if (this._tiptapEditor.options.editable !== editable) {\n      this._tiptapEditor.setEditable(editable);\n    }\n  }\n\n  /**\n   * Inserts new blocks into the editor. If a block's `id` is undefined, BlockNote generates one automatically. Throws an\n   * error if the reference block could not be found.\n   * @param blocksToInsert An array of partial blocks that should be inserted.\n   * @param referenceBlock An identifier for an existing block, at which the new blocks should be inserted.\n   * @param placement Whether the blocks should be inserted just before, just after, or nested inside the\n   * `referenceBlock`. Inserts the blocks at the start of the existing block's children if \"nested\" is used.\n   */\n  public insertBlocks(\n    blocksToInsert: PartialBlock<BSchema, ISchema, SSchema>[],\n    referenceBlock: BlockIdentifier,\n    placement: \"before\" | \"after\" | \"nested\" = \"before\"\n  ) {\n    return insertBlocks(blocksToInsert, referenceBlock, placement, this);\n  }\n\n  /**\n   * Updates an existing block in the editor. Since updatedBlock is a PartialBlock object, some fields might not be\n   * defined. These undefined fields are kept as-is from the existing block. Throws an error if the block to update could\n   * not be found.\n   * @param blockToUpdate The block that should be updated.\n   * @param update A partial block which defines how the existing block should be changed.\n   */\n  public updateBlock(\n    blockToUpdate: BlockIdentifier,\n    update: PartialBlock<BSchema, ISchema, SSchema>\n  ) {\n    return updateBlock(blockToUpdate, update, this);\n  }\n\n  /**\n   * Removes existing blocks from the editor. Throws an error if any of the blocks could not be found.\n   * @param blocksToRemove An array of identifiers for existing blocks that should be removed.\n   */\n  public removeBlocks(blocksToRemove: BlockIdentifier[]) {\n    return removeBlocks(blocksToRemove, this);\n  }\n\n  /**\n   * Replaces existing blocks in the editor with new blocks. If the blocks that should be removed are not adjacent or\n   * are at different nesting levels, `blocksToInsert` will be inserted at the position of the first block in\n   * `blocksToRemove`. Throws an error if any of the blocks to remove could not be found.\n   * @param blocksToRemove An array of blocks that should be replaced.\n   * @param blocksToInsert An array of partial blocks to replace the old ones with.\n   */\n  public replaceBlocks(\n    blocksToRemove: BlockIdentifier[],\n    blocksToInsert: PartialBlock<BSchema, ISchema, SSchema>[]\n  ) {\n    return replaceBlocks(blocksToRemove, blocksToInsert, this);\n  }\n\n  /**\n   * Insert a piece of content at the current cursor position.\n   *\n   * @param content can be a string, or array of partial inline content elements\n   */\n  public insertInlineContent(content: PartialInlineContent<ISchema, SSchema>) {\n    const nodes = inlineContentToNodes(\n      content,\n      this._tiptapEditor.schema,\n      this.schema.styleSchema\n    );\n\n    insertContentAt(\n      {\n        from: this._tiptapEditor.state.selection.from,\n        to: this._tiptapEditor.state.selection.to,\n      },\n      nodes,\n      this\n    );\n  }\n\n  /**\n   * Gets the active text styles at the text cursor position or at the end of the current selection if it's active.\n   */\n  public getActiveStyles() {\n    const styles: Styles<SSchema> = {};\n    const marks = this._tiptapEditor.state.selection.$to.marks();\n\n    for (const mark of marks) {\n      const config = this.schema.styleSchema[mark.type.name];\n      if (!config) {\n        if (mark.type.name !== \"link\") {\n          // eslint-disable-next-line no-console\n          console.warn(\"mark not found in styleschema\", mark.type.name);\n        }\n\n        continue;\n      }\n      if (config.propSchema === \"boolean\") {\n        (styles as any)[config.type] = true;\n      } else {\n        (styles as any)[config.type] = mark.attrs.stringValue;\n      }\n    }\n\n    return styles;\n  }\n\n  /**\n   * Adds styles to the currently selected content.\n   * @param styles The styles to add.\n   */\n  public addStyles(styles: Styles<SSchema>) {\n    for (const [style, value] of Object.entries(styles)) {\n      const config = this.schema.styleSchema[style];\n      if (!config) {\n        throw new Error(`style ${style} not found in styleSchema`);\n      }\n      if (config.propSchema === \"boolean\") {\n        this._tiptapEditor.commands.setMark(style);\n      } else if (config.propSchema === \"string\") {\n        this._tiptapEditor.commands.setMark(style, { stringValue: value });\n      } else {\n        throw new UnreachableCaseError(config.propSchema);\n      }\n    }\n  }\n\n  /**\n   * Removes styles from the currently selected content.\n   * @param styles The styles to remove.\n   */\n  public removeStyles(styles: Styles<SSchema>) {\n    for (const style of Object.keys(styles)) {\n      this._tiptapEditor.commands.unsetMark(style);\n    }\n  }\n\n  /**\n   * Toggles styles on the currently selected content.\n   * @param styles The styles to toggle.\n   */\n  public toggleStyles(styles: Styles<SSchema>) {\n    for (const [style, value] of Object.entries(styles)) {\n      const config = this.schema.styleSchema[style];\n      if (!config) {\n        throw new Error(`style ${style} not found in styleSchema`);\n      }\n      if (config.propSchema === \"boolean\") {\n        this._tiptapEditor.commands.toggleMark(style);\n      } else if (config.propSchema === \"string\") {\n        this._tiptapEditor.commands.toggleMark(style, { stringValue: value });\n      } else {\n        throw new UnreachableCaseError(config.propSchema);\n      }\n    }\n  }\n\n  /**\n   * Gets the currently selected text.\n   */\n  public getSelectedText() {\n    return this._tiptapEditor.state.doc.textBetween(\n      this._tiptapEditor.state.selection.from,\n      this._tiptapEditor.state.selection.to\n    );\n  }\n\n  /**\n   * Gets the URL of the last link in the current selection, or `undefined` if there are no links in the selection.\n   */\n  public getSelectedLinkUrl() {\n    return this._tiptapEditor.getAttributes(\"link\").href as string | undefined;\n  }\n\n  /**\n   * Creates a new link to replace the selected content.\n   * @param url The link URL.\n   * @param text The text to display the link with.\n   */\n  public createLink(url: string, text?: string) {\n    if (url === \"\") {\n      return;\n    }\n\n    const { from, to } = this._tiptapEditor.state.selection;\n\n    if (!text) {\n      text = this._tiptapEditor.state.doc.textBetween(from, to);\n    }\n\n    const mark = this._tiptapEditor.schema.mark(\"link\", { href: url });\n\n    this._tiptapEditor.view.dispatch(\n      this._tiptapEditor.view.state.tr\n        .insertText(text, from, to)\n        .addMark(from, from + text.length, mark)\n    );\n  }\n\n  /**\n   * Checks if the block containing the text cursor can be nested.\n   */\n  public canNestBlock() {\n    const { startPos, depth } = getBlockInfoFromPos(\n      this._tiptapEditor.state.doc,\n      this._tiptapEditor.state.selection.from\n    )!;\n\n    return this._tiptapEditor.state.doc.resolve(startPos).index(depth - 1) > 0;\n  }\n\n  /**\n   * Nests the block containing the text cursor into the block above it.\n   */\n  public nestBlock() {\n    this._tiptapEditor.commands.sinkListItem(\"blockContainer\");\n  }\n\n  /**\n   * Checks if the block containing the text cursor is nested.\n   */\n  public canUnnestBlock() {\n    const { depth } = getBlockInfoFromPos(\n      this._tiptapEditor.state.doc,\n      this._tiptapEditor.state.selection.from\n    )!;\n\n    return depth > 2;\n  }\n\n  /**\n   * Lifts the block containing the text cursor out of its parent.\n   */\n  public unnestBlock() {\n    this._tiptapEditor.commands.liftListItem(\"blockContainer\");\n  }\n\n  // TODO: Fix when implementing HTML/Markdown import & export\n  /**\n   * Serializes blocks into an HTML string. To better conform to HTML standards, children of blocks which aren't list\n   * items are un-nested in the output HTML.\n   * @param blocks An array of blocks that should be serialized into HTML.\n   * @returns The blocks, serialized as an HTML string.\n   */\n  public async blocksToHTMLLossy(\n    blocks: Block<BSchema, ISchema, SSchema>[] = this.document\n  ): Promise<string> {\n    const exporter = createExternalHTMLExporter(\n      this._tiptapEditor.schema,\n      this\n    );\n    return exporter.exportBlocks(blocks);\n  }\n\n  /**\n   * Parses blocks from an HTML string. Tries to create `Block` objects out of any HTML block-level elements, and\n   * `InlineNode` objects from any HTML inline elements, though not all element types are recognized. If BlockNote\n   * doesn't recognize an HTML element's tag, it will parse it as a paragraph or plain text.\n   * @param html The HTML string to parse blocks from.\n   * @returns The blocks parsed from the HTML string.\n   */\n  public async tryParseHTMLToBlocks(\n    html: string\n  ): Promise<Block<BSchema, ISchema, SSchema>[]> {\n    return HTMLToBlocks(\n      html,\n      this.schema.blockSchema,\n      this.schema.inlineContentSchema,\n      this.schema.styleSchema,\n      this._tiptapEditor.schema\n    );\n  }\n\n  /**\n   * Serializes blocks into a Markdown string. The output is simplified as Markdown does not support all features of\n   * BlockNote - children of blocks which aren't list items are un-nested and certain styles are removed.\n   * @param blocks An array of blocks that should be serialized into Markdown.\n   * @returns The blocks, serialized as a Markdown string.\n   */\n  public async blocksToMarkdownLossy(\n    blocks: Block<BSchema, ISchema, SSchema>[] = this.document\n  ): Promise<string> {\n    return blocksToMarkdown(blocks, this._tiptapEditor.schema, this);\n  }\n\n  /**\n   * Creates a list of blocks from a Markdown string. Tries to create `Block` and `InlineNode` objects based on\n   * Markdown syntax, though not all symbols are recognized. If BlockNote doesn't recognize a symbol, it will parse it\n   * as text.\n   * @param markdown The Markdown string to parse blocks from.\n   * @returns The blocks parsed from the Markdown string.\n   */\n  public async tryParseMarkdownToBlocks(\n    markdown: string\n  ): Promise<Block<BSchema, ISchema, SSchema>[]> {\n    return markdownToBlocks(\n      markdown,\n      this.schema.blockSchema,\n      this.schema.inlineContentSchema,\n      this.schema.styleSchema,\n      this._tiptapEditor.schema\n    );\n  }\n\n  /**\n   * Updates the user info for the current user that's shown to other collaborators.\n   */\n  public updateCollaborationUserInfo(user: { name: string; color: string }) {\n    if (!this.options.collaboration) {\n      throw new Error(\n        \"Cannot update collaboration user info when collaboration is disabled.\"\n      );\n    }\n    this._tiptapEditor.commands.updateUser(user);\n  }\n\n  /**\n   * A callback function that runs whenever the editor's contents change.\n   *\n   * @param callback The callback to execute.\n   * @returns A function to remove the callback.\n   */\n  public onChange(\n    callback: (editor: BlockNoteEditor<BSchema, ISchema, SSchema>) => void\n  ) {\n    const cb = () => {\n      callback(this);\n    };\n\n    this._tiptapEditor.on(\"update\", cb);\n\n    return () => {\n      this._tiptapEditor.off(\"update\", cb);\n    };\n  }\n\n  /**\n   * A callback function that runs whenever the text cursor position or selection changes.\n   *\n   * @param callback The callback to execute.\n   * @returns A function to remove the callback.\n   */\n  public onSelectionChange(\n    callback: (editor: BlockNoteEditor<BSchema, ISchema, SSchema>) => void\n  ) {\n    const cb = () => {\n      callback(this);\n    };\n\n    this._tiptapEditor.on(\"selectionUpdate\", cb);\n\n    return () => {\n      this._tiptapEditor.off(\"selectionUpdate\", cb);\n    };\n  }\n}\n","import { Block, PartialBlock } from \"../../blocks/defaultBlocks\";\nimport UniqueID from \"../../extensions/UniqueID/UniqueID\";\nimport { BlockSchema, TableContent } from \"../../schema/blocks/types\";\nimport {\n  InlineContent,\n  InlineContentSchema,\n  PartialInlineContent,\n  StyledText,\n  isPartialLinkInlineContent,\n  isStyledTextInlineContent,\n} from \"../../schema/inlineContent/types\";\nimport { StyleSchema } from \"../../schema/styles/types\";\n\nfunction textShorthandToStyledText(\n  content: string | StyledText<any>[] = \"\"\n): StyledText<any>[] {\n  if (typeof content === \"string\") {\n    return [\n      {\n        type: \"text\",\n        text: content,\n        styles: {},\n      },\n    ];\n  }\n  return content;\n}\n\nfunction partialContentToInlineContent(\n  content: PartialInlineContent<any, any> | TableContent<any> | undefined\n): InlineContent<any, any>[] | TableContent<any> | undefined {\n  if (typeof content === \"string\") {\n    return textShorthandToStyledText(content);\n  }\n\n  if (Array.isArray(content)) {\n    return content.flatMap((partialContent) => {\n      if (typeof partialContent === \"string\") {\n        return textShorthandToStyledText(partialContent);\n      } else if (isPartialLinkInlineContent(partialContent)) {\n        return {\n          ...partialContent,\n          content: textShorthandToStyledText(partialContent.content),\n        };\n      } else if (isStyledTextInlineContent(partialContent)) {\n        return partialContent;\n      } else {\n        // custom inline content\n\n        return {\n          props: {},\n          ...partialContent,\n          content: partialContentToInlineContent(partialContent.content),\n        } as any;\n      }\n    });\n  }\n\n  return content;\n}\n\nexport function partialBlocksToBlocksForTesting<\n  BSchema extends BlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(\n  schema: BSchema,\n  partialBlocks: Array<PartialBlock<BSchema, I, S>>\n): Array<Block<BSchema, I, S>> {\n  return partialBlocks.map((partialBlock) =>\n    partialBlockToBlockForTesting(schema, partialBlock)\n  );\n}\n\nexport function partialBlockToBlockForTesting<\n  BSchema extends BlockSchema,\n  I extends InlineContentSchema,\n  S extends StyleSchema\n>(\n  schema: BSchema,\n  partialBlock: PartialBlock<BSchema, I, S>\n): Block<BSchema, I, S> {\n  const withDefaults: Block<BSchema, I, S> = {\n    id: \"\",\n    type: partialBlock.type!,\n    props: {} as any,\n    content:\n      schema[partialBlock.type!].content === \"inline\" ? [] : (undefined as any),\n    children: [] as any,\n    ...partialBlock,\n  };\n\n  Object.entries(schema[partialBlock.type!].propSchema).forEach(\n    ([propKey, propValue]) => {\n      if (withDefaults.props[propKey] === undefined) {\n        (withDefaults.props as any)[propKey] = propValue.default;\n      }\n    }\n  );\n\n  return {\n    ...withDefaults,\n    content: partialContentToInlineContent(withDefaults.content),\n    children: withDefaults.children.map((c) => {\n      return partialBlockToBlockForTesting(schema, c);\n    }),\n  } as any;\n}\n\nexport function addIdsToBlock(block: PartialBlock<any, any, any>) {\n  if (!block.id) {\n    block.id = UniqueID.options.generateID();\n  }\n  if (block.children) {\n    addIdsToBlocks(block.children);\n  }\n}\n\nexport function addIdsToBlocks(blocks: PartialBlock<any, any, any>[]) {\n  for (const block of blocks) {\n    addIdsToBlock(block);\n  }\n}\n"],"names":["ar","en","removeDuplicates","array","by","seen","item","key","findDuplicates","items","filtered","el","index","UniqueID","Extension","testOptions","v4","element","attributes","dragSourceElement","transformPasted","Plugin","PluginKey","transactions","oldState","newState","docChanges","transaction","filterTransactions","tr","_a","_b","types","attributeName","generateID","transform","combineTransactionSteps","mapping","getChangedRanges","newRange","newNodes","findChildrenInRange","node","newIds","id","duplicatedNewIds","pos","initialDoc","jsonNode","deleted","view","handleDragstart","event","slice","removeId","fragment","list","nodeWithoutId","Fragment","Slice","getBlockInfo","blockContainer","contentNode","contentType","numChildBlocks","getBlockInfoFromPos","doc","outerBlockGroupEndPos","$pos","maxDepth","depth","startPos","endPos","isLinkInlineContent","content","isPartialLinkInlineContent","isStyledTextInlineContent","UnreachableCaseError","val","assertEmpty","obj","throwError","dataTest","rest","styledTextToNodes","styledText","schema","styleSchema","marks","style","value","config","text","linkToNodes","link","linkMark","styledTextArrayToNodes","nodes","inlineContentToNodes","blockContent","blockOrInlineContentToContentNode","tableContentToNodes","tableContent","rowNodes","row","columnNodes","cell","pNode","textNodes","cellNode","rowNode","block","type","blockToNode","children","child","groupNode","contentNodeToTableContent","inlineContentSchema","ret","contentNodeToInlineContent","currentContent","nodeToCustomInlineContent","styles","mark","props","icConfig","attr","propSchema","nodeToBlock","blockSchema","blockCache","cachedBlock","blockInfo","blockSpec","blockConfig","i","options","serializeNodeInner","serializer","editor","toExternalHTML","dom","contentDOM","DOMSerializer","blockContentNode","blockGroupNode","impl","serializeProseMirrorFragment","internalHTML","parent","simplifyBlocks","listItemBlockTypes","simplifyBlocksHelper","tree","blockGroup","numChildElements","activeList","isListItemBlock","listItemBlockType","numElementsRemoved","fromDom","listItemElement","numElementsAdded","createExternalHTMLExporter","unified","rehypeParse","rehypeStringify","blocks","createInternalHTMLSerializer","isAppleOS","formatKeyboardShortcut","shortcut","ctrlText","mergeCSSClasses","classes","c","isSafari","createDefaultBlockDOMOutputSpec","blockName","htmlTag","blockContentHTMLAttributes","inlineContentHTMLAttributes","attribute","inlineContent","defaultBlockToHTML","toDOM","renderSpec","defaultProps","inheritedProps","camelToDataKebab","str","filenameFromURL","url","parts","propsToAttributes","tiptapAttributes","name","_spec","spec","asNumber","getBlockFromPos","getPos","tipTapEditor","blockIdentifier","wrapInBlockStructure","blockType","blockProps","isFileBlock","domAttributes","prop","createStronglyTypedTiptapNode","Node","createInternalBlockSpec","implementation","createBlockSpecFromStronglyTypedTiptapNode","requiredExtensions","getBlockSchemaFromSpecs","specs","getParseRules","customParseFunction","rules","createBlockSpec","blockImplementation","div","blockContentDOMAttributes","output","addInlineContentAttributes","inlineContentType","inlineContentProps","addInlineContentKeyboardShortcuts","resolvedPos","createInternalInlineContentSpec","createInlineContentSpecFromTipTapNode","getInlineContentSchemaFromSpecs","getInlineContentParseRules","htmlElement","createInlineContentSpec","inlineContentConfig","inlineContentImplementation","stylePropsToAttributes","addStyleAttributes","styleType","styleValue","createInternalStyleSpec","createStyleSpecFromTipTapMark","getStyleSchemaFromSpecs","getStyleParseRules","createStyleSpec","styleConfig","styleImplementation","Mark","renderResult","createDefaultFilePreview","file","icon","fileName","createFileAndCaptionWrapper","fileAndCaptionWrapper","caption","createAddFileButton","buttonText","buttonIcon","addFileButton","addFileButtonIcon","addFileButtonText","addFileButtonMouseDownHandler","addFileButtonClickHandler","parseEmbedElement","embedElement","parseFigureElement","figureElement","targetTag","targetElement","captionElement","createLinkWithCaption","wrapper","fileCaption","createFigureWithCaption","figure","createResizeHandlesWrapper","getWidth","setWidth","leftResizeHandle","rightResizeHandle","resizeParams","windowMouseMoveHandler","newWidth","minWidth","windowMouseUpHandler","elementMouseEnterHandler","elementMouseLeaveHandler","leftResizeHandleMouseDownHandler","rightResizeHandleMouseDownHandler","filePropSchema","fileBlockConfig","fileRender","fileParse","parsedFigure","fileToExternalHTML","fileSrcLink","FileBlock","parseImageElement","imageElement","previewWidth","imagePropSchema","imageBlockConfig","imageRender","fileBlockImageIcon","addImageButton","image","downloadUrl","width","imageParse","imageToExternalHTML","ImageBlock","parseVideoElement","videoElement","videoPropSchema","videoBlockConfig","videoRender","fileBlockVideoIcon","addVideoButton","video","videoParse","videoToExternalHTML","VideoBlock","parseAudioElement","audioElement","audioPropSchema","audioBlockConfig","audioRender","fileBlockAudioIcon","addAudioButton","audio","audioParse","audioToExternalHTML","AudioBlock","uploadToTmpFilesDotOrg_DEV_ONLY","body","BackgroundColorMark","HTMLAttributes","BackgroundColor","TextColorMark","TextColor","getCurrentBlockContentType","headingPropSchema","HeadingBlockContent","parsed","level","InputRule","state","chain","range","Heading","handleEnter","selectionEmpty","commands","bulletListItemPropSchema","BulletListItemBlockContent","BulletListItem","PLUGIN_KEY","NumberedListIndexingPlugin","_transactions","_oldState","modified","newIndex","isFirstBlockInDoc","prevBlockInfo","prevBlockContentNode","prevBlockIndex","numberedListItemPropSchema","NumberedListItemBlockContent","NumberedListItem","checkListItemPropSchema","checkListItemBlockContent","checkbox","checkboxWrapper","changeHandler","label","CheckListItem","paragraphPropSchema","ParagraphBlockContent","Paragraph","TableExtension","columnResizing","tableEditing","selection","selectionIsEmpty","selectionIsAtStartOfNode","selectionIsInTableParagraphNode","extension","context","callOrReturn","getExtensionField","tablePropSchema","TableBlockContent","TableParagraph","mergeAttributes","Table","TableHeader","TableCell","TableRow","defaultBlockSpecs","defaultBlockSchema","defaultStyleSpecs","Bold","Italic","Underline","Strike","Code","defaultStyleSchema","defaultInlineContentSpecs","defaultInlineContentSchema","checkDefaultBlockTypeInSchema","checkBlockIsDefaultType","checkBlockIsFileBlock","checkBlockIsFileBlockWithPreview","checkBlockIsFileBlockWithPlaceholder","checkBlockTypeHasDefaultProp","checkBlockHasDefaultProp","getNodeById","targetNode","posBeforeNode","insertBlocks","blocksToInsert","referenceBlock","placement","ttEditor","nodesToInsert","insertedBlocks","updateBlock","blockToUpdate","update","blockContainerNode","removeBlocksWithCallback","blocksToRemove","callback","idsOfBlocksToRemove","removedBlocks","removedSize","oldDocSize","newDocSize","notFoundIds","removeBlocks","replaceBlocks","idOfFirstBlock","insertContentAt","position","from","to","isOnlyTextContent","isOnlyBlockContent","selectionToInsertionEnd","removeUnderlines","removeUnderlinesHelper","addSpacesToCheckboxes","helper","nextChild","cleanHTMLToMarkdown","cleanHTMLString","rehypeRemark","remarkGfm","remarkStringify","blocksToMarkdown","externalHTML","getChildIndex","isWhitespaceNode","liftNestedListsToParent","parentListItem","siblingsAfter","sibling","siblingContainer","createGroups","listItem","_detachedDoc","detachedDoc","nestedListsToBlockNoteStructure","elementOrHTML","HTMLToBlocks","html","icSchema","pmSchema","htmlNode","parentNode","DOMParser","code","properties","result","markdownToBlocks","markdown","htmlString","remarkParse","remarkRehype","defaultHandlers","EventEmitter","__publicField","fn","args","callbacks","FilePanelView","pluginKey","pmView","emitUpdate","blockElement","prevState","pluginState","filePanelPluginKey","FilePanelProsemirrorPlugin","editorView","_view","FormattingToolbarView","empty","isEmptyTextBlock","isTextSelection","composing","isSame","ranges","shouldShow","isNodeSelection","posToDOMRect","formattingToolbarPluginKey","FormattingToolbarProsemirrorPlugin","LinkToolbarView","hoveredLinkElement","posInHoveredLinkMark","resolvedPosInHoveredLinkMark","marksAtPos","getMarkRange","editorWrapper","prevLinkMark","linkToolbarPluginKey","LinkToolbarProsemirrorPlugin","findBlock","findParentNode","SuggestionMenuView","decorationNode","suggestionMenuPluginKey","menuName","prev","next","started","stopped","SuggestionMenuProseMirrorPlugin","triggerCharacter","triggerCharacters","suggestionPluginTransactionMeta","_from","_to","suggestionPluginState","blockNode","DecorationSet","Decoration","createSuggestionMenu","MultipleNodeSelection","Selection","$anchor","$head","_pos","fromResult","toResult","dragImageElement","getDraggableBlockFromElement","blockPositionFromElement","docView","desc","blockPositionsFromSelection","beforeFirstBlockPos","afterLastBlockPos","selectionStartInBlockContent","selectionEndInBlockContent","minDepth","startFirstBlockPos","endLastBlockPos","setDragImage","parentClone","getElementIndex","parentElement","firstSelectedBlockIndex","lastSelectedBlockIndex","unsetDragImage","inheritedClasses","className","rootEl","dragStart","editorBoundingBox","coords","elements","blockEl","draggedBlockInSelection","multipleBlocksSelected","NodeSelection","selectedSlice","plainText","SideMenuView","_c","_d","blockContentBoundingBox","evt","_event","editorOuterBoundingBox","cursorWithinEditor","prevBlockId","newBlockInsertionPos","newBlockContentPos","sideMenuPluginKey","SideMenuProsemirrorPlugin","setHiddenDragImage","unsetHiddenDragImage","domCellAround","target","hideElementsWithClassNames","classNames","elementsToHide","TableHandlesView","colIndex","rowIndex","cellRect","tableRect","tableBlock","boundedMouseCoords","tableCellElements","tableCellElement","emitStateUpdate","oldIndex","dispatchDecorationsTransaction","mousePos","tableHandlesPluginKey","rows","rowToMove","cellsToMove","tableElement","cellElement","TableHandlesProsemirrorPlugin","decorations","tableResolvedPos","tableNode","rowResolvedPos","cellResolvedPos","decorationPos","widget","selectedFragmentToHTML","selectedFragment","createCopyToClipboardExtension","setSelectionToNextContentEditableBlock","insertOrUpdateBlock","currentBlock","insertedBlock","getDefaultSlashMenuItems","filterSuggestionItems","query","title","aliases","alias","acceptedMIMETypes","checkMIMETypesMatch","mimeType1","mimeType2","types1","types2","handleFileInsertion","dataTransfer","format","mimeType","fileBlockConfigs","fileBlockType","updateData","fileBlock","createPasteFromClipboardExtension","data","createDropFileExtension","BackgroundColorExtension","TextAlignmentExtension","TextColorExtension","TrailingNode","plugin","_","__","shouldInsertNodeAtEnd","endPosition","_state","lastNode","lastContentNode","NonEditableBlockPlugin","TextSelection","nodeAttributes","PreviousBlockTypePlugin","timeout","_editorView","_prevState","currentTransactionOriginalOldBlockAttrs","oldNodes","findChildren","oldNodesById","oldNode","oldContentNode","newContentNode","newAttrs","oldAttrs","prevAttrs","decorationAttrs","nodeAttr","decoration","BlockAttributes","BlockContainer","attrs","HTMLAttr","blockOuter","blockHTMLAttributes","dispatch","newBlock","posInBlock","childNodes","oldType","newType","oldContentType","newContentType","posBetweenBlocks","nextNodeIsBlock","prevNodeIsBlock","nextBlockInfo","childBlocksStart","childBlocksEnd","childBlocksRange","prevBlockEndPos","keepType","keepProps","originalBlockContent","newBlockContent","selectionAtBlockStart","isParagraph","blockAtDocStart","blockAtDocEnd","selectionAtBlockEnd","hasChildBlocks","oldDepth","newPos","newDepth","blockEmpty","blockIndented","BlockGroup","blockGroupHTMLAttributes","Doc","getBlockNoteExtensions","opts","extensions","Gapcursor","HardBreak","Text","Link","styleSpec","a","inlineContentSpec","ext","Dropcursor","Collaboration","defaultRender","user","cursor","nonbreakingSpace1","nonbreakingSpace2","CollaborationCursor","History","disableExtensions","ex","removeChild","n","f","nestedChild","container","removeUndefined","BlockNoteSchema","BlockNoteTipTapEditor","TiptapEditor","cache","oldCreateAndFill","pmNodes","b","createDocument","e","EditorState","EditorView","PlaceholderPlugin","placeholders","styleEl","nonce","styleSheet","getBaseSelector","additionalSelectors","getSelector","mustBeFocused","mustBeFocusedSelector","blockTypeSelector","placeholder","before","dec","blockNoteTipTapOptions","BlockNoteEditor","anyOpts","newOptions","blockNoteUIExtension","initialContent","tiptapOptionParams","tiptapOptions","reverse","traverseBlockArray","blockArray","nodeIndex","numNodes","prevNode","nextNode","targetBlock","editable","cb","textShorthandToStyledText","partialContentToInlineContent","partialContent","partialBlocksToBlocksForTesting","partialBlocks","partialBlock","partialBlockToBlockForTesting","withDefaults","propKey","propValue","addIdsToBlock","addIdsToBlocks"],"mappings":"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P,MAAO,gBACP,MAAO,gBACP,MAAO,gBACP,KAAM,cACR,CACF,EACA,YAAa,CACX,QAAS,CACP,MAAO,eACP,MAAO,eACP,MAAO,eACP,KAAM,aACR,EACA,kBAAmB,CACjB,MAAO,eACP,MAAO,eACP,MAAO,eACP,KAAM,aACR,CACF,EACA,cAAe,CACb,QAAS,CACP,MAAO,iBACP,MAAO,iBACP,MAAO,iBACP,KAAM,eACR,CACF,EACA,YAAa,CACX,QAAS,CACP,MAAO,eACP,MAAO,eACP,MAAO,eACP,KAAM,aACR,CACF,EACA,oBAAqB,CACnB,QAAS,gBACX,EACA,KAAM,CACJ,QAAS,aACT,kBAAmB,KACrB,EACA,OAAQ,CACN,QAAS,eACT,kBAAmB,WACrB,EACA,WAAY,CACV,QAAS,iBACX,EACA,aAAc,CACZ,QAAS,mBACX,EACA,YAAa,CACX,QAAS,kBACX,EACA,cAAe,CACb,QAAS,cACX,CACF,EACA,WAAY,CACV,OAAQ,CACN,MAAO,SACP,iBAAkB,CAChB,MAAO,eACP,MAAO,eACP,MAAO,eACP,KAAM,aACR,EACA,aAAc,sBAChB,EACA,MAAO,CACL,MAAO,QACP,aAAc,CACZ,MAAO,cACP,MAAO,cACP,MAAO,cACP,KAAM,YACR,EACA,gBAAiB,WACnB,CACF,EACA,aAAc,CACZ,OAAQ,CACN,QAAS,aACX,EACA,KAAM,CACJ,KAAM,YACN,QAAS,MACX,EACA,KAAM,CACJ,QAAS,iBACX,EACA,KAAM,CACJ,kBAAmB,aACnB,gBAAiB,UACnB,CACF,EACA,QAAS,CACP,cAAe,MACjB,CACF,wEC3S8B,CAC5B,WAAY,CACV,QAAS,CACP,MAAO,UACP,QAAS,0CACT,QAAS,CAAC,IAAK,SAAU,IAAI,EAC7B,MAAO,QACT,EACA,UAAW,CACT,MAAO,UACP,QAAS,iCACT,QAAS,CAAC,KAAM,SAAU,YAAY,EACtC,MAAO,QACT,EACA,UAAW,CACT,MAAO,UACP,QAAS,yDACT,QAAS,CAAC,KAAM,SAAU,YAAY,EACtC,MAAO,QACT,EACA,cAAe,CACb,MAAO,kBACP,QAAS,4CACT,QAAS,CAAC,KAAM,KAAM,QAAS,iBAAkB,iBAAiB,EAClE,MAAO,eACT,EACA,YAAa,CACX,MAAO,gBACP,QAAS,+CACT,QAAS,CAAC,KAAM,KAAM,QAAS,cAAe,eAAe,EAC7D,MAAO,eACT,EACA,WAAY,CACV,MAAO,wBACP,QAAS,0DACT,QAAS,CACP,KACA,KACA,QACA,wBACA,eACA,eACF,EACA,MAAO,eACT,EACA,UAAW,CACT,MAAO,aACP,QAAS,0CACT,QAAS,CAAC,IAAK,YAAY,EAC3B,MAAO,eACT,EACA,MAAO,CACL,MAAO,UACP,QAAS,4BACT,QAAS,CAAC,SAAS,EACnB,MAAO,QACT,EACA,MAAO,CACL,MAAO,QACP,QAAS,oBACT,QAAS,CACP,QACA,cACA,cACA,MACA,QACA,QACA,KACF,EACA,MAAO,QACT,EACA,MAAO,CACL,MAAO,QACP,QAAS,oBACT,QAAS,CACP,QACA,mBACA,aACA,MACA,OACA,QACA,KACF,EACA,MAAO,OACT,EACA,MAAO,CACL,MAAO,QACP,QAAS,mBACT,QAAS,CACP,QACA,mBACA,aACA,MACA,MACA,QACA,KACF,EACA,MAAO,OACT,EACA,KAAM,CACJ,MAAO,UACP,QAAS,qBACT,QAAS,CAAC,UAAW,aAAc,WAAY,QAAS,KAAK,EAC7D,MAAO,OACT,CACF,EACA,aAAc,CACZ,QAAS,kDACT,QAAS,QACT,eAAgB,QAChB,iBAAkB,QAClB,cAAe,OACjB,EACA,YAAa,CACX,MAAO,CACL,gBAAiB,mBACnB,EACA,MAAO,CACL,gBAAiB,mBACnB,EACA,MAAO,CACL,gBAAiB,kBACnB,EACA,KAAM,CACJ,gBAAiB,oBACnB,CACF,EAEA,UAAW,CACT,gBAAiB,kBACjB,kBAAmB,wBACrB,EACA,YAAa,CACX,gBAAiB,YACjB,gBAAiB,UACnB,EACA,aAAc,CACZ,uBAAwB,uBACxB,oBAAqB,qBACrB,kBAAmB,+BACnB,mBAAoB,+BACpB,mBAAoB,8BACpB,mBAAoB,8BACtB,EACA,gBAAiB,CACf,eAAgB,uBAChB,QAAS,aACX,EACA,aAAc,CACZ,WAAY,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,YAAa,CACX,QAAS,CACP,MAAO,YACP,MAAO,iBACP,MAAO,cACP,KAAM,WACR,CACF,EACA,oBAAqB,CACnB,QAAS,qBACX,EACA,KAAM,CACJ,QAAS,oBACT,kBAAmB,KACrB,EACA,OAAQ,CACN,QAAS,eACT,kBAAmB,WACrB,EACA,WAAY,CACV,QAAS,oBACX,EACA,aAAc,CACZ,QAAS,mBACX,EACA,YAAa,CACX,QAAS,kBACX,EACA,cAAe,CACb,QAAS,aACX,CACF,EACA,WAAY,CACV,OAAQ,CACN,MAAO,YACP,iBAAkB,CAChB,MAAO,iBACP,MAAO,qBACP,MAAO,kBACP,KAAM,gBACR,EACA,aAAc,4BAChB,EACA,MAAO,CACL,MAAO,WACP,aAAc,CACZ,MAAO,gBACP,MAAO,oBACP,MAAO,iBACP,KAAM,eACR,EACA,gBAAiB,eACnB,CACF,EACA,aAAc,CACZ,OAAQ,CACN,QAAS,kBACX,EACA,KAAM,CACJ,KAAM,gBACN,QAAS,QACX,EACA,KAAM,CACJ,QAAS,oBACX,EACA,KAAM,CACJ,kBAAmB,eACnB,gBAAiB,YACnB,CACF,EACA,QAAS,CACP,cAAe,MACjB,CACF,KCpS8B,CAC5B,WAAY,CACV,QAAS,CACP,MAAO,OACP,QAAS,gBACT,QAAS,CAAC,IAAK,OAAQ,KAAM,MAAM,EACnC,MAAO,KACT,EACA,UAAW,CACT,MAAO,OACP,QAAS,cACT,QAAS,CAAC,KAAM,OAAQ,aAAc,MAAM,EAC5C,MAAO,KACT,EACA,UAAW,CACT,MAAO,OACP,QAAS,oBACT,QAAS,CAAC,KAAM,OAAQ,aAAc,MAAM,EAC5C,MAAO,KACT,EACA,cAAe,CACb,MAAO,SACP,QAAS,mBACT,QAAS,CACP,KACA,KACA,eACA,gBACA,MACA,SACA,QACF,EACA,MAAO,QACT,EACA,YAAa,CACX,MAAO,OACP,QAAS,iBACT,QAAS,CACP,KACA,KACA,aACA,cACA,MACA,SACF,EACA,MAAO,QACT,EACA,WAAY,CACV,MAAO,UACP,QAAS,8BACT,QAAS,CACP,KACA,KACA,OACA,YACA,eACA,MACA,UACA,YACF,EACA,MAAO,QACT,EACA,UAAW,CACT,MAAO,SACP,QAAS,QACT,QAAS,CAAC,IAAK,YAAa,QAAQ,EACpC,MAAO,QACT,EACA,MAAO,CACL,MAAO,IACP,QAAS,OACT,QAAS,CAAC,QAAS,IAAK,MAAM,EAC9B,MAAO,SACT,EACA,MAAO,CACL,MAAO,KACP,QAAS,QACT,QAAS,CACP,QACA,cACA,SACA,MACA,UACA,QACA,MACA,IACF,EACA,MAAO,MACT,EACA,MAAO,CACL,MAAO,MACP,QAAS,SACT,QAAS,CACP,QACA,cACA,SACA,MACA,OACA,QACA,MACA,KACF,EACA,MAAO,MACT,EACA,MAAO,CACL,MAAO,QACP,QAAS,WACT,QAAS,CACP,QACA,cACA,SACA,MACA,QACA,QACA,MACA,OACF,EACA,MAAO,MACT,EACA,KAAM,CACJ,MAAO,OACP,QAAS,UACT,QAAS,CAAC,OAAQ,SAAU,QAAS,QAAS,MAAO,MAAM,EAC3D,MAAO,MACT,CACF,EACA,aAAc,CACZ,QAAS,4BACT,QAAS,MACT,eAAgB,SAChB,iBAAkB,SAClB,cAAe,QACjB,EACA,YAAa,CACX,MAAO,CACL,gBAAiB,OACnB,EACA,MAAO,CACL,gBAAiB,QACnB,EACA,MAAO,CACL,gBAAiB,UACnB,EACA,KAAM,CACJ,gBAAiB,SACnB,CACF,EAEA,UAAW,CACT,gBAAiB,UACjB,kBAAmB,UACrB,EACA,YAAa,CACX,gBAAiB,KACjB,gBAAiB,MACnB,EACA,aAAc,CACZ,uBAAwB,OACxB,oBAAqB,OACrB,kBAAmB,SACnB,mBAAoB,SACpB,mBAAoB,SACpB,mBAAoB,QACtB,EACA,gBAAiB,CACf,eAAgB,eAChB,QAAS,MACX,EACA,aAAc,CACZ,WAAY,MACZ,iBAAkB,MAClB,OAAQ,CACN,QAAS,QACT,KAAM,MACN,MAAO,KACP,IAAK,IACL,OAAQ,OACR,OAAQ,KACR,MAAO,IACP,KAAM,IACN,OAAQ,IACR,KAAM,KACR,CACF,EAEA,mBAAoB,CAClB,KAAM,CACJ,QAAS,KACT,kBAAmB,OACrB,EACA,OAAQ,CACN,QAAS,KACT,kBAAmB,OACrB,EACA,UAAW,CACT,QAAS,KACT,kBAAmB,OACrB,EACA,OAAQ,CACN,QAAS,OACT,kBAAmB,aACrB,EACA,KAAM,CACJ,QAAS,MACT,kBAAmB,EACrB,EACA,OAAQ,CACN,QAAS,GACX,EACA,KAAM,CACJ,QAAS,MACT,kBAAmB,OACrB,EACA,aAAc,CACZ,QAAS,YACT,kBAAmB,WACrB,EACA,aAAc,CACZ,QAAS,CACP,MAAO,QACP,MAAO,SACP,MAAO,WACP,KAAM,SACR,CACF,EACA,YAAa,CACX,QAAS,CACP,MAAO,WACP,MAAO,YACP,MAAO,cACP,KAAM,YACR,EACA,kBAAmB,CACjB,MAAO,WACP,MAAO,YACP,MAAO,cACP,KAAM,YACR,CACF,EACA,cAAe,CACb,QAAS,CACP,MAAO,YACP,MAAO,aACP,MAAO,eACP,KAAM,aACR,CACF,EACA,YAAa,CACX,QAAS,CACP,MAAO,QACP,MAAO,SACP,MAAO,WACP,KAAM,SACR,CACF,EACA,oBAAqB,CACnB,QAAS,YACX,EACA,KAAM,CACJ,QAAS,SACT,kBAAmB,KACrB,EACA,OAAQ,CACN,QAAS,SACT,kBAAmB,WACrB,EACA,WAAY,CACV,QAAS,KACX,EACA,aAAc,CACZ,QAAS,MACX,EACA,YAAa,CACX,QAAS,KACX,EACA,cAAe,CACb,QAAS,MACX,CACF,EACA,WAAY,CACV,OAAQ,CACN,MAAO,SACP,iBAAkB,CAChB,MAAO,YACP,MAAO,aACP,MAAO,eACP,KAAM,aACR,EACA,aAAc,oBAChB,EACA,MAAO,CACL,MAAO,OACP,aAAc,CACZ,MAAO,UACP,MAAO,WACP,MAAO,aACP,KAAM,WACR,EACA,gBAAiB,QACnB,CACF,EACA,aAAc,CACZ,OAAQ,CACN,QAAS,QACX,EACA,KAAM,CACJ,KAAM,SACN,QAAS,IACX,EACA,KAAM,CACJ,QAAS,cACX,EACA,KAAM,CACJ,kBAAmB,UACnB,gBAAiB,QACnB,CACF,EACA,QAAS,CACP,cAAe,MACjB,CACF,KChU8B,CAC5B,WAAY,CACV,QAAS,CACP,MAAO,MACP,QAAS,WACT,QAAS,CAAC,IAAK,MAAO,KAAM,KAAK,EACjC,MAAO,IACT,EACA,UAAW,CACT,MAAO,MACP,QAAS,WACT,QAAS,CAAC,KAAM,MAAO,KAAK,EAC5B,MAAO,IACT,EACA,UAAW,CACT,MAAO,MACP,QAAS,WACT,QAAS,CAAC,KAAM,MAAO,YAAY,EACnC,MAAO,IACT,EACA,cAAe,CACb,MAAO,YACP,QAAS,qBACT,QAAS,CAAC,KAAM,KAAM,KAAM,YAAa,OAAO,EAChD,MAAO,OACT,EACA,YAAa,CACX,MAAO,YACP,QAAS,qBACT,QAAS,CAAC,KAAM,KAAM,KAAM,YAAa,QAAQ,EACjD,MAAO,OACT,EACA,WAAY,CACV,MAAO,QACP,QAAS,yBACT,QAAS,CACP,KACA,KACA,KACA,QACA,SACA,SACA,MACF,EACA,MAAO,OACT,EACA,UAAW,CACT,MAAO,KACP,QAAS,SACT,QAAS,CAAC,IAAK,YAAa,IAAI,EAChC,MAAO,OACT,EACA,MAAO,CACL,MAAO,IACP,QAAS,gBACT,QAAS,CAAC,GAAG,EACb,MAAO,IACT,EACA,MAAO,CACL,MAAO,MACP,QAAS,kBACT,QAAS,CACP,QACA,cACA,SACA,MACA,UACA,QACA,MACA,KACF,EACA,MAAO,KACT,EACA,MAAO,CACL,MAAO,MACP,QAAS,SACT,QAAS,CACP,QACA,cACA,SACA,MACA,OACA,QACA,MACA,KACF,EACA,MAAO,KACT,EACA,MAAO,CACL,MAAO,MACP,QAAS,SACT,QAAS,CACP,QACA,cACA,SACA,MACA,QACA,QACA,MACA,KACF,EACA,MAAO,KACT,EACA,KAAM,CACJ,MAAO,KACP,QAAS,QACT,QAAS,CAAC,OAAQ,SAAU,QAAS,QAAS,KAAM,KAAK,EACzD,MAAO,KACT,CACF,EACA,aAAc,CACZ,QAAS,gCACT,QAAS,KACT,eAAgB,KAChB,iBAAkB,KAClB,cAAe,IACjB,EACA,YAAa,CACX,MAAO,CACL,gBAAiB,QACnB,EACA,MAAO,CACL,gBAAiB,QACnB,EACA,MAAO,CACL,gBAAiB,QACnB,EACA,KAAM,CACJ,g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,WACT,KAAM,QACN,MAAO,UACP,IAAK,WACL,OAAQ,eACR,OAAQ,QACR,MAAO,UACP,KAAM,YACN,OAAQ,YACR,KAAM,QACR,CACF,EAEA,mBAAoB,CAClB,KAAM,CACJ,QAAS,cACT,kBAAmB,OACrB,EACA,OAAQ,CACN,QAAS,UACT,kBAAmB,OACrB,EACA,UAAW,CACT,QAAS,eACT,kBAAmB,OACrB,EACA,OAAQ,CACN,QAAS,gBACT,kBAAmB,aACrB,EACA,KAAM,CACJ,QAAS,MACT,kBAAmB,EACrB,EACA,OAAQ,CACN,QAAS,QACX,EACA,KAAM,CACJ,QAAS,cACT,kBAAmB,OACrB,EACA,aAAc,CACZ,QAAS,eACT,kBAAmB,cACrB,EACA,aAAc,CACZ,QAAS,CACP,MAAO,cACP,MAAO,cACP,MAAO,cACP,KAAM,YACR,CACF,EACA,YAAa,CACX,QAAS,CACP,MAAO,sBACP,MAAO,oBACP,MAAO,oBACP,KAAM,mBACR,EACA,kBAAmB,CACjB,MAAO,sBACP,MAAO,oBACP,MAAO,oBACP,KAAM,mBACR,CACF,EACA,cAAe,CACb,QAAS,CACP,MAAO,kBACP,MAAO,gBACP,MAAO,gBACP,KAAM,cACR,CACF,EACA,YAAa,CACX,QAAS,CACP,MAAO,eACP,MAAO,aACP,MAAO,aACP,KAAM,WACR,CACF,EACA,oBAAqB,CACnB,QAAS,kBACX,EACA,KAAM,CACJ,QAAS,iBACT,kBAAmB,KACrB,EACA,OAAQ,CACN,QAAS,mBACT,kBAAmB,WACrB,EACA,WAAY,CACV,QAAS,yBACX,EACA,aAAc,CACZ,QAAS,iBACX,EACA,YAAa,CACX,QAAS,0BACX,EACA,cAAe,CACb,QAAS,gBACX,CACF,EACA,WAAY,CACV,OAAQ,CACN,MAAO,QACP,iBAAkB,CAChB,MAAO,gBACP,MAAO,cACP,MAAO,cACP,KAAM,YACR,EACA,aAAc,oCAChB,EACA,MAAO,CACL,MAAO,QACP,aAAc,CACZ,MAAO,gBACP,MAAO,cACP,MAAO,cACP,KAAM,YACR,EACA,gBAAiB,cACnB,CACF,EACA,aAAc,CACZ,OAAQ,CACN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S,aACT,kBAAmB,aACrB,EACA,KAAM,CACJ,QAAS,OACT,kBAAmB,EACrB,EACA,OAAQ,CACN,QAAS,SACX,EACA,KAAM,CACJ,QAAS,eACT,kBAAmB,OACrB,EACA,aAAc,CACZ,QAAS,sBACT,kBAAmB,qBACrB,EACA,aAAc,CACZ,QAAS,CACP,MAAO,oBACP,MAAO,iBACP,MAAO,oBACP,KAAM,cACR,CACF,EACA,YAAa,CACX,QAAS,CACP,MAAO,mBACP,MAAO,gBACP,MAAO,mBACP,KAAM,aACR,EACA,kBAAmB,CACjB,MAAO,mBACP,MAAO,gBACP,MAAO,mBACP,KAAM,aACR,CACF,EACA,cAAe,CACb,QAAS,CACP,MAAO,qBACP,MAAO,kBACP,MAAO,qBACP,KAAM,eACR,CACF,EACA,YAAa,CACX,QAAS,CACP,MAAO,eACP,MAAO,YACP,MAAO,eACP,KAAM,SACR,CACF,EACA,oBAAqB,CACnB,QAAS,sBACX,EACA,KAAM,CACJ,QAAS,YACT,kBAAmB,KACrB,EACA,OAAQ,CACN,QAAS,eACT,kBAAmB,WACrB,EACA,WAAY,CACV,QAAS,kBACX,EACA,aAAc,CACZ,QAAS,kBACX,EACA,YAAa,CACX,QAAS,kBACX,EACA,cAAe,CACb,QAAS,iBACX,CACF,EACA,WAAY,CACV,OAAQ,CACN,MAAO,UACP,iBAAkB,CAChB,MAAO,mBACP,MAAO,gBACP,MAAO,mBACP,KAAM,aACR,EACA,aAAc,uBAChB,EACA,MAAO,CACL,MAAO,QACP,aAAc,CACZ,MAAO,iBACP,MAAO,cACP,MAAO,iBACP,KAAM,WACR,EACA,gBAAiB,UACnB,CACF,EACA,aAAc,CACZ,OAAQ,CACN,QAAS,cACX,EACA,KAAM,CACJ,KAAM,qBACN,QAAS,WACX,EACA,KAAM,CACJ,QAAS,kBACX,EACA,KAAM,CACJ,kBAAmB,oBACnB,gBAAiB,eACnB,CACF,EACA,QAAS,CACP,cAAe,MACjB,CACF,KCpS8B,CAC5B,WAAY,CACV,QAAS,CACP,MAAO,OACP,QAAS,SACT,QAAS,CAAC,IAAK,WAAY,KAAM,KAAM,MAAM,EAC7C,MAAO,IACT,EACA,UAAW,CACT,MAAO,OACP,QAAS,SACT,QAAS,CAAC,KAAM,WAAY,aAAc,KAAM,OAAQ,KAAK,EAC7D,MAAO,IACT,EACA,UAAW,CACT,MAAO,OACP,QAAS,YACT,QAAS,CAAC,KAAM,WAAY,aAAc,KAAM,MAAM,EACtD,MAAO,IACT,EACA,cAAe,CACb,MAAO,OACP,QAAS,WACT,QAAS,CACP,KACA,KACA,OACA,eACA,gBACA,KACA,MACF,EACA,MAAO,IACT,EACA,YAAa,CACX,MAAO,OACP,QAAS,WACT,QAAS,CACP,KACA,KACA,OACA,aACA,cACA,KACA,MACF,EACA,MAAO,IACT,EACA,WAAY,CACV,MAAO,OACP,QAAS,eACT,QAAS,CACP,KACA,KACA,YACA,eACA,KACA,OACA,OACA,KACF,EACA,MAAO,IACT,EACA,UAAW,CACT,MAAO,KACP,QAAS,SACT,QAAS,CAAC,IAAK,YAAa,OAAQ,IAAI,EACxC,MAAO,IACT,EACA,MAAO,CACL,MAAO,KACP,QAAS,OACT,QAAS,CAAC,QAAS,IAAI,EACvB,MAAO,MACT,EACA,MAAO,CACL,MAAO,KACP,QAAS,OACT,QAAS,CACP,KACA,OACA,KACA,QACA,MACA,KACA,KACA,KACF,EACA,MAAO,IACT,EACA,MAAO,CACL,MAAO,KACP,QAAS,OACT,QAAS,CACP,KACA,OACA,KACA,QACA,MACA,KACA,KACA,MACA,KACA,SACF,EACA,MAAO,IACT,EACA,MAAO,CACL,MAAO,KACP,QAAS,OACT,QAAS,CACP,KACA,OACA,KACA,QACA,MACA,KACA,KACA,MACA,KACA,SACF,EACA,MAAO,IACT,EACA,KAAM,CACJ,MAAO,KACP,QAAS,OACT,QAAS,CAAC,KAAM,KAAM,OAAQ,KAAM,KAAM,KAAK,EAC/C,MAAO,IACT,CACF,EACA,aAAc,CACZ,QAAS,eACT,QAAS,KACT,eAAgB,KAChB,iBAAkB,KAClB,cAAe,IACjB,EACA,YAAa,CACX,MAAO,CACL,gBAAiB,MACnB,EACA,MAAO,CACL,gBAAiB,MACnB,EACA,MAAO,CACL,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"}